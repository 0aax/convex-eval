[
    {
        "statement": "Let \\(\\{C_j\\}_{j\\in J}\\) be an arbitrary family of convex sets. Then\n\\[\nC:=\\bigcap\\{C_j:\\; j\\in J\\}\n\\]\nis convex.",
        "title": "",
        "label": "prop:CAMA-chap3-1.2.1",
        "lean_tag": [
            "CAMA_chap_3_1_2_1"
        ],
        "lean_formalization": "lemma CAMA_chap_3_1_2_1 {n : ‚Ñï}\n  (J : Set ‚Ñï)\n  (C : ‚Ñï ‚Üí Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC : ‚àÄ i, Convex ‚Ñù (C i)) :\n  Convex ‚Ñù (‚ãÇ (j : ‚Ñï) (_ : j ‚àà J), (C j)) := by\n  sorry",
        "proof": "Immediate from the very Definition 1.1.1."
    },
    {
        "statement": "Let $A:\\mathbb{R}^n\\to\\mathbb{R}^m$ be an affine mapping and $C$ a convex set of $\\mathbb{R}^n$. The image $A(C)$ of $C$ under $A$ is convex in $\\mathbb{R}^m$.\n\nIf $D$ is a convex set of $\\mathbb{R}^m$, the inverse image\n\\[\nA^{-1}(D):=\\{x\\in\\mathbb{R}^n:\\;A(x)\\in D\\}\n\\]\nis convex in $\\mathbb{R}^n$.",
        "title": "",
        "label": "prop:CAMA-chap3-1.2.4",
        "lean_tag": [
            "CAMA_chap_3_1_2_4"
        ],
        "lean_formalization": "lemma CAMA_chap_3_1_2_4 {m n : ‚Ñï}\n  (A : AffineMap ‚Ñù (EuclideanSpace ‚Ñù (Fin n)) (EuclideanSpace ‚Ñù (Fin m)))\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (D : Set (EuclideanSpace ‚Ñù (Fin m)))\n  (hC : Convex ‚Ñù C)\n  (hD : Convex ‚Ñù D) :\n  Convex ‚Ñù (Set.image A C) ‚àß\n  (Convex ‚Ñù (Set.preimage A D)) := by\n  sorry",
        "proof": "For $x$ and $x'$ in $\\mathbb{R}^n$, the image under $A$ of the segment $[x,x']$ is clearly the segment $[A(x),A(x')]\\subset\\mathbb{R}^m$. This proves the first claim, but also the second: indeed, if $x$ and $x'$ are such that $A(x)$ and $A(x')$ are both in the convex set $D$, then every point of the segment $[x,x']$ has its image in $[A(x),A(x')]\\subset D$."
    },
    {
        "statement": "If $C$ is convex, so are its interior $\\operatorname{int}C$ and its closure $\\overline{C}$.",
        "title": "",
        "label": "prop:CAMA-chap3-1.2.7",
        "lean_tag": [
            "CAMA_chap_3_1_2_7"
        ],
        "lean_formalization": "lemma CAMA_chap_3_1_2_7 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC : Convex ‚Ñù C) :\n  Convex ‚Ñù (interior C) ‚àß Convex ‚Ñù (closure C):= by\n  sorry",
        "proof": "For given different $x$ and $x'$, and $\\alpha\\in]0,1[$, we set $x''=\\alpha x+(1-\\alpha)x'\\in]x,x'[$.\n\nTake first $x$ and $x'$ in $\\operatorname{int}C$. Choosing $\\delta>0$ such that $B(x',\\delta)\\subset C$, we show that $B(x'',(1-\\alpha)\\delta)\\subset C$. As often in convex analysis, it is probably best to draw a picture. The ratio $\\|x''-x\\|/\\|x'-x\\|$ being precisely $1-\\alpha$, Fig.\\ 1.2.3 clearly shows that $B(x'',(1-\\alpha)\\delta)$ is just the set $\\alpha x+(1-\\alpha)B(x',\\delta)$, obtained from segments with endpoints in $\\operatorname{int}C$: $x''\\in\\operatorname{int}C$.\n\nNow, take $x$ and $x'$ in $\\operatorname{cl}C$: we select in $C$ two sequences $\\{x_k\\}$ and $\\{x_k'\\}$ converging to $x$ and $x'$ respectively. Then, $\\alpha x_k + (1-\\alpha)x_k'$ is in $C$ and converges to $\\alpha x + (1-\\alpha)x'$, which is therefore in $\\operatorname{cl}C$."
    },
    {
        "statement": "A set $C\\subset\\mathbb{R}^n$ is convex if and only if it contains every convex combination of its elements.",
        "title": "",
        "label": "prop:CAMA-chap3-1.3.3",
        "lean_tag": [
            "CAMA_chap_3_1_3_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_1_3_3 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n))) :\n  (Convex ‚Ñù C) ‚Üî (‚àÄ z ‚àà (conv C), z ‚àà C) := by\n  sorry",
        "proof": "The condition is sufficient: convex combinations of two elements just make up the segment joining them. To prove necessity, take $x_1,\\dots,x_k$ in $C$ and $\\alpha=(\\alpha_1,\\dots,\\alpha_k)\\in\\Delta_k$. One at least of the $\\alpha_i$'s is positive, say $\\alpha_1>0$. Then form\n\\[\ny_2:=\\frac{\\alpha_1}{\\alpha_1+\\alpha_2}x_1+\\frac{\\alpha_2}{\\alpha_1+\\alpha_2}x_2\n\\quad\\left[= \\frac{1}{\\alpha_1+\\alpha_2}(\\alpha_1x_1+\\alpha_2x_2)\\right]\n\\]\nwhich is in $C$ by Definition 1.1.1 itself. Therefore,\n\\[\ny_3:=\\frac{\\alpha_1+\\alpha_2}{\\alpha_1+\\alpha_2+\\alpha_3}y_2+\\frac{\\alpha_3}{\\alpha_1+\\alpha_2+\\alpha_3}x_3\n\\quad\\left[= \\frac{1}{\\sum_{i=1}^3\\alpha_i}\\sum_{i=1}^3\\alpha_i x_i\\right]\n\\]\nis in $C$ for the same reason; and so on until\n\\[\ny_k:=\\frac{\\alpha_1+\\cdots+\\alpha_{k-1}}{1}y_{k-1}+\\frac{\\alpha_k}{1}x_k\n\\quad\\left[= \\tfrac{1}{1}\\sum_{i=1}^k\\alpha_i x_i\\right].\n\\]"
    },
    {
        "statement": "The convex hull can also be described as the set of all convex combinations:\n\\[\n\\operatorname{co}S:=\\bigcap\\{C: C\\ \\text{is convex and contains }S\\}\n= \\Big\\{x\\in\\mathbb{R}^n : \\text{for some }k\\in\\mathbb{N}_*,\\ \\text{there exist }x_1,\\dots,x_k\\in S\\ \\text{and }\n\\alpha=(\\alpha_1,\\dots,\\alpha_k)\\in\\Delta_k\\ \\text{such that }\\sum_{i=1}^k\\alpha_i x_i=x\\Big\\}.\n\\tag{1.3.2}\n\\]",
        "title": "",
        "label": "prop:CAMA-chap3-1.3.4",
        "lean_tag": [
            "CAMA_chap_3_1_3_4"
        ],
        "lean_formalization": "lemma CAMA_chap_3_1_3_4 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n))) :\n  (convexHull ‚Ñù C) = (conv C) := by\n  sorry",
        "proof": "Call $T$ the set described in the rightmost side of (1.3.2). Clearly, $T\\supset S$. Also,\nif $C$ is convex and contains $S$, then it contains all convex combinations of elements\n\nFor this, take two points $x$ and $y$ in $T$, characterized respectively by $(x_{1},\\alpha_{1}),\\dots,$\n$(x_{k},\\alpha_{k})$ and by $(y_{1},\\beta_{1}),\\dots,(y_{\\ell},\\beta_{\\ell})$; take also\n$\\lambda\\in[0,1]$. Then $\\lambda x+(1-\\lambda)y$ is a certain combination of $k+\\ell$ elements of $S$; this combination is convex because its coefficients $\\lambda\\alpha_{i}$ and $(1-\\lambda)\\beta_{j}$ are nonnegative, and their sum is\n\\[\n\\lambda\\sum_{i=1}^{k}\\alpha_{i}+(1-\\lambda)\\sum_{j=1}^{\\ell}\\beta_{j}=\\lambda+1-\\lambda=1.\n\\]"
    },
    {
        "statement": "(C. Carath√©odory) Any $x\\in\\operatorname{co}S\\subset\\mathbb{R}^n$ can be represented as a convex combination of $n+1$ elements of $S$.",
        "title": "",
        "label": "thm:CAMA-chap3-1.3.6",
        "lean_tag": [
            "CAMA_chap_3_1_3_6"
        ],
        "lean_formalization": "lemma CAMA_chap_3_1_3_6 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n))) :\n  ‚àÄ x ‚àà (convexHull ‚Ñù S),\n  ‚àÉ (v : Fin (n + 1) ‚Üí EuclideanSpace ‚Ñù (Fin n)) (a : EuclideanSpace ‚Ñù (Fin (n + 1))),\n  (‚àÄ i, v i ‚àà S) ‚àß (a ‚àà ŒîŒ∫ (n + 1)) ‚àß (x = ‚àë i, a i ‚Ä¢ v i) := by\n  sorry",
        "proof": "Take an arbitrary convex combination $x=\\sum_{i=1}^k \\alpha_i x_i$, with $k>n+1$. We will show that one of the $x_i$'s can be assigned a $0$-coefficient without changing $x$. For this, assume that all coefficients $\\alpha_i$ are positive (otherwise we are done).\n\nThe $k>n+1$ elements $x_i$ are certainly affinely dependent: (1.3.1) tells us that we can find $\\delta_1,\\dots,\\delta_k$, not all zero, such that\n\\[\n\\sum_{i=1}^k \\delta_i x_i = 0 \\quad\\text{and}\\quad \\sum_{i=1}^k \\delta_i = 0.\n\\]\n\nThere is at least one positive $\\delta_i$; and we can set $\\alpha_i':=\\alpha_i-t^*\\delta_i$ for $i=1,\\dots,k$, where\n\\[\nt^*:=\\max\\{t\\ge 0:\\ \\alpha_i-t\\delta_i\\ge 0\\ \\text{for }i=1,\\dots,k\\}\n=\\min_{\\delta_j>0}\\frac{\\alpha_j}{\\delta_j}.\n\\]\n\nClearly enough,\n\\[\n\\alpha_i'\\ge 0\\quad\\text{for }i=1,\\dots,k \\qquad[\\text{automatic if }\\delta_i\\le 0,\\ \\text{by construction of }t^*\\text{ if }\\delta_i>0]\n\\]\n\\[\n\\sum_{i=1}^k \\alpha_i'=\\sum_{i=1}^k \\alpha_i - t^*\\sum_{i=1}^k \\delta_i =1;\n\\]\n\\[\n\\sum_{i=1}^k \\alpha_i' x_i = x - t^* \\sum_{i=1}^k \\delta_i x_i = x;\n\\]\nand there exists $i_0$ such that $\\alpha_{i_0}'=0$. \\qquad [by construction of $t^*$]\n\nIn other words, we have expressed $x$ as a convex combination of $k-1$ among the $x_i$'s; our claim is proved.\n\nNow, if $k-1=n+1$, the proof is finished. If not, we can apply the above construction to the convex combination $x=\\sum_{i=1}^{k-1}\\alpha_i' x_i$ and so on. The process can be continued until there remain only $n+1$ elements (which may be affinely independent)."
    },
    {
        "statement": "If $S$ is bounded [resp.\\ compact], then $\\operatorname{co}S$ is bounded [resp.\\ compact].",
        "title": "",
        "label": "thm:CAMA-chap3-1.4.3",
        "lean_tag": [
            "CAMA_chap_3_1_4_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_1_4_3 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n))) :\n  (Bornology.IsBounded S ‚Üí Bornology.IsBounded (convexHull ‚Ñù S)) ‚àß\n  (IsCompact S ‚Üí IsCompact (convexHull ‚Ñù S)) := by\n  sorry",
        "proof": "Let $x=\\sum_{i=1}^{n+1}\\alpha_i x_i\\in\\operatorname{co}S$. If $S$ is bounded, say by $M$, we can write\n\\[\n\\|x\\|\\le \\sum_{i=1}^{n+1}\\alpha_i\\|x_i\\|\\le M\\sum_{i=1}^{n+1}\\alpha_i = M.\n\\]\n\nNow take a sequence $\\{x^k\\}\\subset\\operatorname{co}S$. For each $k$ we can choose\n\\[\nx^k_1,\\dots,x^k_{n+1}\\in S\\qquad\\text{and}\\qquad \\alpha^k=(\\alpha^k_1,\\dots,\\alpha^k_{n+1})\\in\\Delta_{n+1}\n\\]\nsuch that $x^k=\\sum_{i=1}^{n+1}\\alpha^k_i x^k_i$. Note that $\\Delta_{n+1}$ is compact. If $S$ is compact, we can extract a subsequence as many times as necessary (not more than $n+2$ times) so that $\\{\\alpha^k\\}$ and each $\\{x^k_i\\}$ converge: we end up with an index set $K\\subset\\mathbb{N}$ such that, when $k\\to+\\infty$,\n\\[\n\\{x^k_i\\}_{k\\in K}\\to x_i\\in S\\qquad\\text{and}\\qquad \\{\\alpha^k\\}_{k\\in K}\\to \\alpha\\in\\Delta_{n+1}.\n\\]\n\nPassing to the limit for $k\\in K$, we see that $\\{x^k\\}_{k\\in K}$ converges to a point $x$, which can be expressed as a convex combination of points of $S$: $x\\in\\operatorname{co}S$, whose compactness is thus established."
    },
    {
        "statement": "Let the two convex sets $C_1$ and $C_2$ satisfy $\\operatorname{ri}C_1\\cap\\operatorname{ri}C_2\\neq\\varnothing$. Then\n\\begin{align}\n\\operatorname{ri}(C_1\\cap C_2) &= \\operatorname{ri}C_1\\cap\\operatorname{ri}C_2 \\label{eq:2.1.1}\\\\\n\\operatorname{cl}(C_1\\cap C_2) &= \\operatorname{cl}C_1\\cap\\operatorname{cl}C_2 .\\label{eq:2.1.2}\n\\end{align}",
        "title": "",
        "label": "prop:CAMA-chap3-2.1.10",
        "lean_tag": [
            "CAMA_chap_3_2_1_10"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_1_10 {n : ‚Ñï}\n  (C‚ÇÅ : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (C‚ÇÇ : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÅ : Convex ‚Ñù C‚ÇÅ)\n  (hC‚ÇÇ : Convex ‚Ñù C‚ÇÇ)\n  (hC : Set.Nonempty (intrinsicInterior ‚Ñù C‚ÇÅ ‚à© intrinsicInterior ‚Ñù C‚ÇÇ)) :\n  (intrinsicInterior ‚Ñù (C‚ÇÅ ‚à© C‚ÇÇ) = intrinsicInterior ‚Ñù C‚ÇÅ ‚à© intrinsicInterior ‚Ñù C‚ÇÇ) ‚àß\n  (closure (C‚ÇÅ ‚à© C‚ÇÇ) = closure C‚ÇÅ ‚à© closure C‚ÇÇ):= by\n  sorry",
        "proof": "First we show that $\\operatorname{cl}C_1\\cap\\operatorname{cl}C_2 \\subset \\operatorname{cl}(C_1\\cap C_2)$ (the converse inclusion is always true). Given $x\\in \\operatorname{cl}C_1\\cap\\operatorname{cl}C_2$, we pick $x'$ in the nonempty $\\operatorname{ri}C_1\\cap\\operatorname{ri}C_2$. From Lemma 2.1.6 applied to $C_1$ and to $C_2$,\n\\[\n]x,x'[\\subset \\operatorname{ri}C_1\\cap\\operatorname{ri}C_2 .\n\\]\nTaking the closure of both sides, we conclude\n\\[\nx\\in \\operatorname{cl}(\\operatorname{ri}C_1\\cap\\operatorname{ri}C_2)\\subset \\operatorname{cl}(C_1\\cap C_2),\n\\]\nwhich proves \\eqref{eq:2.1.2} because $x$ was arbitrary; the above inclusion is actually an equality.\n\nNow, we have just seen that the two convex sets $\\operatorname{ri}C_1\\cap\\operatorname{ri}C_2$ and $C_1\\cap C_2$ have the same closure. According to Remark 2.1.9, they have the same relative interior:\n\\[\n\\operatorname{ri}(C_1\\cap C_2)=\\operatorname{ri}(\\operatorname{ri}C_1\\cap\\operatorname{ri}C_2)\\subset \\operatorname{ri}C_1\\cap\\operatorname{ri}C_2.\n\\]\n\nIt remains to prove the converse inclusion, so let $y\\in \\operatorname{ri}C_1\\cap\\operatorname{ri}C_2$. If we take $x'\\in C_1$ [resp.\\ $C_2$], the segment $[x',y]$ is in aff $C_1$ [resp.\\ aff $C_2$] and, by definition of the relative interior, this segment can be stretched beyond $y$ and yet stay in $C_1$ [resp.\\ $C_2$] (see Fig.\\ 2.1.3). Take in particular $x'\\in \\operatorname{ri}(C_1\\cap C_2)$, $x'\\neq y$ (if such an $x'$ does not exist, we are done). The above stretching singles out an $x\\in C_1\\cap C_2$ such that $y\\in ]x,x'[:$\n\\[\ny=\\alpha x+(1-\\alpha)x' \\quad\\text{for some }\\alpha\\in ]0,1[.\n\\]\nThen Lemma 2.1.6 applied to $C_1\\cap C_2$ tells us that $y\\in \\operatorname{ri}(C_1\\cap C_2)$."
    },
    {
        "statement": "Let $A:\\mathbb{R}^n\\to\\mathbb{R}^m$ be an affine mapping and $C$ a convex set of $\\mathbb{R}^n$. Then\n\\[\n\\operatorname{ri}[A(C)] = A(\\operatorname{ri} C).\n\\tag{2.1.3}\n\\]\nIf $D$ is a convex set of $\\mathbb{R}^m$ satisfying $A^{-1}(\\operatorname{ri}D)\\neq\\varnothing$, then\n\\[\n\\operatorname{ri}\\bigl[A^{-1}(D)\\bigr] = A^{-1}(\\operatorname{ri} D).\n\\tag{2.1.4}\n\\]",
        "title": "",
        "label": "prop:CAMA-chap3-2.1.12",
        "lean_tag": [
            "CAMA_chap_3_2_1_12"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_1_12 {n : ‚Ñï} {m : ‚Ñï}\n  (A : AffineMap ‚Ñù (EuclideanSpace ‚Ñù (Fin n)) (EuclideanSpace ‚Ñù (Fin m)))\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (D : Set (EuclideanSpace ‚Ñù (Fin m)))\n  (hC : Convex ‚Ñù C)\n  (hD‚ÇÄ : Convex ‚Ñù D)\n  (hD‚ÇÅ : Set.Nonempty (Set.preimage A (intrinsicInterior ‚Ñù D))) :\n  (intrinsicInterior ‚Ñù (Set.image A C) = Set.image A (intrinsicInterior ‚Ñù C)) ‚àß\n  (intrinsicInterior ‚Ñù (Set.preimage A D) = Set.preimage A (intrinsicInterior ‚Ñù D)) := by\n  sorry",
        "proof": "First, note that the continuity of $A$ implies $A(\\operatorname{cl}S)\\subset\\operatorname{cl}[A(S)]$ for any $S\\subset\\mathbb{R}^n$. Apply this result to $\\operatorname{ri}C$, whose closure is $\\operatorname{cl} C$ (Proposition 2.1.8), and use the monotonicity of the closure operation:\n\\[\nA(C)\\subset A(\\operatorname{cl}C)=A[\\operatorname{cl}(\\operatorname{ri}C)]\\subset\\operatorname{cl}[A(\\operatorname{ri}C)]\\subset\\operatorname{cl}[A(C)];\n\\]\nthe closed set $\\operatorname{cl}[A(\\operatorname{ri}C)]$ is therefore $\\operatorname{cl}[A(C)]$. Because $A(\\operatorname{ri}C)$ and $A(C)$ have the same closure, they have the same relative interior (Remark 2.1.9):\n\\[\n\\operatorname{ri}\\,A(C)=\\operatorname{ri}[A(\\operatorname{ri}C)]\\subset A(\\operatorname{ri}C).\n\\]\n\nTo prove the converse inclusion, let $w=A(y)\\in A(\\operatorname{ri}C)$, with $y\\in\\operatorname{ri}C$. We choose $z'=A(x')\\in\\operatorname{ri}A(C)$, with $x'\\in C$ (we assume $z'\\neq w$, hence $x'\\neq y$).\n\nUsing in $C$ the same stretching mechanism as in Fig.\\ 2.1.3, we single out $x\\in C$\nsuch that $y\\in ]x,x'[$, to which corresponds $z=A(x)\\in A(C)$. By affinity, $A(y)\\in\n]A(x),A(x')[=]z,z'[$. Thus, $z$ and $z'$ fulfill the conditions of Lemma 2.1.6 applied\nto the convex set $A(C)$: $w\\in\\operatorname{ri}A(C)$, and (2.1.3) is proved.\n\nThe proof of (2.1.4) uses the same technique."
    },
    {
        "statement": "If $C\\neq\\varnothing$, then $\\operatorname{ri}C\\neq\\varnothing$.  In fact, $\\dim(\\operatorname{ri}C)=\\dim C$.",
        "title": "",
        "label": "thm:CAMA-chap3-2.1.3",
        "lean_tag": [
            "CAMA_chap_3_2_1_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_1_3 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÄ : Nonempty C)\n  (hC‚ÇÅ : Convex ‚Ñù C) :\n  (Set.Nonempty (intrinsicInterior ‚Ñù C)) ‚àß\n  (Module.finrank ‚Ñù (affineSpan ‚Ñù C).direction) =\n  (Module.finrank ‚Ñù (affineSpan ‚Ñù (intrinsicInterior ‚Ñù C)).direction) := by\n  sorry",
        "proof": "Let $k:=1+\\dim C$.  Since $\\operatorname{aff}C$ has dimension $k-1$, $C$ contains $k$ elements affinely independent $x_1,\\dots,x_k$.  Call $\\Delta:=\\operatorname{co}\\{x_1,\\dots,x_k\\}$ the simplex that they generate; see fig.\\ 2.1.1; $\\operatorname{aff}\\Delta=\\operatorname{aff}C$ because $\\Delta\\subset C$ and $\\dim\\Delta=k-1$.  The proof will be finished if we show that $\\Delta$ has nonempty relative interior.\n\nTake $\\bar{x}:=1/k\\sum_{i=1}^k x_i$ (the ``center'' of $\\Delta$) and describe $\\operatorname{aff}\\Delta$ by points of the form\n\\[\n\\bar{x}+y=\\bar{x}+\\sum_{i=1}^k \\alpha_i(y)x_i\n=\\sum_{i=1}^k\\Big[\\tfrac{1}{k}+\\alpha_i(y)\\Big]x_i,\n\\]\n\nwhere $\\alpha(y)=(\\alpha_1(y),\\dots,\\alpha_k(y))\\in\\mathbb R^k$ solves\n\\[\n\\sum_{i=1}^k \\alpha_i x_i = y,\\qquad \\sum_{i=1}^k \\alpha_i = 0.\n\\]\n\nBecause this system has a unique solution, the mapping $y\\mapsto\\alpha(y)$ is (linear and) continuous: we can find $\\delta>0$ such that $\\|y\\|\\le\\delta$ implies\n\\[\n|\\alpha_i(y)|\\le 1/k\\quad\\text{for }i=1,\\dots,k,\n\\]\nhence $\\bar x+y\\in\\Delta$.\n\nIn other words, $\\bar x\\in\\operatorname{ri}\\Delta\\subset\\operatorname{ri}C$.\n\nIt follows in particular $\\dim\\operatorname{ri}C=\\dim\\Delta=\\dim C$."
    },
    {
        "statement": "The three convex sets $\\operatorname{ri}C$, $C$ and $\\operatorname{cl}C$ have the same affine hull (and hence the same dimension), the same relative interior and the same closure (and hence the same relative boundary).",
        "title": "",
        "label": "prop:CAMA-chap3-2.1.8",
        "lean_tag": [
            "CAMA_chap_3_2_1_8"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_1_8 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC_nonempty : Set.Nonempty C)\n  (hC_convex : Convex ‚Ñù C) :\n  (closure (intrinsicInterior ‚Ñù C) = closure C) ‚àß\n  (intrinsicInterior ‚Ñù (closure C) = intrinsicInterior ‚Ñù C) := by\n  sorry",
        "proof": "The case of the affine hull was already seen in Theorem 2.1.3. For the others, the key result is Lemma 2.1.6 (as well as for most other properties involving closures and relative interiors). We illustrate it by restricting our proof to one of the properties, say: $\\operatorname{ri}C$ and $C$ have the same closure.\n\nThus, we have to prove that $\\operatorname{cl}C\\subset\\operatorname{cl}(\\operatorname{ri}C)$. Let $x\\in\\operatorname{cl}C$ and take $x'\\in\\operatorname{ri}C$ (it is possible by virtue of Theorem 2.1.3). Because $[x,x']\\subset\\operatorname{ri}C$ (Lemma 2.1.6), we do have that $x$ is a limit of points in $\\operatorname{ri}C$ (and even a \"radial\" limit); hence $x$ is in the closure of $\\operatorname{ri}C$."
    },
    {
        "statement": "The closed convex cone $C_{\\infty}(x)$ does not depend on $x\\in C$.",
        "title": "",
        "label": "prop:CAMA-chap3-2.2.1",
        "lean_tag": [
            "CAMA_chap_3_2_2_1"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_2_1 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x‚ÇÅ x‚ÇÇ : EuclideanSpace ‚Ñù (Fin n))\n  (hC‚ÇÄ : IsClosed C)\n  (hC‚ÇÅ : Convex ‚Ñù C)\n  (hx‚ÇÅ : x‚ÇÅ ‚àà C)\n  (hx‚ÇÇ : x‚ÇÇ ‚àà C) :\n  (AsymptoticCone C x‚ÇÅ) = (AsymptoticCone C x‚ÇÇ) := by\n  sorry",
        "proof": "See Theorem I.2.3.1 and the pantographic Figure I.2.3.1. Take two different points $x_{1}$ and $x_{2}$ in $C$; it suffices to prove one inclusion, say $C_{\\infty}(x_{1})\\subset C_{\\infty}(x_{2})$. Let $d\\in C_{\\infty}(x_{1})$ and $t>0$, we have to prove $x_{2}+td\\in C$. With $\\varepsilon\\in ]0,1[$, consider the point\n\\[\n\\bar{x}_{\\varepsilon}:=x_{1}+td+(1-\\varepsilon)(x_{2}-x_{1}).\n\\]\n\nWriting it as\n\\[\n\\bar{x}_\\varepsilon = \\varepsilon\\bigl(x_1 + \\tfrac{t}{\\varepsilon} d\\bigr) + (1-\\varepsilon)x_2,\n\\]\nwe see that \\(\\bar{x}_\\varepsilon\\in C\\) (use the definitions of \\(C_\\infty(x_1)\\) and of a convex set). On the other hand,\n\\[\nx_2 + t d = \\lim_{\\varepsilon\\downarrow 0}\\bar{x}_\\varepsilon \\in \\overline{C}.\n\\]"
    },
    {
        "statement": "A closed convex set $C$ is compact if and only if $C_\\infty=\\{0\\}$.",
        "title": "",
        "label": "prop:CAMA-chap3-2.2.3",
        "lean_tag": [
            "CAMA_chap_3_2_2_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_2_3 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÄ : IsClosed C)\n  (hC‚ÇÅ : Convex ‚Ñù C)\n  (hC‚ÇÇ : Set.Nonempty C) :\n  (IsCompact C) ‚Üî ‚àÄ x ‚àà C, (AsymptoticCone C x) = {0} := by\n  sorry",
        "proof": "If $C$ is bounded, it is clear that $C_\\infty$ cannot contain any nonzero direction.\n\nConversely, let $\\{x_k\\}\\subset C$ be such that $\\|x_k\\|\\to+\\infty$ (we assume $x_k\\neq0$). The sequence $\\{d_k:=x_k/\\|x_k\\|\\}$ is bounded, extract a convergent subsequence: $d=\\lim_{k\\in K}d_k$ with $K\\subset\\mathbb N$ ($\\|d\\|=1$). Now, given $x\\in C$ and $t>0$, take $k$ so large that $\\|x_k\\|\\ge t$. Then, we see that\n\\[\nx+td=\\lim_{k\\in K}\\Big[(1-\\tfrac{t}{\\|x_k\\|})x+\\tfrac{t}{\\|x_k\\|}x_k\\Big]\n\\]\nis in the closed convex set $C$, hence $d\\in C_\\infty$."
    },
    {
        "statement": "If $C$ is compact, then $\\operatorname{ext}C\\neq\\varnothing$.",
        "title": "",
        "label": "prop:CAMA-chap3-2.3.3",
        "lean_tag": [
            "CAMA_chap_3_2_3_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_3_3 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÄ : Set.Nonempty C)\n  (hC‚ÇÅ : Convex ‚Ñù C)\n  (hC‚ÇÇ : IsCompact C) :\n  Set.Nonempty (Set.extremePoints ‚Ñù C) := by\n  sorry",
        "proof": "Because $C$ is compact, there is $\\bar x\\in C$ maximizing the continuous function $x\\mapsto\\|x\\|^2$.  We claim that $\\bar x$ is extremal.  In fact, suppose that there are $x_1$ and $x_2$ in $C$ with $\\bar x=\\tfrac12(x_1+x_2)$.  Then, with $x_1\\neq x_2$ and using (2.3.1), we obtain the contradiction\n\\[\n\\|\\bar x\\|^2=\\Big\\|\\tfrac12(x_1+x_2)\\Big\\|^2<\\tfrac12\\big(\\|x_1\\|^2+\\|x_2\\|^2\\big)\\le\\tfrac12\\big(\\|\\bar x\\|^2+\\|\\bar x\\|^2\\big)=\\|\\bar x\\|^2.\n\\]"
    },
    {
        "statement": "(H. Minkowski) Let $C$ be compact, convex in $\\mathbb{R}^n$. Then $C$ is the convex hull of its extreme points: $C=\\operatorname{co}(\\operatorname{ext}C)$.",
        "title": "",
        "label": "thm:CAMA-chap3-2.3.4",
        "lean_tag": [
            "CAMA_chap_3_2_3_4"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_3_4 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÄ : Set.Nonempty C)\n  (hC‚ÇÅ : Convex ‚Ñù C)\n  (hC‚ÇÇ : IsCompact C) :\n  C = convexHull ‚Ñù (Set.extremePoints ‚Ñù C) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Let $F$ be a face of $C$. Then any extreme point of $F$ is an extreme point of $C$.",
        "title": "",
        "label": "prop:CAMA-chap3-2.3.7",
        "lean_tag": [
            "CAMA_chap_3_2_3_7"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_3_7 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (F : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hF : Face C F)\n  (hC‚ÇÄ : Set.Nonempty C)\n  (hC‚ÇÅ : Convex ‚Ñù C) :\n  ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)) (_ : x ‚àà (Set.extremePoints ‚Ñù F)),\n  x ‚àà (Set.extremePoints ‚Ñù C) := by\n  sorry",
        "proof": "Take \\(x\\in F\\subset C\\) and assume that \\(x\\) is not an extreme point of \\(C\\): there are different \\(x_1,x_2\\) in \\(C\\) and \\(\\alpha\\in\\,]0,1[\\) such that \\(x=\\alpha x_1+(1-\\alpha)x_2\\in F\\). From the very definition (2.3.2) of a face, this implies that \\(x_1\\) and \\(x_2\\) are in \\(F\\): \\(x\\) cannot be an extreme point of \\(F\\).\n\\(\\square\\)"
    },
    {
        "statement": "An exposed face is a face.",
        "title": "",
        "label": "prop:CAMA-chap3-2.4.3",
        "lean_tag": [
            "CAMA_chap_3_2_4_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_4_3 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (F : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC_nonempty : Set.Nonempty C)\n  (hC_convex : Convex ‚Ñù C)\n  (hF : IsExposedFace C F) :\n  Face C F := by\n  sorry",
        "proof": "Let $F$ be an exposed face, with its associated support $H_{s,r}$. Take $x_1$ and $x_2$ in $C$:\n\\begin{equation}\n\\langle s,x_i\\rangle \\le r \\quad\\text{for } i=1,2;\n\\label{2.4.2}\n\\end{equation}\ntake also $\\alpha\\in]0,1[$ such that $\\alpha x_1+(1-\\alpha)x_2\\in F\\subset H_{s,r}$:\n\\[\n\\langle s,\\alpha x_1+(1-\\alpha)x_2\\rangle = r.\n\\]\nSuppose that one of the relations \\eqref{2.4.2} holds as strict inequality. By convex combination, we obtain $(0<\\alpha<1!)$\n\\[\n\\langle s,\\alpha x_1+(1-\\alpha)x_2\\rangle < r,\n\\]\na contradiction."
    },
    {
        "statement": "Let $C$ be convex and compact. For $s\\in\\mathbb{R}^n$, there holds\n\\[\n\\max_{x\\in C}\\langle s,x\\rangle=\\max_{x\\in\\operatorname{ext} C}\\langle s,x\\rangle.\n\\]",
        "title": "",
        "label": "prop:CAMA-chap3-2.4.6",
        "lean_tag": [
            "CAMA_chap_3_2_4_6"
        ],
        "lean_formalization": "lemma CAMA_chap_3_2_4_6 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (s : EuclideanSpace ‚Ñù (Fin n))\n  (hC‚ÇÄ : IsCompact C)\n  (hC‚ÇÅ : Convex ‚Ñù C)\n  (hC‚ÇÇ : Set.Nonempty C) :\n  (sSup (Set.image (fun x ‚Ü¶ inner ‚Ñù s x) C) =\n  sSup (Set.image (fun x ‚Ü¶ inner ‚Ñù s x) (Set.extremePoints ‚Ñù C))) ‚àß\n  (Argmax (fun x ‚Ü¶ inner ‚Ñù s x) C =\n  convexHull ‚Ñù (Argmax (fun x ‚Ü¶ inner ‚Ñù s x) (Set.extremePoints ‚Ñù C))) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "A point $y_x\\in C$ is the projection $p_C(x)$ if and only if\n\\[\n\\langle x-y_x,\\;y-y_x\\rangle\\le 0\\qquad\\text{for all }y\\in C .\n\\tag{3.1.3}\n\\]",
        "title": "",
        "label": "thm:CAMA-chap3-3.1.1",
        "lean_tag": [
            "CAMA_chap_3_3_1_1"
        ],
        "lean_formalization": "lemma CAMA_chap_3_3_1_1 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x y : EuclideanSpace ‚Ñù (Fin n))\n  (hC‚ÇÄ : IsClosed C)\n  (hC‚ÇÅ : Convex ‚Ñù C)\n  (hC‚ÇÇ : Set.Nonempty C)\n  (hy : y ‚àà C) :\n  y = pC x C hC‚ÇÄ hC‚ÇÅ hC‚ÇÇ ‚Üî ‚àÄ z ‚àà C, inner ‚Ñù (x - y) (z - y) ‚â§ 0 := by\n  sorry",
        "proof": "Call $y_x$ the solution of (3.1.1); take $y$ arbitrary in $C$, so that $y_x+\\alpha(y-y_x)\\in C$ for any $\\alpha\\in ]0,1[$. Then we can write with the notation (3.1.2)\n\\[\nf_x(y_x)\\le f_x\\big(y_x+\\alpha(y-y_x)\\big)=\\tfrac12\\|y_x-x+\\alpha(y-y_x)\\|^2.\n\\]\nDeveloping the square, we obtain after simplification\n\\[\n0\\le \\alpha\\langle y_x-x,\\;y-y_x\\rangle+\\tfrac12\\alpha^2\\|y-y_x\\|^2.\n\\]\nDivide by $\\alpha\\ (>0)$ and let $\\alpha\\downarrow0$ to obtain (3.1.3).\n\nConversely, suppose that $y_x\\in C$ satisfies (3.1.3). If $y_x=x$, then $y_x$ certainly solves (3.1.1). If not, write for arbitrary $y\\in C$:\n\\[\n0\\ge \\langle x-y_x,\\;y-y_x\\rangle=(x-y_x,\\;y-x+x-y_x)\n\\]\n\\[\n=\\|x-y_x\\|^2+\\langle x-y_x,\\;y-x\\rangle\\ge\\|x-y_x\\|^2-\\|x-y\\|\\;\\|x-y_x\\|,\n\\]\nwhere the Cauchy-Schwarz inequality is used. Divide by $\\|x-y_x\\|>0$ to see that $y_x$ solves (3.1.1)."
    },
    {
        "statement": "For all $(x_1,x_2)\\in\\mathbb{R}^n\\times\\mathbb{R}^n$, there holds\n\\[\n\\|p_C(x_1)-p_C(x_2)\\|^2 \\le \\langle p_C(x_1)-p_C(x_2),\\,x_1-x_2\\rangle.\n\\]",
        "title": "",
        "label": "prop:CAMA-chap3-3.1.3",
        "lean_tag": [
            "CAMA_chap_3_3_1_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_3_1_3 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x‚ÇÅ x‚ÇÇ : EuclideanSpace ‚Ñù (Fin n))\n  (hC‚ÇÄ : IsClosed C)\n  (hC‚ÇÅ : Convex ‚Ñù C)\n  (hC‚ÇÇ : Set.Nonempty C) :\n  ‚Äñ(pC x‚ÇÅ C hC‚ÇÄ hC‚ÇÅ hC‚ÇÇ) - (pC x‚ÇÇ C hC‚ÇÄ hC‚ÇÅ hC‚ÇÇ)‚Äñ ^ 2\n  ‚â§ inner ‚Ñù ((pC x‚ÇÅ C hC‚ÇÄ hC‚ÇÅ hC‚ÇÇ) - (pC x‚ÇÇ C hC‚ÇÄ hC‚ÇÅ hC‚ÇÇ)) (x‚ÇÅ - x‚ÇÇ) := by\n  sorry",
        "proof": "Write (3.1.3) with $x=x_1$, $y=p_C(x_2)\\in C$:\n\\[\n\\langle p_C(x_2)-p_C(x_1),\\,x_1-p_C(x_1)\\rangle \\le 0;\n\\]\nlikewise,\n\\[\n\\langle p_C(x_1)-p_C(x_2),\\,x_2-p_C(x_2)\\rangle \\le 0,\n\\]\nand conclude by addition\n\\[\n\\langle p_C(x_1)-p_C(x_2),\\,x_2-x_1 + p_C(x_1)-p_C(x_2)\\rangle \\le 0.\n\\]"
    },
    {
        "statement": "Let $K$ be a closed convex cone.  Then $y_x = p_K(x)$ if and only if\n\\[\ny_x \\in K,\\qquad x-y_x\\in K^\\circ,\\qquad \\langle x-y_x,y_x\\rangle=0.\n\\tag{3.2.1}\n\\]",
        "title": "",
        "label": "prop:CAMA-chap3-3.2.3",
        "lean_tag": [
            "CAMA_chap_3_3_2_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_3_2_3 {n : ‚Ñï}\n  (K : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x y : EuclideanSpace ‚Ñù (Fin n))\n  (hK‚ÇÄ : IsConvexCone K)\n  (hK‚ÇÅ : IsClosed K)\n  (hK‚ÇÇ : Set.Nonempty K) :\n  y = pC x K hK‚ÇÅ (convexCone_isConvex hK‚ÇÄ) hK‚ÇÇ ‚Üî\n  (y ‚àà K) ‚àß (x - y ‚àà PolarCone K) ‚àß (inner ‚Ñù (x - y) y = 0) := by\n  sorry",
        "proof": "We know from Theorem 3.1.1 that $y_x = p_K(x)$ satisfies\n\\[\n\\langle x-y_x,y-y_x\\rangle\\le 0\\qquad\\text{for all }y\\in K.\n\\tag{3.2.2}\n\\]\nTaking $y=\\alpha y_x$, with arbitrary $\\alpha\\ge 0$, this inequality implies\n\\[\n(\\alpha-1)\\langle x-y_x,y_x\\rangle\\le 0\\qquad\\text{for all }\\alpha\\ge 0.\n\\]\nSince $\\alpha-1$ can have either sign, this implies $\\langle x-y_x,y_x\\rangle=0$ and (3.2.2) becomes\n\\[\n\\langle y,x-y_x\\rangle\\le 0\\quad\\text{for all }y\\in K,\\qquad\\text{i.e.}\\quad x-y_x\\in K^\\circ.\n\\]\n\nConversely, let $y_x$ satisfy (3.2.1).  For arbitrary $y\\in K$, use the notation (3.1.2):\n\\[\nf_x(y)=\\tfrac12\\|x-y_x+y_x-y\\|^2\\ge f_x(y_x)+\\langle x-y_x,y_x-y\\rangle;\n\\]\nbut (3.2.1) shows that\n\\[\n\\langle x-y_x,y_x-y\\rangle=-\\langle x-y_x,y\\rangle\\ge 0,\n\\]\nhence $f_x(y)\\ge f_x(y_x)$: $y_x$ solves (3.1.1)."
    },
    {
        "statement": "Let $K$ be a closed convex cone. For the three elements $x,x_1$ and $x_2$ in $\\mathbb{R}^n$, the properties below are equivalent:\n\\begin{enumerate}\n\\item[(i)] $x=x_1+x_2$ with $x_1\\in K$, $x_2\\in K^\\circ$ and $\\langle x_1,x_2\\rangle=0$;\n\\item[(ii)] $x_1=\\mathrm{p}_K(x)$ and $x_2=\\mathrm{p}_{K^\\circ}(x)$.\n\\end{enumerate}",
        "title": "J.-J. Moreau",
        "label": "thm:CAMA-chap3-3.2.5",
        "lean_tag": [
            "CAMA_chap_3_3_2_5"
        ],
        "lean_formalization": "lemma CAMA_chap_3_3_2_5 {n : ‚Ñï}\n  (K : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x x‚ÇÅ x‚ÇÇ : EuclideanSpace ‚Ñù (Fin n))\n  (hK‚ÇÄ : IsConvexCone K)\n  (hK‚ÇÅ : IsClosed K)\n  (hK‚ÇÇ : Set.Nonempty K) :\n  let K' := (PolarCone K)\n  x = x‚ÇÅ + x‚ÇÇ ‚àß x‚ÇÅ ‚àà K ‚àß x‚ÇÇ ‚àà K' ‚àß inner ‚Ñù x‚ÇÅ x‚ÇÇ = 0 ‚Üî\n  x‚ÇÅ = pC x K hK‚ÇÅ (convexCone_isConvex hK‚ÇÄ) hK‚ÇÇ ‚àß\n  x‚ÇÇ = pC x K' polarCone_isClosed polarCone_isConvex polarCone_isNonempty := by\n  sorry",
        "proof": "Straightforward, from (3.2.3) and the characterization (3.2.1) of $x_1=\\mathrm{p}_K(x)$."
    },
    {
        "statement": "Let \\(C\\subset\\mathbb{R}^n\\) be nonempty closed convex, and let \\(x\\notin C\\). Then there exists \\(s\\in\\mathbb{R}^n\\) such that\n\\[\n\\langle s,x\\rangle > \\sup_{y\\in C}\\langle s,y\\rangle .\n\\tag{4.1.1}\n\\]",
        "title": "",
        "label": "thm:CAMA-chap3-4.1.1",
        "lean_tag": [
            "CAMA_chap_3_4_1_1"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_1_1 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hC_nonempty : Set.Nonempty C)\n  (hC_closed : IsClosed C)\n  (hC_convex : Convex ‚Ñù C)\n  (hx : x ‚àâ C) :\n  ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)), (s ‚â† 0) ‚àß (inner ‚Ñù s x > ‚®Ü y ‚àà C, inner ‚Ñù s y) := by\n  sorry",
        "proof": "Set $s := x - p_C(x) \\neq 0$. We write (3.1.3) as\n\\[\n0 \\ge (s,y-x+s) = (s,y) - (s,x) + \\|s\\|^2.\n\\]\nThus we have\n\\[\n(s,x) - \\|s\\|^2 \\ge (s,y)\\qquad\\text{for all }y\\in C,\n\\]\nand our $s$ is a convenient answer for (4.1.1)."
    },
    {
        "statement": "Let $C_1,\\,C_2$ be two nonempty closed convex sets with $C_1\\cap C_2=\\varnothing$. If $C_2$ is bounded, there exists $s\\in\\mathbb{R}^n$ such that\n\\[\n\\sup_{y\\in C_1}\\langle s,y\\rangle \\;<\\; \\min_{y\\in C_2}\\langle s,y\\rangle .\n\\tag{4.1.2}\n\\]",
        "title": "Strict Separation of Convex Sets",
        "label": "cor:CAMA-chap3-4.1.3",
        "lean_tag": [
            "CAMA_chap_3_4_1_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_1_3 {n : ‚Ñï}\n  (C‚ÇÅ C‚ÇÇ : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÅ : Set.Nonempty C‚ÇÅ)\n  (hC‚ÇÅ' : IsClosed C‚ÇÅ)\n  (hC‚ÇÅ'' : Convex ‚Ñù C‚ÇÅ)\n  (hC‚ÇÇ : Set.Nonempty C‚ÇÇ)\n  (hC‚ÇÇ' : IsClosed C‚ÇÇ)\n  (hC‚ÇÇ'' : Convex ‚Ñù C‚ÇÇ)\n  (hI : (C‚ÇÅ ‚à© C‚ÇÇ) = ‚àÖ)\n  (h_bounded : Bornology.IsBounded C‚ÇÇ) :\n  ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)),\n  ‚®Ü y ‚àà C‚ÇÅ, inner ‚Ñù s y < ‚®Ö y ‚àà C‚ÇÇ, inner ‚Ñù s y := by\n  sorry",
        "proof": "The set $C_1-C_2$ is convex (Proposition 1.2.4) and closed (because $C_2$ is compact). To say that $C_1$ and $C_2$ are disjoint is to say that $0\\notin C_1-C_2$, so we have by Theorem 4.1.1 an $s\\in\\mathbb{R}^n$ separating $\\{0\\}$ from $C_1-C_2$:\n\\[\n\\sup\\{\\langle s,y\\rangle : y\\in C_1-C_2\\}<\\langle s,0\\rangle=0.\n\\]\nThis means:\n\\[\n0 \\;>\\; \\sup_{y_1\\in C_1}\\langle s,y_1\\rangle+\\sup_{y_2\\in C_2}\\langle s,-y_2\\rangle\n=\\sup_{y_1\\in C_1}\\langle s,y_1\\rangle-\\inf_{y_2\\in C_2}\\langle s,y_2\\rangle.\n\\]\nBecause $C_2$ is bounded, the last infimum (is a min and) is finite and can be moved to the left-hand side."
    },
    {
        "statement": "If the two nonempty convex sets $C_1$ and $C_2$ satisfy $\\operatorname{ri}C_1\\cap(\\operatorname{ri}C_2)=\\varnothing$, they can be properly separated.",
        "title": "Proper Separation of Convex Sets",
        "label": "thm:CAMA-chap3-4.1.4",
        "lean_tag": [
            "CAMA_chap_3_4_1_4"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_1_4 {n : ‚Ñï}\n  (C‚ÇÅ C‚ÇÇ : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÅ : Set.Nonempty C‚ÇÅ)\n  (hC‚ÇÅ' : Convex ‚Ñù C‚ÇÅ)\n  (hC‚ÇÇ : Set.Nonempty C‚ÇÇ)\n  (hC‚ÇÇ' : Convex ‚Ñù C‚ÇÇ)\n  (hI : (intrinsicInterior ‚Ñù C‚ÇÅ ‚à© intrinsicInterior ‚Ñù C‚ÇÇ) = ‚àÖ) :\n  ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)),\n  ‚®Ü y‚ÇÅ ‚àà C‚ÇÅ, inner ‚Ñù s y‚ÇÅ ‚â§ ‚®Ö y‚ÇÇ ‚àà C‚ÇÇ, inner ‚Ñù s y‚ÇÇ ‚àß\n  ‚®Ö y‚ÇÅ ‚àà C‚ÇÅ, inner ‚Ñù s y‚ÇÅ < ‚®Ü y‚ÇÇ ‚àà C‚ÇÇ, inner ‚Ñù s y‚ÇÇ := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Let $x\\in\\partial C$, where $C\\neq\\varnothing$ is convex in $\\mathbb{R}^n$ (naturally $C\\neq\\mathbb{R}^n$). There exists a hyperplane supporting $C$ at $x$.",
        "title": "",
        "label": "lem:CAMA-chap3-4.2.1",
        "lean_tag": [
            "CAMA_chap_3_4_2_1"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_2_1 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hC_convex : Convex ‚Ñù C)\n  (hC_nonempty : Set.Nonempty C)\n  (hC_closed : IsClosed C)\n  (hx : x ‚àà frontier C) :\n  ‚àÉ (r : ‚Ñù) (s : EuclideanSpace ‚Ñù (Fin n)), SupportingHyperplaneAt s x r C := by\n  sorry",
        "proof": "Because $C$, $\\operatorname{cl}C$ and their complements have the same boundary (remember Remark 2.1.9), a sequence $\\{x_k\\}$ can be found such that\n\\[\nx_k\\notin C\\quad\\text{for }k=1,2,\\dots\\quad\\text{and}\\quad\n\\lim_{k\\to+\\infty}x_k=x.\n\\]\n\nFor each $k$ we have by Theorem 4.1.1 some $s_k$ with $\\|s_k\\|=1$ such that\n\\[\n\\langle s_k,\\; x_k-y\\rangle>0\\quad\\text{for all }y\\in C\\subset\\operatorname{cl}C .\n\\]\nExtract a subsequence if necessary so that $s_k\\to s$ (note: $s\\neq 0$) and pass to the limit to obtain\n\\[\n\\langle s,\\; x-y\\rangle\\ge0\\quad\\text{for all }y\\in C,\n\\]\nwhich is the required result $\\langle s,x\\rangle=r\\ge\\langle s,y\\rangle$ for all $y\\in C$."
    },
    {
        "statement": "Let $S\\subset\\mathbb{R}^n$ and $C:=\\operatorname{co}S$. Any $x\\in C\\cap\\operatorname{bd}C$ can be represented as a convex combination of $n$ elements of $S$.",
        "title": "",
        "label": "prop:CAMA-chap3-4.2.3",
        "lean_tag": [
            "CAMA_chap_3_4_2_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_2_3 {n : ‚Ñï}\n  (S C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC : C = convexHull ‚Ñù S) :\n  ‚àÄ x ‚àà C ‚à© (frontier C),\n  ‚àÉ (v : Fin n ‚Üí EuclideanSpace ‚Ñù (Fin n)) (a : EuclideanSpace ‚Ñù (Fin n)),\n  (‚àÄ i, v i ‚àà S) ‚àß (a ‚àà ŒîŒ∫ n) ‚àß (x = ‚àë i, a i ‚Ä¢ v i) := by\n  sorry",
        "proof": "Because $x\\in\\operatorname{bd}C$, there is a hyperplane $H_{s,r}$ supporting $C$ at $x$: for some $s\\neq 0$ and $r\\in\\mathbb{R}$,\n\\[\n\\langle s,x\\rangle - r = 0\\qquad\\text{and}\\qquad \\langle s,y\\rangle - r \\le 0\\ \\text{ for all } y\\in C.\n\\tag{4.2.1}\n\\]\nOn the other hand, Carath√©odory's Theorem 1.3.6 implies the existence of points $x_1,\\dots,x_{n+1}$ in $S$ and convex multipliers $\\alpha_1,\\dots,\\alpha_{n+1}$ such that $x=\\sum_{i=1}^{n+1}\\alpha_i x_i$; and each $\\alpha_i$ can be assumed positive (otherwise the proof is finished).\n\nSetting successively $y=x_i$ in (4.2.1), we obtain by convex combination\n\\[\n0=\\langle s,x\\rangle - r = \\sum_{i=1}^{n+1}\\alpha_i\\bigl(\\langle s,x_i\\rangle - r\\bigr)\\le 0,\n\\]\nso each $\\langle s,x_i\\rangle - r$ is actually $0$. Each $x_i$ is therefore not only in $S$, but also in $H_{s,r}$, a set whose dimension is $n-1$. It follows that our starting $x$, which is in $\\operatorname{co}\\{x_1,\\dots,x_{n+1}\\}$, can be described as the convex hull of only $n$ among these $x_i$'s."
    },
    {
        "statement": "Let $\\varnothing\\neq C\\subseteq\\mathbb{R}^n$ be convex. The set $C^*$ defined above is the closure of $C$.",
        "title": "",
        "label": "thm:CAMA-chap3-4.2.4",
        "lean_tag": [
            "CAMA_chap_3_4_2_4"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_2_4 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÄ : Convex ‚Ñù C)\n  (hC‚ÇÅ : Set.Nonempty C)\n  (hC‚ÇÇ : C ‚äÇ Set.univ) :\n  closure C = ‚ãÇ v ‚àà (I_C C), HyperplaneHalfspace v.1 v.2 := by\n  sorry",
        "proof": "By construction, $C^*\\supseteq\\operatorname{cl}C$. Conversely, take $x\\notin\\operatorname{cl}C$; we can separate $x$ and $\\operatorname{cl}C$: there exists $s_0\\neq 0$ such that\n\\[\n\\langle s_0,x\\rangle>\\sup_{y\\in C}\\langle s_0,y\\rangle=:\\,r_0.\n\\]\nThen $(s_0,r_0)\\in\\Sigma_C$; but $x\\notin H_{s_0,r_0}$, hence $x\\notin C^*$."
    },
    {
        "statement": "Let $K$ be a convex cone with polar $K^{\\circ}$; then, the polar $K^{\\circ\\circ}$ of $K^{\\circ}$ is the closure of $K$.",
        "title": "",
        "label": "prop:CAMA-chap3-4.2.7",
        "lean_tag": [
            "CAMA_chap_3_4_2_7"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_2_7 {n : ‚Ñï}\n  (K : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hK_convex_cone : IsConvexCone K)\n  (hK_nonempty : Set.Nonempty K) :\n  PolarCone (PolarCone K) = closure K := by\n  sorry",
        "proof": "We exploit Remark 4.1.2: due to its conical character $(\\alpha x\\in K$ if $\\alpha\\in K$ and $\\alpha>0)$, $\\operatorname{cl}K$ has a very special support function:\n\\[\n\\sigma_{\\operatorname{cl}K}(s)=\n\\begin{cases}\n\\langle s,0\\rangle=0 &\\text{if }\\langle s,x\\rangle\\le 0\\text{ for all }x\\in\\operatorname{cl}K,\\\\[4pt]\n+\\infty &\\text{otherwise}.\n\\end{cases}\n\\]\nIn other words, $\\sigma_{\\operatorname{cl}K}$ is $0$ on $K^{\\circ}$, $+\\infty$ elsewhere. Thus, the characterization\n\\[\nx\\in\\operatorname{cl}K \\iff \\langle\\cdot,x\\rangle\\le\\sigma_{\\operatorname{cl}K}(\\cdot)\n\\]\nbecomes\n\\[\nx\\in\\operatorname{cl}K \\iff\n\\begin{cases}\n\\langle s,x\\rangle\\le 0 &\\text{for all }s\\in K^{\\circ}\\\\[4pt]\n(\\langle s,x\\rangle\\text{ arbitrary}) &\\text{for }s\\notin K^{\\circ},\n\\end{cases}\n\\]\nin which we recognize the definition of $K^{\\circ\\circ}$."
    },
    {
        "statement": "Let $b,s_1,\\dots,s_m$ be given in $\\mathbb{R}^n$. The set\n\\[\n\\{x\\in\\mathbb{R}^n:\\ \\langle s_j,x\\rangle\\le 0\\quad\\text{for }j=1,\\dots,m\\}\n\\tag{4.3.1}\n\\]\nis contained in the set\n\\[\n\\{x\\in\\mathbb{R}^n:\\ \\langle b,x\\rangle\\le 0\\}\n\\tag{4.3.2}\n\\]\nif and only if (see Definition 1.4.5 of a conical hull)\n\\[\nb\\in\\operatorname{cone}\\{s_1,\\dots,s_m\\}.\n\\tag{4.3.3}\n\\]",
        "title": "Farkas I",
        "label": "lem:CAMA-chap3-4.3.1",
        "lean_tag": [
            "CAMA_chap_3_4_3_1"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_3_1 {m n : ‚Ñï}\n  (b : EuclideanSpace ‚Ñù (Fin n))\n  (s : Fin m ‚Üí EuclideanSpace ‚Ñù (Fin n)) :\n  {x : EuclideanSpace ‚Ñù (Fin n) | ‚àÄ j, inner ‚Ñù (s j) x ‚â§ 0} ‚äÜ\n  {x : EuclideanSpace ‚Ñù (Fin n) | inner ‚Ñù b x ‚â§ 0} ‚Üî b ‚àà cone s := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Let $b,s_1,\\dots,s_m$ be given in $\\mathbb{R}^n$. Then exactly one of the following statements is true.\n\\begin{enumerate}\n\\item[$P:=$] \\eqref{4.3.4} has a solution $\\alpha\\in\\mathbb{R}^n$.\n\\item[$Q:=$] \n\\[\n\\left\\{\n\\begin{aligned}\n&\\langle b,x\\rangle>0,\\\\\n&\\langle s_j,x\\rangle\\le 0\\quad\\text{for }j=1,\\dots,m\n\\end{aligned}\n\\right.\n\\]\nhas a solution $x\\in\\mathbb{R}^n$.\n\\end{enumerate}",
        "title": "Farkas II",
        "label": "lem:CAMA-chap3-4.3.2",
        "lean_tag": [
            "CAMA_chap_3_4_3_2"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_3_2 {m n : ‚Ñï}\n  (b : EuclideanSpace ‚Ñù (Fin n))\n  (s : Fin m ‚Üí EuclideanSpace ‚Ñù (Fin n)) :\n  let P := b ‚àà cone s\n  let Q := ‚àÉ (x : EuclideanSpace ‚Ñù (Fin n)), (inner ‚Ñù b x > 0) ‚àß (‚àÄ j, inner ‚Ñù (s j) x ‚â§ 0)\n  (P ‚à® Q) ‚àß ¬¨(P ‚àß Q) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Let $s_1,\\dots,s_m$ be given in $\\mathbb{R}^n$. Then the convex cone\n\\[\nK:=\\operatorname{cone}\\{s_1,\\dots,s_m\\}=\\Big\\{\\sum_{j=1}^m\\alpha_j s_j:\\ \\alpha_j\\ge 0\\ \\text{for }j=1,\\dots,m\\Big\\}\n\\]\nis closed.",
        "title": "Farkas III",
        "label": "lem:CAMA-chap3-4.3.3",
        "lean_tag": [
            "CAMA_chap_3_4_3_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_4_3_3 {m n : ‚Ñï}\n  (s : Fin m ‚Üí EuclideanSpace ‚Ñù (Fin n)) :\n  IsClosed (cone s) := by\n  sorry",
        "proof": "It is quite similar to that of Carath√©odory's Theorem 1.3.6. First, the proof is easy if the $s_j$'s are linearly independent: then, the convergence of\n\\begin{equation}\\label{eq:4.3.5}\nx^k=\\sum_{j=1}^m\\alpha_j^k s_j\\quad\\text{for }k\\to\\infty\n\\end{equation}\nis equivalent to the convergence of each $\\{\\alpha_j^k\\}$ to some $\\alpha_j$, which must be nonnegative if each $\\alpha_j^k$ in \\eqref{eq:4.3.5} is nonnegative.\n\nSuppose, on the contrary, that the system $\\sum_{j=1}^m\\beta_j s_j=0$ has a nonzero solution $\\beta\\in\\mathbb{R}^m$ and assume $\\beta_j<0$ for some $j$ (change $\\beta$ to $-\\beta$ if necessary). As in the proof of Theorem 1.3.6, write each $x\\in K$ as\n\\[\nx=\\sum_{j=1}^m\\alpha_j s_j=\\sum_{j=1}^m[\\alpha_j+t^*(x)\\beta_j]s_j=\\sum_{j\\ne i(x)}\\alpha'_j s_j,\n\\]\nwhere\n\\[\ni(x)\\in\\operatorname{Argmin}_{\\beta_j<0}\\frac{-\\alpha_j}{\\beta_j},\\qquad\nt^*(x):=\\frac{-\\alpha_{i(x)}}{\\beta_{i(x)}},\n\\]\nso that each $\\alpha'_j=\\alpha_j+t^*(x)\\beta_j$ is nonnegative. Letting $x$ vary in $K$, we thus construct\na decomposition\n\\[\nK=\\bigcup\\{K_i:\\; i=1,\\ldots,m\\},\n\\]\nwhere $K_i$ is the conical hull of the $m-1$ generators $s_j,\\; j\\neq i$.\n\nNow, if there is some $i$ such that the generators of $K_i$ are linearly dependent, we repeat the argument for a further decomposition of this $K_i$. After finitely many such operations, we end up with a decomposition of $K$ as a finite union of polyhedral convex cones, each having linearly independent generators. All these cones are therefore closed (first part of the proof), so $K$ is closed as well."
    },
    {
        "statement": "A direction $d$ is tangent to $S$ at $x\\in S$ if and only if\n\\[\n\\exists (d_k)\\to d,\\ \\exists (t_k)\\downarrow 0\\quad\\text{such that}\\quad x+t_kd_k\\in S\\ \\text{for all }k.\n\\]",
        "title": "",
        "label": "prop:CAMA-chap3-5.1.2",
        "lean_tag": [
            "CAMA_chap_3_5_1_2"
        ],
        "lean_formalization": "lemma CAMA_chap_3_5_1_2 {n : ‚Ñï}\n  (d : EuclideanSpace ‚Ñù (Fin n))\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n)) :\n  IsTangentTo S x d ‚Üî\n  ‚àÉ (dk : ‚Ñï ‚Üí EuclideanSpace ‚Ñù (Fin n)), ‚àÉ (tk : ‚Ñï ‚Üí ‚Ñù),\n  (Filter.Tendsto dk Filter.atTop (ùìù d)) ‚àß\n  (Filter.Tendsto tk Filter.atTop (ùìù 0)) ‚àß\n  (‚àÄ i, tk i > 0) ‚àß\n  (‚àÄ k, x + (tk k) ‚Ä¢ (dk k) ‚àà S) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "The tangent cone is closed.",
        "title": "",
        "label": "prop:CAMA-chap3-5.1.3",
        "lean_tag": [
            "CAMA_chap_3_5_1_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_5_1_3 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n)) :\n  IsClosed (TangentCone x S) := by\n  sorry",
        "proof": "Let $\\{d_\\ell\\}\\subset T_S(x)$ be converging to $d$; for each $\\ell$ take sequences $\\{x_{\\ell,k}\\}_k$ and $\\{t_{\\ell,k}\\}_k$ associated with $d_\\ell$ in the sense of Definition 5.1.1. Fix $\\ell>0$: we can find $k_\\ell$ such that\n\\[\n\\left\\|\\frac{x_{\\ell,k_\\ell}-x}{t_{\\ell,k_\\ell}}-d_\\ell\\right\\|\\le\\frac{1}{\\ell}.\n\\]\nLetting $\\ell\\to\\infty$, we then obtain the sequences $\\{x_\\ell,t_\\ell\\}_\\ell$ and $\\{t_\\ell,k_\\ell\\}_\\ell$ which define $d$ as an element of $T_S(x)$."
    },
    {
        "statement": "The tangent cone to $C$ at $x$ is the closure of the cone generated by $C-\\{x\\}$:\n\\begin{align}\nT_C(x)\n&=\\overline{\\operatorname{cone}}(C-x)=\\overline{\\operatorname{cl}}\\mathbb{R}^+(C-x)\\nonumber\\\\\n&=\\overline{\\{d\\in\\mathbb{R}^n:\\;d=\\alpha(y-x),\\;y\\in C,\\;\\alpha\\ge0\\}}.\n\\tag{5.2.1}\n\\end{align}",
        "title": "",
        "label": "prop:CAMA-chap3-5.2.1",
        "lean_tag": [
            "CAMA_chap_3_5_2_1"
        ],
        "lean_formalization": "lemma CAMA_chap_3_5_2_1 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hx_inC : x ‚àà C)\n  (hC_closed : IsClosed C)\n  (hC_convex : Convex ‚Ñù C) :\n  TangentCone x C = closure (GenCone (translate_set C x)) := by\n  sorry",
        "proof": "We have just said that $C-\\{x\\}\\subset T_C(x)$. Because $T_C(x)$ is a closed cone (Proposition 5.1.3), it immediately follows that $\\overline{\\mathbb{R}^+}(C-x)\\subset T_C(x)$. Conversely, for $d\\in T_C(x)$, take $\\{x_k\\}$ and $\\{t_k\\}$ as in the definition (5.1.1): the point $(x_k-x)/t_k$ is in $\\mathbb{R}^+(C-x)$, hence its limit $d$ is in the closure of this latter set. \\qedhere"
    },
    {
        "statement": "The normal cone is the polar of the tangent cone.",
        "title": "",
        "label": "prop:CAMA-chap3-5.2.4",
        "lean_tag": [
            "CAMA_chap_3_5_2_4"
        ],
        "lean_formalization": "lemma CAMA_chap_3_5_2_4 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hX_inC : x ‚àà C)\n  (hC_closed : IsClosed C)\n  (hC_convex : Convex ‚Ñù C) :\n  NormalCone x C = PolarCone (TangentCone x C) := by\n  sorry",
        "proof": "If $\\langle s,d\\rangle\\le 0$ for all $d\\in C-x$, the same holds for all $d\\in\\mathbb R^+(C-x)$, as well as for all $d$ in the closure $T_C(x)$ of the latter. Thus, $N_C(x)\\subset[T_C(x)]^\\circ$.\n\nConversely, take $s$ arbitrary in $[T_C(x)]^\\circ$. The relation $\\langle s,d\\rangle\\le 0$, which holds for all $d\\in T_C(x)$, a fortiori holds for all $d\\in C-x\\subset T_C(x)$; this is just (5.2.2). \\qedhere"
    },
    {
        "statement": "The tangent cone is the polar of the normal cone:\n\\[\nT_C(x)=\\{d\\in\\mathbb{R}^n:\\ \\langle s,d\\rangle\\le 0\\ \\text{for all }s\\in N_C(x)\\}.\n\\]",
        "title": "",
        "label": "cor:CAMA-chap3-5.2.5",
        "lean_tag": [
            "CAMA_chap_3_5_2_5"
        ],
        "lean_formalization": "lemma CAMA_chap_3_5_2_5 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hx_inC : x ‚àà C)\n  (hC_closed : IsClosed C)\n  (hC_convex : Convex ‚Ñù C) :\n  TangentCone x C = PolarCone (NormalCone x C) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Here, the $C$'s are nonempty closed convex sets.\n\\begin{enumerate}[(i)]\n\\item For $x\\in C_1\\cap C_2$, there holds\n\\[\nT_{C_1\\cap C_2}(x)\\subset T_{C_1}(x)\\cap T_{C_2}(x)\n\\qquad\\text{and}\\qquad\nN_{C_1\\cap C_2}(x)\\supset N_{C_1}(x)+N_{C_2}(x).\n\\]\n\n\\item With $C_i\\subset\\mathbb R^{n_i}$, $i=1,2$ and $(x_1,x_2)\\in C_1\\times C_2$,\n\\[\nT_{C_1\\times C_2}(x_1,x_2)=T_{C_1}(x_1)\\times T_{C_2}(x_2),\n\\qquad\nN_{C_1\\times C_2}(x_1,x_2)=N_{C_1}(x_1)\\times N_{C_2}(x_2).\n\\]\n\n\\item With an affine mapping $A(x)=y_0+A_0x$ ($A_0$ linear) and $x\\in C$,\n\\[\nT_{A(C)}[A(x)]=\\operatorname{cl}[A_0T_C(x)]\n\\qquad\\text{and}\\qquad\nN_{A(C)}[A(x)]=A_0^{-*}[N_C(x)].\n\\]\n\n\\item In particular (start from (ii), (iii) and proceed as when proving (1.2.2)):\n\\[\nT_{C_1+C_2}(x_1+x_2)=\\operatorname{cl}[T_{C_1}(x_1)+T_{C_2}(x_2)],\n\\qquad\nN_{C_1+C_2}(x_1+x_2)=N_{C_1}(x_1)\\cap N_{C_2}(x_2).\n\\]\n\\end{enumerate}",
        "title": "",
        "label": "prop:CAMA-chap3-5.3.1",
        "lean_tag": [
            "CAMA_chap_3_5_3_1"
        ],
        "lean_formalization": "lemma CAMA_chap_3_5_3_1 {n : ‚Ñï}\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (C‚ÇÅ : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (C‚ÇÇ : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC‚ÇÅ‚ÇÄ : Set.Nonempty C‚ÇÅ)\n  (hC‚ÇÅ‚ÇÅ : IsClosed C‚ÇÅ)\n  (hC‚ÇÅ‚ÇÇ : Convex ‚Ñù C‚ÇÅ)\n  (hC‚ÇÇ‚ÇÄ : Set.Nonempty C‚ÇÇ)\n  (hC‚ÇÇ‚ÇÅ : IsClosed C‚ÇÇ)\n  (hC‚ÇÇ‚ÇÇ : Convex ‚Ñù C‚ÇÇ) :\n  x ‚àà C‚ÇÅ ‚à© C‚ÇÇ ‚Üí TangentCone x (C‚ÇÅ ‚à© C‚ÇÇ) ‚äÜ TangentCone x C‚ÇÅ ‚à© TangentCone x C‚ÇÇ ‚àß\n  NormalCone x (C‚ÇÅ ‚à© C‚ÇÇ) ‚äá set_add (NormalCone x C‚ÇÅ) (NormalCone x C‚ÇÇ) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "For $x\\in C$ and $s\\in\\mathbb{R}^n$, the following properties are equivalent:\n\\begin{enumerate}\n\\item[(i)] $s\\in N_C(x)$;\n\\item[(ii)] $x$ is in the exposed face $F_C(s)$: $\\langle s,x\\rangle=\\max_{y\\in C}\\langle s,y\\rangle$;\n\\item[(iii)] $x=p_C(x+s)$.\n\\end{enumerate}",
        "title": "",
        "label": "prop:CAMA-chap3-5.3.3",
        "lean_tag": [
            "CAMA_chap_3_5_3_3"
        ],
        "lean_formalization": "lemma CAMA_chap_3_5_3_3 {n : ‚Ñï}\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (s : EuclideanSpace ‚Ñù (Fin n))\n  (hC_nonempty : Set.Nonempty C)\n  (hC_closed : IsClosed C)\n  (hC_convex : Convex ‚Ñù C)\n  (hx_in_C : x ‚àà C) :\n  List.TFAE [\n    s ‚àà NormalCone x C,\n    (inner ‚Ñù s x) = ‚®Ü y ‚àà C, inner ‚Ñù s y,\n    x = pC (x + s) C hC_closed hC_convex hC_nonempty\n  ] := by\n  sorry\n",
        "proof": "Nothing really new: everything comes from the definitions of normal cones, supporting hyperplanes, exposed faces, and the characteristic property (3.1.3) of the projection operator."
    },
    {
        "statement": "The function $f$ is strongly convex on $C$ with modulus $c$ if and only if the function $f-\\tfrac{1}{2}c\\|\\cdot\\|^{2}$ is convex on $C$.",
        "title": "",
        "label": "prop:FCA-chapB-1.1.2",
        "lean_tag": [
            "FCA_chap_B_1_1_2"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_1_2 {n : ‚Ñï}\n  (c : ‚Ñù) (C : Set (EuclideanSpace ‚Ñù (Fin n))) (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (hC_nonempty : Set.Nonempty C) (hC_convex : Convex ‚Ñù C)\n  : StrongConvexOn C c f ‚Üî ConvexOn ‚Ñù C (fun x => f x - (c/2) * ‚Äñx‚Äñ^2)\n  := by sorry",
        "proof": "Use direct calculations in the definition (1.1.1) of convexity applied to the function $f-\\tfrac{1}{2}c\\|\\cdot\\|^{2}$, namely:\n\\[\nf(\\alpha x+(1-\\alpha)x')-\\tfrac{1}{2}c\\|\\alpha x+(1-\\alpha)x'\\|^{2}\\le\n\\]\n\\[\n\\le \\alpha f(x)+(1-\\alpha)f(x')-\\tfrac{1}{2}c\\big[\\alpha\\|x\\|^{2}+(1-\\alpha)\\|x'\\|^{2}\\big].\n\\]"
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}\\cup\\{+\\infty\\}$ be not identically equal to $+\\infty$. The three properties below are equivalent:\n\\begin{enumerate}\n\\item[(i)] $f$ is convex in the sense of Definition 1.1.3;\n\\item[(ii)] its epigraph is a convex set in $\\mathbb{R}^n\\times\\mathbb{R}$;\n\\item[(iii)] its strict epigraph is a convex set in $\\mathbb{R}^n\\times\\mathbb{R}$.\n\\end{enumerate}",
        "title": "",
        "label": "prop:FCA-chapB-1.1.6",
        "lean_tag": [
            "FCA_chap_B_1_1_6"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_1_6 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (hf_nonemptyDomain : ‚àÉ x, f x < ‚ä§)\n  : List.TFAE [\n    ConvexOn ‚Ñù Set.univ f,\n    Convex ‚Ñù (epigraph (liftWithToptoEReal f)),\n    Convex ‚Ñù (strictEpigraph f)\n  ]\n  := by sorry",
        "proof": "Left as an exercise."
    },
    {
        "statement": "(Inequality of Jensen) Let $f\\in\\operatorname{Conv}\\mathbb{R}^n$. Then, for all collections $\\{x_1,\\dots,x_k\\}$ of points in $\\dom f$ and all $\\alpha=(\\alpha_1,\\dots,\\alpha_k)$ in the unit simplex of $\\mathbb{R}^k$, there holds (inequality of Jensen in summation form)\n\\[\nf\\!\\bigg(\\sum_{i=1}^k \\alpha_i x_i\\bigg)\\le \\sum_{i=1}^k \\alpha_i f(x_i).\n\\]",
        "title": "",
        "label": "thm:FCA-chapB-1.1.8",
        "lean_tag": [
            "FCA_chap_B_1_1_8"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_1_8 {n : ‚Ñï}\n  (k : ‚Ñï) (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hC_convex : InConvRn f)\n  : ‚àÄ (x : Fin k ‚Üí EuclideanSpace ‚Ñù (Fin n)), ‚àÄ (Œ± : EuclideanSpace ‚Ñù (Fin k)),\n    Œ± ‚àà ŒîŒ∫ k ‚Üí f (‚àë i, (Œ± i) ‚Ä¢ (x i)) ‚â§ ‚àë i, (Œ± i) ‚Ä¢ f (x i)\n  := by sorry",
        "proof": "The $k$ points $(x_i,f(x_i))\\in\\mathbb{R}^n\\times\\mathbb{R}$ are clearly in $\\epi f$, a convex set. Their convex combination\n\\[\n\\sum_i \\alpha_i (x_i,f(x_i)) = \\Big(\\sum_i \\alpha_i x_i,\\sum_i \\alpha_i f(x_i)\\Big)\n\\]\nis also in $\\epi f$ (Proposition A.1.3.3). This is just the claimed inequality."
    },
    {
        "statement": "Let $f\\in\\Conv\\R^n$.  The relative interior of $\\operatorname{epi}f$ is the union over $x\\in\\operatorname{ri}\\,\\operatorname{dom}f$ of the open half-lines with bottom endpoints at $f(x)$:\n\\[\n\\operatorname{ri}\\operatorname{epi}f=\\{(x,r)\\in\\R^n\\times\\R : x\\in\\operatorname{ri}\\operatorname{dom}f,\\ r>f(x)\\}.\n\\]",
        "title": "",
        "label": "prop:FCA-chapB-1.1.9",
        "lean_tag": [
            "FCA_chap_B_1_1_9"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_1_9 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hf_convex : InConvRn f)\n  : intrinsicInterior ‚Ñù (epigraph (liftWithToptoEReal f)) =\n    {p : EuclideanSpace ‚Ñù (Fin n) √ó ‚Ñù | p.1 ‚àà intrinsicInterior ‚Ñù (effDom (liftWithToptoEReal f)) ‚àß p.2 > f p.1}\n  := by sorry",
        "proof": "Since $\\operatorname{dom}f$ is the image of $\\operatorname{epi}f$ under the linear mapping ``projection onto $\\R^n$'', Proposition A.2.1.12 tells us that\n\\[\n\\operatorname{ri}\\operatorname{dom}f\\ \\text{is the projection onto }\\R^n\\ \\text{of }\\operatorname{ri}\\operatorname{epi}f.\n\\tag{1.1.5}\n\\]\nNow take $x$ arbitrary in $\\operatorname{ri}\\operatorname{dom}f$.  The subset of $\\operatorname{ri}\\operatorname{epi}f$ that is projected onto $x$ is just $((\\{x\\}\\times\\R)\\cap\\operatorname{ri}\\operatorname{epi}f)$, which in turn is $\\operatorname{ri}((\\{x\\}\\times\\R)\\cap\\operatorname{epi}f)$ (use Proposition A.2.1.10).  This latter set is clearly $\\{x\\}\\times(f(x),+\\infty)$.\n\nIn summary, we have proved that, for $x\\in\\operatorname{ri}\\operatorname{dom}f$, $(x,r)\\in\\operatorname{ri}\\operatorname{epi}f$ if and only if $r>f(x)$.  Together with (1.1.5), this proves our claim."
    },
    {
        "statement": "Any $f\\in\\operatorname{Conv}\\mathbb{R}^n$ is minorized by some affine function.  More precisely: for any $x_0\\in\\operatorname{ri}\\operatorname{dom}f$, there is $s$ in the subspace parallel to $\\operatorname{aff}\\operatorname{dom}f$ such that\n\\[\nf(x)\\ge f(x_0)+\\langle s,\\,x-x_0\\rangle\\quad\\text{for all }x\\in\\mathbb{R}^n.\n\\]",
        "title": "",
        "label": "thm:FCA-chapB-1.2.1",
        "lean_tag": [
            "FCA_chap_B_1_2_1"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_2_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hf_convex : InConvRn f)\n  : ‚àÄ (x‚ÇÄ : EuclideanSpace ‚Ñù (Fin n)), (x‚ÇÄ ‚àà intrinsicInterior ‚Ñù (effDom (liftWithToptoEReal f))) ‚Üí\n    ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)), ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)),\n    (s ‚àà parallelSubspace (affineHull (effDom (liftWithToptoEReal f)))) ‚àß (f x ‚â• f x‚ÇÄ + inner ‚Ñù s (x - x‚ÇÄ))\n  := by sorry",
        "proof": ""
    },
    {
        "statement": "For $f:\\mathbb{R}^n\\to\\mathbb{R}\\cup\\{+\\infty\\}$, the following three properties are equivalent:\n\\begin{enumerate}\n\\item[(i)] $f$ is lower semi-continuous on $\\mathbb{R}^n$;\n\\item[(ii)] $\\operatorname{epi} f$ is a closed set in $\\mathbb{R}^n\\times\\mathbb{R}$;\n\\item[(iii)] the sublevel-sets $S_r(f)$ are closed (possibly empty) for all $r\\in\\mathbb{R}$.\n\\end{enumerate}",
        "title": "",
        "label": "prop:FCA-chapB-1.2.2",
        "lean_tag": [
            "FCA_chap_B_1_2_2"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_2_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  : List.TFAE [\n      LowerSemicontinuousOn f Set.univ,\n      IsClosed (epigraph (liftWithToptoEReal f)),\n      ‚àÄ (r : ‚Ñù), IsClosed (sublevelSet r f)\n  ]\n  := by sorry",
        "proof": "[(i) $\\Rightarrow$ (ii)] Let $(y_k,r_k)_k$ be a sequence of $\\operatorname{epi} f$ converging to $(x,r)$ for $k\\to+\\infty$. Since $f(y_k)\\le r_k$ for all $k$, the l.s.c.\\ relation (1.2.3) readily gives\n\\[\nr=\\lim r_k \\ge \\liminf f(y_k)\\ge \\liminf_{y\\to x} f(y)\\ge f(x),\n\\]\ni.e.\\ $(x,r)\\in\\operatorname{epi} f$.\n\n[(ii) $\\Rightarrow$ (iii)] Construct the sublevel-sets $S_r(f)$ as in Remark 1.1.7: the closed sets $\\operatorname{epi} f$ and $\\mathbb{R}^n\\times\\{r\\}$ have a closed intersection.\n\n[(iii) $\\Rightarrow$ (i)] Suppose $f$ is not lower semi-continuous at some $x$: there is a (sub)sequence $(y_k)$ converging to $x$ such that $f(y_k)$ converges to $\\rho<f(x)\\le +\\infty$. Pick $r\\in[\\rho,f(x))$: for $k$ large enough, $f(y_k)\\le r< f(x)$; hence $S_r(f)$ contains the tail of $(y_k)$ but not its limit $x$. Consequently, this $S_r(f)$ is not closed."
    },
    {
        "statement": "Let $f\\in\\operatorname{Conv}\\mathbb{R}^n$ and $x'\\in\\operatorname{ri}\\operatorname{dom}f$. There holds (in $\\mathbb{R}\\cup\\{+\\infty\\}$)\n\\[\n\\operatorname{cl}f(x)=\\lim_{t\\downarrow 0}f\\big(x+t(x'-x)\\big)\\quad\\text{for all }x\\in\\mathbb{R}^n.\n\\]",
        "title": "",
        "label": "prop:FCA-chapB-1.2.5",
        "lean_tag": [
            "FCA_chap_B_1_2_5"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_2_5 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (x‚ÇÄ : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : InConvRn f) (hx : x‚ÇÄ ‚àà intrinsicInterior ‚Ñù (effDom (liftWithToptoEReal f)))\n  : ‚àÄ x, Filter.Tendsto (fun t => f (x + t ‚Ä¢ (x‚ÇÄ - x))) (ùìù[>] 0) (ùìù (lscHull f x))\n  := by sorry",
        "proof": "Since $x_t:=x+t(x'-x)\\to x$ when $t\\downarrow 0$, we certainly have\n\\[\n(\\operatorname{cl}f)(x)\\le\\liminf_{t\\downarrow 0}f\\big(x+t(x'-x)\\big).\n\\]\n\nWe will prove the converse inequality by showing that\n\\[\n\\limsup_{t\\downarrow 0}f\\big(x+t(x'-x)\\big)\\le r\\quad\\text{for all }r\\ge(\\operatorname{cl}f)(x).\n\\]\n\n(Non-existence of such an $r$ means that $\\operatorname{cl}f(x)=+\\infty$, the proof is finished.)\n\nThus let $(x,r)\\in\\operatorname{epi}(\\operatorname{cl}f)=\\operatorname{cl}(\\operatorname{epi}f)$. Pick $r'>f(x')$, hence $(x',r')\\in\\operatorname{epi}f$ (Proposition 1.1.9). Applying Lemma A.2.1.6 to the convex set $\\operatorname{epi}f$, we see that\n\\[\nt(x',r')+(1-t)(x,r)\\in\\operatorname{epi}f\\subset\\operatorname{epi}f\\quad\\text{for all }t\\in]0,1].\n\\]\n\nThis just means\n\\[\nf\\big(x+t(x'-x)\\big)\\le tr'+(1-t)r\\quad\\text{for all }t\\in]0,1]\n\\]\nand our required inequality follows by letting $t\\downarrow 0$."
    },
    {
        "statement": "For $f\\in\\Conv\\R^n$, there holds\n\\[\n\\operatorname{cl} f\\in\\Conv\\R^n;\n\\tag{1.2.7}\n\\]\n\\[\n\\operatorname{cl} f\\text{ and }f\\text{ coincide on the relative interior of }\\dom f.\n\\tag{1.2.8}\n\\]",
        "title": "",
        "label": "prop:FCA-chapB-1.2.6",
        "lean_tag": [
            "FCA_chap_B_1_2_6"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_2_6 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (hf_convex : InConvRn f)\n  : let cl_f := lscHull f\n    (InConvRn cl_f) ‚àß (‚àÄ x ‚àà intrinsicInterior ‚Ñù (effDom (liftWithToptoEReal f)), cl_f x = f x)\n  := by sorry",
        "proof": "We already know from Proposition A.1.2.6 that $\\epi\\operatorname{cl} f=\\operatorname{cl}\\epi f$ is a convex set; also $\\operatorname{cl} f\\le f\\not\\equiv+\\infty$; finally, Proposition 1.2.1 guarantees in the relation of definition (1.2.4) that $\\operatorname{cl} f(x)>-\\infty$ for all $x$: (1.2.7) does hold.\n\nOn the other hand, suppose $x\\in\\ri\\dom f$. Then the one-dimensional function $\\varphi(t)=f(x+td)$ is continuous at $t=0$ (Theorem 0.6.2); it follows from Proposition 1.2.5 that $\\operatorname{cl} f$ coincides with $f$ on $\\ri\\dom f$; besides, $\\operatorname{cl} f(x)$ is obviously equal to $f(x)=+\\infty$ for all $x\\notin\\cl\\dom f$. Altogether, (1.2.8) is true."
    },
    {
        "statement": "The closure of $f\\in\\Conv\\R^n$ is the supremum of all affine functions minorizing $f$:\n\\[\n\\cl f(x)=\\sup_{(s,b)\\in\\R^n\\times\\R}\\{\\langle s,x\\rangle-b:\\langle s,y\\rangle-b\\le f(y)\\text{ for all }y\\in\\R^n\\}.\n\\tag{1.2.9}\n\\]",
        "title": "",
        "label": "thm:FCA-chapB-1.2.8",
        "lean_tag": [
            "FCA_chap_B_1_2_8"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_2_8 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (hf_convex : InConvRn f)\n  : let cl_f := lscHull f\n    ‚àÄ x, cl_f x = sSup {v : ‚Ñù | ‚àÉ (z : EuclideanSpace ‚Ñù (Fin n) √ó ‚Ñù),\n                                (v = inner ‚Ñù z.1 x - z.2) ‚àß (‚àÄ y, (inner ‚Ñù z.1 y) - z.2 ‚â§ f y)}\n  := by sorry",
        "proof": "A closed half-space containing $\\epi f$ is characterized by a nonzero vector $(s,\\alpha)\\in\\R^n\\times\\R$ and a real number $b$ such that\n\\[\n\\langle s,x\\rangle+\\alpha r\\le b\\qquad\\text{for all }(x,r)\\in\\epi f\n\\tag{1.2.10}\n\\]\n(we equip the graph-space $\\R^n\\times\\R$ with the scalar product of a product-space). Let us denote by $\\Sigma\\subset\\R^n\\times\\R\\times\\R$ the index-set of such triples $\\sigma=(s,\\alpha,b)$, with corresponding half-space\n\\[\nH^-_{\\sigma}:=\\{(x,r):\\langle s,x\\rangle+\\alpha r\\le b\\}.\n\\tag{1.2.11}\n\\]\n\nIn other words, $\\operatorname{epi}(\\overline{cl}\\,f)=\\overline{\\operatorname{epi}f}=\\bigcap_{\\sigma\\in\\Sigma}H^-_{\\sigma}$.\n\nBecause of the particular nature of an epigraph, (1.2.10) implies $\\alpha\\le 0$ (let $r\\to +\\infty$) and, by positive homogeneity, the values $\\alpha=0$ and $\\alpha=-1$ suffice: $\\Sigma$ can be partitioned in\n\n\\[\n\\Sigma_1 := \\{(s,-1,b):(1.2.10)\\ \\text{holds with }\\alpha=-1\\}\n\\]\n\nand\n\n\\[\n\\Sigma_0 := \\{(s,0,b):(1.2.10)\\ \\text{holds with }\\alpha=0\\}.\n\\]\n\nIndeed, $\\Sigma_1$ corresponds to affine functions minorizing $f$ (Proposition 1.2.1 tells us that $\\Sigma_1\\neq\\varnothing$) and $\\Sigma_0$ to closed half-spaces of $\\mathbb{R}^{n}$ containing $\\operatorname{dom}f$ (note that $\\Sigma_0=\\varnothing$ if $\\operatorname{dom}f=\\mathbb{R}^n$).\n\nWe have to prove that, even when $\\Sigma_0\\neq\\varnothing$, intersecting the half-spaces $H^-_{\\sigma}$ over $\\Sigma$ or over $\\Sigma_1$ produces the same set, namely $\\operatorname{epi}f$. For this we take arbitrary $\\sigma_0=(s_0,0,b_0)\\in\\Sigma_0$ and $\\sigma_1=(s_1,-1,b_1)\\in\\Sigma_1$, we set\n\n\\[\n\\sigma(t):=(s_1+ts_0,-1,b_1+t b_0)\\in\\Sigma_1\\quad\\text{for all }t\\ge 0,\n\\]\n\nand we prove (see Fig. 1.2.1)\n\n\\[\nH^-_{\\sigma_0}\\cap H^-_{\\sigma_1}=\\bigcap_{t\\ge 0}H^-_{\\sigma(t)}=:\\,H^-.\n\\]\n\nFig. 1.2.1. Closing a convex epigraph\n\nIt results directly from the definition (1.2.11) that an $(x,r)$ in $H^-_{\\sigma_0}\\cap H^-_{\\sigma_1}$ satisfies\n\n\\[\n\\langle s_1+ts_0,x\\rangle-(b_1+tb_0)\\le r\\quad\\text{for all }t\\ge 0,\\tag{1.2.12}\n\\]\n\ni.e.\\ $(x,r)\\in H^-$. Conversely, take $(x,r)\\in H^-$. Set $t=0$ in (1.2.12) to see that $(x,r)\\in H^-_{\\sigma_1}$. Also, divide by $t>0$ and let $t\\to+\\infty$ to see that $(x,r)\\in H^-_{\\sigma_0}$. The proof is complete."
    },
    {
        "statement": "Let $C$ be a nonempty subset of $\\mathbb{R}^n\\times\\mathbb{R}$ satisfying \\eqref{1.3.2}, and let its lower-bound function $\\ell_C$ be defined by \\eqref{1.3.5}.\n\\begin{enumerate}[(i)]\n\\item If $C$ is convex, then $\\ell_C\\in\\operatorname{Conv}\\mathbb{R}^n$;\n\\item If $C$ is closed convex, then $\\ell_C\\in\\overline{\\operatorname{Conv}}\\mathbb{R}^n$.\n\\end{enumerate}",
        "title": "",
        "label": "thm:FCA-chapB-1.3.1",
        "lean_tag": [
            "FCA_chap_B_1_3_1"
        ],
        "lean_formalization": "lemma FCA_chap_B_1_3_1 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n) √ó ‚Ñù))\n  (hC_nonempty : Nonempty C) (hC_minorized : ‚àÄ x, minorizedAt C x)\n  : (Convex ‚Ñù C ‚Üí InConvRn (lowerBoundFunction C)) ‚àß\n    (Convex ‚Ñù C ‚àß IsClosed C ‚Üí InClosedConvRn (lowerBoundFunction C))\n  := by sorry",
        "proof": "We use the analytical definition (1.1.1). Take arbitrary $\\varepsilon>0$, $\\alpha\\in]0,1[$ and $(x_i,r_i)\\in C$ such that $r_i\\le \\ell_C(x_i)+\\varepsilon$ for $i=1,2$.\n\nWhen $C$ is convex, $(\\alpha x_1+(1-\\alpha)x_2,\\alpha r_1+(1-\\alpha)r_2)\\in C$, hence\n\\[\n\\ell_C(\\alpha x_1+(1-\\alpha)x_2)\\le \\alpha r_1+(1-\\alpha)r_2 \\le \\alpha\\ell_C(x_1)+(1-\\alpha)\\ell_C(x_2)+\\varepsilon.\n\\]\n\nThe convexity of $\\ell_C$ follows, since $\\varepsilon>0$ was arbitrary; (i) is proved.\n\nNow take a sequence $(x_k,\\rho_k)_k\\subset\\operatorname{epi}\\ell_C$ converging to $(x,\\rho)$; we have to prove $\\ell_C(x)\\le \\rho$ (cf.\\ Proposition 1.2.2). By definition of $\\ell_C(x_k)$, we can select, for each positive integer $k$, a real number $r_k$ such that $(x_k,r_k)\\in C$ and\n\\begin{equation}\\label{eq:1.3.7}\n\\ell_C(x_k)\\le r_k\\le \\ell_C(x_k)+\\tfrac{1}{k}\\le \\rho_k+\\tfrac{1}{k}.\n\\end{equation}\n\nWe deduce first that $(r_k)$ is bounded from above. Also, when $\\ell_C$ is convex, Proposition 1.2.1 implies the existence of an affine function minorizing $\\ell_C$: $(r_k)$ is bounded from below.\n\nExtracting a subsequence if necessary, we may assume $r_k\\to r$. When $C$ is closed, $(x,r)\\in C$, hence $\\ell_C(x)\\le r$; but pass to the limit in \\eqref{eq:1.3.7} to see that $r\\le \\rho$; the proof is complete."
    },
    {
        "statement": "Let $f_1,\\dots,f_m$ be in $\\Conv\\R^n$ [resp.\\ in $\\overline{\\Conv}\\R^n$], let $t_1,\\dots,t_m$ be positive numbers, and assume that there is a point where all the $f_j$'s are finite. Then the function $f:=\\sum_{j=1}^m t_j f_j$ is in $\\Conv\\R^n$ [resp.\\ in $\\overline{\\Conv}\\R^n$].",
        "title": "",
        "label": "thm:FCA-chapB-2.1.1",
        "lean_tag": [
            "FCA_chap_B_2_1_1"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_1_1 {n : ‚Ñï} {m : ‚Ñï}\n  (f : Fin m ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)) (t : Fin m ‚Üí ‚Ñù)\n  (ht_positive : ‚àÄ i, (t i) > 0)\n  : let g := fun x => ‚àë i, (t i) * ((f i) x)\n    (‚àÄ i, InConvRn (f i) ‚Üí InConvRn g) ‚àß\n    (‚àÄ i, InClosedConvRn (f i) ‚Üí InClosedConvRn g)\n  := by sorry",
        "proof": "The convexity of $f$ is readily proved from the relation of definition (1.1.1). As for its closedness, start from\n\\[\n\\liminf_{y\\to x} t_j f_j(y)=t_j\\liminf_{y\\to x} f_j(y)\\ge t_j f_j(x)\n\\]\n(valid for $t_j>0$ and $f_j$ closed); then note that the lim inf of a sum is not smaller than the sum of lim inf's."
    },
    {
        "statement": "Let $\\{f_j\\}_{j\\in J}$ be an arbitrary family of convex [resp.\\ closed convex] functions. If there exists $x_0$ such that $\\sup_{j} f_j(x_0) < +\\infty$, then their pointwise supremum $f := \\sup\\{f_j : j\\in J\\}$ is in $\\mathrm{Conv}\\,\\mathbb{R}^n$ [resp.\\ in $\\mathrm{Conv}_\\mathrm{cl}\\,\\mathbb{R}^n$].",
        "title": "",
        "label": "prop:FCA-chapB-2.1.2",
        "lean_tag": [
            "FCA_chap_B_2_1_2"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_1_2 {n : ‚Ñï}\n  (J : Set ‚Ñï) (f : ‚Ñï ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù))\n  (hx‚ÇÄ : ‚àÉ x‚ÇÄ, sSup {y | ‚àÉ j, (j ‚àà J) ‚àß ((f j) x‚ÇÄ = y)} < ‚ä§)\n  : let g := fun x => sSup {y | ‚àÉ j, (j ‚àà J) ‚àß ((f j) x = y)}\n    (‚àÄ j ‚àà J, ConvexOn ‚Ñù Set.univ (f j) ‚Üí InConvRn g) ‚àß\n    (‚àÄ j ‚àà J, ConvexOn ‚Ñù Set.univ (f j) ‚àß ‚àÄ j ‚àà J, ‚àÄ x, (lscHull (f j)) x = (f j) x ‚Üí InClosedConvRn g)\n  := by sorry",
        "proof": "The key property is that a supremum of functions corresponds to an intersection of epigraphs: $\\operatorname{epi} f = \\bigcap_{j\\in J}\\operatorname{epi} f_j$, which conserves convexity and closedness. The only needed restriction is nonemptiness of this intersection."
    },
    {
        "statement": "Let $f\\in\\operatorname{Conv}\\mathbb{R}^n$ [resp.\\ $\\overline{\\operatorname{Conv}}\\mathbb{R}^n$] and let $A$ be an affine mapping from $\\mathbb{R}^m$ to $\\mathbb{R}^n$ such that $\\operatorname{Im}A\\cap\\operatorname{dom}f\\neq\\varnothing$.  Then the function\n\\[\nf\\circ A : \\mathbb{R}^m \\supseteq x\\mapsto (f\\circ A)(x)=f(A(x))\n\\]\nis in $\\operatorname{Conv}\\mathbb{R}^m$ [resp.\\ $\\overline{\\operatorname{Conv}}\\mathbb{R}^m$].",
        "title": "",
        "label": "prop:FCA-chapB-2.1.4",
        "lean_tag": [
            "FCA_chap_B_2_1_4"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_1_4 {m n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (A : AffineMap ‚Ñù (EuclideanSpace ‚Ñù (Fin m)) (EuclideanSpace ‚Ñù (Fin n)))\n  (hf_nonempty : (Set.range A) ‚à© (effDom (liftWithToptoEReal f)) ‚â† ‚àÖ)\n  : let g := fun x => f (A x)\n    (InConvRn f ‚Üí InConvRn g) ‚àß\n    (InClosedConvRn f ‚Üí InClosedConvRn g)\n  := by sorry",
        "proof": "Clearly $(f\\circ A)(x)>-\\infty$ for all $x$; besides, there exists by assumption $y=A(x)\\in\\mathbb{R}^n$ such that $f(y)<+\\infty$. To check convexity, it suffices to plug the relation\n\\[\nA(\\alpha x+(1-\\alpha)x')=\\alpha A(x)+(1-\\alpha)A(x')\n\\]\ninto the analytical definition (1.1.1) of convexity. As for closedness, it comes readily from the continuity of $A$ when $f$ is itself closed."
    },
    {
        "statement": "If $f\\in\\operatorname{Conv}\\mathbb{R}^n$, its perspective $\\tilde f$ is in $\\operatorname{Conv}\\mathbb{R}^{n+1}$.",
        "title": "",
        "label": "prop:FCA-chapB-2.2.1",
        "lean_tag": [
            "FCA_chap_B_2_2_1"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_2_1 {m n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (hf_convex : InConvRn f)\n  : InConvRn (fun x => (perspective f) (x 0) (Matrix.vecTail x))\n  := by sorry",
        "proof": "Here also, it is better to look at $\\tilde f$ with ``geometric glasses'':\n\\[\n\\operatorname{epi}\\tilde f=\\{(u,x,r)\\in\\mathbb{R}_+^\\times\\times\\mathbb{R}^n\\times\\mathbb{R}:\\; f(x/u)\\le r/u\\}\n=\\{u(1,x',r'):\\;u>0,(x',r')\\in\\operatorname{epi}f\\}\n\\]\n\\[\n=\\bigcup_{u>0}u(\\{1\\}\\times\\operatorname{epi}f)=\\mathbb{R}_+^\\times(\\{1\\}\\times\\operatorname{epi}f)\n\\]\nand $\\operatorname{epi}\\tilde f$ is therefore a convex cone."
    },
    {
        "statement": "Let $f\\in\\operatorname{Conv}\\mathbb{R}^n$ and let $x'\\in\\operatorname{ri}\\dom f$. Then the closure $\\overline{f}$ of its perspective is given as follows:\n\\[\n(\\cl\\tilde f)(u,x)=\n\\begin{cases}\nu f(x/u) & \\text{if } u>0,\\\\[4pt]\n\\lim_{\\alpha\\downarrow0}\\alpha f(x'-x+\\tfrac{x}{\\alpha}) & \\text{if } u=0,\\\\[4pt]\n+\\infty & \\text{if } u<0.\n\\end{cases}\n\\]",
        "title": "",
        "label": "prop:FCA-chapB-2.2.2",
        "lean_tag": [
            "FCA_chap_B_2_2_2"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_2_2 {m n : ‚Ñï} [NeZero n]\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (x' : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : InClosedConvRn f) (hx : x' ‚àà intrinsicInterior ‚Ñù (effDom (liftWithToptoEReal f)))\n  : let pers := fun z => (perspective f) (z 0) (Matrix.vecTail z)\n    let x : EuclideanSpace ‚Ñù (Fin (n + 1)) := (Matrix.vecCons 1 x')\n  ‚àÄ (z : EuclideanSpace ‚Ñù (Fin (n + 1))), (z 0 ‚â• 0) ‚Üí\n    Filter.Tendsto (fun Œ± => pers (z + Œ± ‚Ä¢ (x - z))) (ùìù[>] 0) (ùìù (lscHull pers z))\n  := by sorry",
        "proof": "Suppose first $u<0$. For any $x$, it is clear that $(u,x)$ is outside $\\cl\\dom\\tilde f$ and, in view of (1.2.8), $\\cl\\tilde f(u,x)=+\\infty$.\n\nNow let $u\\ge 0$. Using (2.2.1), the assumption on $x'$ and the results of \\S A.2.1, we see that $(1,x')\\in\\ri\\dom\\tilde f$, so Proposition 1.2.5 allows us to write\n\\[\n(\\cl\\tilde f)(u,x)=\\lim_{\\alpha\\downarrow0}\\tilde f\\bigl((u,x)+\\alpha[(1,x')-(u,x)]\\bigr)\n\\]\n\\[\n\\qquad=\\lim_{\\alpha\\downarrow0}[u+\\alpha(1-u)]\\,f\\!\\Bigl(\\frac{x+\\alpha(x'-x)}{u+\\alpha(1-u)}\\Bigr).\n\\]\n\nIf $u=1$, this reads $\\cl\\tilde f(1,x)=\\cl f(x)=f(x)$ (because $f$ is closed); if $u=0$, we just obtain our claimed relation."
    },
    {
        "statement": "Let the functions $f_1$ and $f_2$ be in $\\operatorname{Conv}\\mathbb{R}^n$. Suppose that they have a common affine minorant: for some $(s,b)\\in\\mathbb{R}^n\\times\\mathbb{R}$,\n\\[\nf_j(x)\\ge\\langle s,x\\rangle - b\\qquad\\text{for }j=1,2\\text{ and all }x\\in\\mathbb{R}^n.\n\\]\nThen their infimal convolution is also in $\\operatorname{Conv}\\mathbb{R}^n$.",
        "title": "",
        "label": "prop:FCA-chapB-2.3.3",
        "lean_tag": [
            "FCA_chap_B_2_3_3"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_3_3 {m n : ‚Ñï}\n  (f‚ÇÅ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (f‚ÇÇ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hf_convex : InConvRn f‚ÇÅ ‚àß InConvRn f‚ÇÇ)\n  (h_common_affine_minorant : ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)) (b : ‚Ñù),\n                              (‚àÄ x, f‚ÇÅ x ‚â• (inner ‚Ñù s x) - b) ‚àß (‚àÄ x, f‚ÇÇ x ‚â• (inner ‚Ñù s x) - b))\n  : InProperConvRn (infimalConv f‚ÇÅ f‚ÇÇ)\n  := by sorry",
        "proof": "For arbitrary $x\\in\\mathbb{R}^n$ and $x_1,x_2$ such that $x_1+x_2=x$, we have by assumption\n\\[\nf_1(x_1)+f_2(x_2)\\ge\\langle s,x\\rangle -2b>- \\infty,\n\\]\nand this inequality extends to the infimal value $(f_1\\infconv f_2)(x)$.\n\nOn the other hand, it suffices to choose particular values $x_j\\in\\dom f_j$, $j=1,2$, to obtain the point $x_1+x_2\\in\\dom(f_1\\infconv f_2)$. Finally, the convexity of $f_1\\infconv f_2$ results from the convexity of a lower-bound function, as seen in \\S 1.3(g)."
    },
    {
        "statement": "Let $g$ of Definition 2.4.1 be in $\\mathrm{Conv}\\,\\mathbb{R}^m$.  Assume also that, for all $x\\in\\mathbb{R}^n$, $g$ is bounded below on the inverse image $A^{-1}(x)=\\{y\\in\\mathbb{R}^m:Ay=x\\}$.  Then $Ag\\in\\mathrm{Conv}\\,\\mathbb{R}^n$.",
        "title": "",
        "label": "thm:FCA-chapB-2.4.2",
        "lean_tag": [
            "FCA_chap_B_2_4_2"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_4_2 {m n : ‚Ñï}\n  (A : (EuclideanSpace ‚Ñù (Fin m)) ‚Üí‚Çó[‚Ñù] (EuclideanSpace ‚Ñù (Fin n)))\n  (g : EuclideanSpace ‚Ñù (Fin m) ‚Üí WithBot (WithTop ‚Ñù))\n  (hg_convex : InProperConvRn g) (hg_bounded : ‚àÄ x, sInf (Set.image g {y | A y = x}) > ‚ä•)\n  : InProperConvRn (imageFun A g)\n  := by sorry",
        "proof": "By assumption, $Ag$ is nowhere $-\\infty$; also, $(Ag)(x)<+\\infty$ whenever $x=Ay$, with $y\\in\\dom g$.  Now consider the extended operator\n\\[\nA':\\mathbb{R}^m\\times\\mathbb{R}\\rightrightarrows(y,r)\\mapsto A'(y,r):=(Ay,r)\\in\\mathbb{R}^n\\times\\mathbb{R}.\n\\]\nThe set $A'(\\epi g)=:C$ is convex in $\\mathbb{R}^n\\times\\mathbb{R}$; let us compute its lower-bound function (1.3.5): for given $x\\in\\mathbb{R}^n$,\n\\[\n\\inf_{r}\\{r : (x,r)\\in C\\} = \\inf_{y,r}\\{r : Ay = x \\ \\text{and}\\ g(y)\\le r\\}\n= \\inf_{y}\\{g(y) : Ay = x\\} = (Ag)(x),\n\\]\nand this proves the convexity of $Ag=\\ell_C$."
    },
    {
        "statement": "Let (2.4.1) have the following form: $U=\\mathbb{R}^p$; $\\varphi\\in\\Conv\\mathbb{R}^p$; \n$X=\\mathbb{R}^n$ is equipped with the canonical basis; the mapping $c$ has its components \n$c_j\\in\\Conv\\mathbb{R}^p$ for $j=1,\\dots,n$. Suppose also that the optimal value is $>-\\infty$ for \nall $x\\in\\mathbb{R}^n$, and that\n\\[\n\\dom\\varphi\\cap\\dom c_1\\cap\\cdots\\cap\\dom c_n\\neq\\varnothing.\n\\tag{2.4.4}\n\\]\nThen the value function\n\\[\nv_{\\varphi,c}(x):=\\inf\\{\\varphi(u):c_j(u)\\le x_j,\\ \\text{for }j=1,\\dots,n\\}\n\\]\nlies in $\\Conv\\mathbb{R}^n$.",
        "title": "",
        "label": "thm:FCA-chapB-2.4.3",
        "lean_tag": [
            "FCA_chap_B_2_4_3"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_4_3 {p n : ‚Ñï}\n  (phi : EuclideanSpace ‚Ñù (Fin p) ‚Üí WithBot (WithTop ‚Ñù))\n  (c : (Fin n) ‚Üí (EuclideanSpace ‚Ñù (Fin p) ‚Üí WithBot (WithTop ‚Ñù)))\n  (h_phi_convex : InProperConvRn phi) (hc_convex : ‚àÄ j, InProperConvRn (c j))\n  (h_nonempty_dom : Set.Nonempty (effDom phi ‚à© (‚ãÇ j, effDom (c j))))\n  (h_noninf_val : ‚àÄ x, (valueFun phi c x) > ‚ä•)\n  : InProperConvRn (valueFun phi c)\n  := by sorry",
        "proof": "Note first that we have assumed $v_{\\varphi,c}(x)>-\\infty$ for all $x$. Take $u_0$ in the set (2.4.4) and set $M:=\\max_j c_j(u_0)$; then take $x_0:=(M,\\dots,M)\\in\\mathbb{R}^n$, so that $v_{\\varphi,c}(x_0)\\le\\varphi(u_0)<+\\infty$. Knowing that $v_{\\varphi,c}$ is an image-function, we just have to prove the convexity of the set (2.4.3); but this in turn comes immediately from the convexity of each $c_j$."
    },
    {
        "statement": "With the above notation, suppose that $g$ is bounded below on the set $\\{x\\}\\times\\mathbb{R}^m$, for all $x\\in\\mathbb{R}^n$. Then the marginal function $\\gamma$ lies in $\\operatorname{Conv}\\mathbb{R}^n$.",
        "title": "",
        "label": "cor:FCA-chapB-2.4.5",
        "lean_tag": [
            "FCA_chap_B_2_4_5"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_4_5 {n m : ‚Ñï}\n  (g : EuclideanSpace ‚Ñù (Fin (n + m)) ‚Üí WithBot (WithTop ‚Ñù))\n  (hg_convex : InProperConvRn g)\n  (hg_bounded : ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)), sInf (Set.image g {z : EuclideanSpace ‚Ñù (Fin (n + m)) | ‚àÉ (y : EuclideanSpace ‚Ñù (Fin m)), z = Fin.append x y}) > ‚ä•)\n  : InProperConvRn (marginalFun g)\n  := by sorry",
        "proof": "The marginal function $\\gamma$ is the image of $g$ under the the linear operator $A$ projecting each $(x,y)\\in\\mathbb{R}^n\\times\\mathbb{R}^m$ onto $x\\in\\mathbb{R}^n$: $A(x,y)=x$. \\qquad \\qedhere"
    },
    {
        "statement": "Let $g:\\mathbb{R}^n\\to\\mathbb{R}\\cup\\{+\\infty\\}$, not identically $+\\infty$, be minorized by some affine function: for some $(s,b)\\in\\mathbb{R}^n\\times\\mathbb{R}$,\n\\[\ng(x)\\ge\\langle s,x\\rangle - b\\quad\\text{for all }x\\in\\mathbb{R}^n .\n\\tag{2.5.1}\n\\]\nThen, the following three functions \\(f_1, f_2\\) and \\(f_3\\) are convex and coincide on \\(\\mathbb{R}^n\\):\n\\[\n\\begin{aligned}\nf_1(x) &:= \\inf\\{r : (x,r)\\in\\operatorname{co}\\,\\operatorname{epi} g\\},\\\\\nf_2(x) &:= \\sup\\{h(x): h\\in\\operatorname{Conv}\\mathbb{R}^n,\\ h\\le g\\},\\\\\nf_3(x) &:= \\inf\\Big\\{\\sum_{j=1}^k \\alpha_j g(x_j): k=1,2,\\dots\\\\\n&\\qquad\\qquad\\qquad \\alpha\\in\\Delta_k,\\ x_j\\in\\operatorname{dom} g,\\ \\sum_{j=1}^k \\alpha_j x_j = x\\Big\\}.\n\\end{aligned}\n\\tag{2.5.2}\n\\]",
        "title": "",
        "label": "prop:FCA-chapB-2.5.1",
        "lean_tag": [
            "FCA_chap_B_2_5_1"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_5_1 {n : ‚Ñï}\n  (g : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hg_minorized : ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)) (b : ‚Ñù), ‚àÄ x, g x ‚â• inner ‚Ñù s x - b)\n  : let f‚ÇÅ := fun x => sInf {r : WithTop ‚Ñù | ‚àÉ z ‚àà convexHull ‚Ñù (epigraph (liftWithToptoEReal g)), z.1 = x ‚àß z.2 = r}\n    let f‚ÇÇ := fun x => sSup {z : WithTop ‚Ñù | ‚àÉ (h : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù),\n                                               (InConvRn h) ‚àß (Minorizes h g) ‚àß (z = h x)}\n    let f‚ÇÉ := fun x => sInf (‚ãÉ k, {z | ‚àÉ (Œ± : EuclideanSpace ‚Ñù (Fin k))\n                                          (x‚ÇÄ : (Fin k) ‚Üí EuclideanSpace ‚Ñù (Fin n)),\n                                          (Œ± ‚àà ŒîŒ∫ k) ‚àß (‚àÄ j, x‚ÇÄ j ‚àà effDom (liftWithToptoEReal g)) ‚àß\n                                          (x = ‚àë j, (Œ± j) ‚Ä¢ (x‚ÇÄ j)) ‚àß\n                                          (z = ‚àë j, (Œ± j) ‚Ä¢ g (x‚ÇÄ j))})\n    (InConvRn f‚ÇÅ) ‚àß (InConvRn f‚ÇÇ) ‚àß (InConvRn f‚ÇÉ) ‚àß\n    (‚àÄ x, (f‚ÇÅ x = f‚ÇÇ x) ‚àß (f‚ÇÇ x = f‚ÇÉ x))\n  := by sorry",
        "proof": "We denote by \\(\\Gamma\\) the family of convex functions minorizing \\(g\\). By assumption, \\(\\Gamma\\neq\\varnothing\\); then the convexity of \\(f_1\\) results from \\S1.3(g).\n\n[\\(f_2\\le f_1\\)] Consider the epigraph of any \\(h\\in\\Gamma\\): its lower-bound function \\(\\ell_{\\mathrm{epi}\\,h}\\) is \\(h\\) itself; besides, it contains \\(\\mathrm{epi}\\,g\\), and \\(\\operatorname{co}(\\mathrm{epi}\\,g)\\) as well (see Proposition A.1.3.4). In a word, there holds \\(h=\\ell_{\\mathrm{epi}\\,h}\\le \\ell_{\\operatorname{co}\\,\\mathrm{epi}\\,g}=f_1\\) and we conclude \\(f_2\\le f_1\\) since \\(h\\) was arbitrary in \\(\\Gamma\\).\n\n[\\(f_3\\le f_2\\)] We have to prove \\(f_3\\in\\Gamma\\), and the result will follow by definition of \\(f_2\\); clearly \\(f_3\\le g\\) (take \\(\\alpha\\in\\Delta_1\\)!), so it suffices to establish \\(f_3\\le\\operatorname{Conv}\\mathbb{R}^n\\). First, with \\((s,b)\\) of (2.5.1) and all \\(x,\\ \\{x_j\\}\\) and \\(\\{\\alpha_j\\}\\) as described by (2.5.2),\n\\[\n\\sum_{j=1}^k \\alpha_j g(x_j) \\ge \\sum_{j=1}^k \\alpha_j(\\langle s,x_j\\rangle - b) = \\langle s,x\\rangle - b;\n\\]\nhence \\(f_3\\) is minorized by the affine function \\(\\langle s,\\cdot\\rangle - b\\). Now, take two points \\((x,r)\\) and \\((x',r')\\) in the strict epigraph of \\(f_3\\). By definition of \\(f_3\\), there are \\(k,\\ \\{\\alpha_j\\},\\ \\{x_j\\}\\) as described in (2.5.2), and likewise \\(k',\\ \\{\\alpha'_j\\},\\ \\{x'_j\\}\\), such that \\(\\sum_{j=1}^k \\alpha_j g(x_j)<r\\) and likewise \\(\\sum_{j=1}^{k'} \\alpha'_j g(x'_j)<r'\\).\n\nFor arbitrary \\(t\\in]0,1[\\), we obtain by convex combination\n\\[\n\\sum_{j=1}^k t\\alpha_j g(x_j) + \\sum_{j=1}^{k'} (1-t)\\alpha'_j g(x'_j) < tr + (1-t)r'.\n\\]\n\nObserve that\n\\[\n\\sum_{j=1}^k t\\alpha_j x_j + \\sum_{j=1}^{k'} (1-t)\\alpha'_j x'_j = tx + (1-t)x',\n\\]\ni.e. we have in the lefthand side a convex decomposition of \\(tx+(1-t)x'\\) in \\(k+k'\\) elements; therefore, by definition of \\(f_3\\):\n\\[\nf_3(tx+(1-t)x') \\le \\sum_{j=1}^k t\\alpha_j g(x_j) + \\sum_{j=1}^{k'} (1-t)\\alpha'_j g(x'_j)\n\\]\nand we have proved that \\(\\mathrm{epi}_s f_3\\) is a convex set: \\(f_3\\) is convex.\n\nLet \\(x\\in\\mathbb{R}^n\\) and take an arbitrary convex decomposition \\(x=\\sum_{j=1}^k \\alpha_j x_j\\),\nwith \\(\\alpha_j\\) and \\(x_j\\) as described in (2.5.2). Since \\((x_j,g(x_j))\\in\\operatorname{epi} g\\) for \\(j=1,\\ldots,k\\),\n\\[\n\\biggl(x,\\sum_{j=1}^k \\alpha_j g(x_j)\\biggr)\\in\\operatorname{co}\\operatorname{epi} g\n\\]\nand this implies \\(f_1(x)\\le\\sum_{j=1}^k \\alpha_j g(x_j)\\) by definition of \\(f_1\\). Because the decomposition of \\(x\\) was arbitrary within (2.5.2), this implies \\(f_1(x)\\le f_3(x)\\)."
    },
    {
        "statement": "Let $g$ satisfy the hypotheses of Proposition 2.5.1. Then the three functions below\n\\[\n\\bar f_1(x):=\\inf\\{r:(x,r)\\in\\overline{\\operatorname{epi} g}\\},\n\\qquad\n\\bar f_2(x):=\\sup\\{h(x):\\ h\\in\\operatorname{Conv}\\mathbb{R}^n,\\ h\\le g\\},\n\\]\n\\[\n\\bar f_3(x):=\\sup\\{\\langle s,x\\rangle-b:\\ \\langle s,y\\rangle-b\\le g(y)\\text{ for all }y\\in\\mathbb{R}^n\\}\n\\]\nare closed, convex, and coincide on $\\mathbb{R}^n$ with the closure of the function constructed in Proposition 2.5.1.",
        "title": "",
        "label": "prop:FCA-chapB-2.5.2",
        "lean_tag": [
            "FCA_chap_B_2_5_2"
        ],
        "lean_formalization": "lemma FCA_chap_B_2_5_2 {n : ‚Ñï}\n  (g : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hg_minorized : ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)) (b : ‚Ñù), ‚àÄ x, g x ‚â• inner ‚Ñù s x - b)\n  : let f‚ÇÅ := fun x => sInf {r : WithTop ‚Ñù | ‚àÉ z ‚àà closure (convexHull ‚Ñù (epigraph (liftWithToptoEReal g))), z.1 = x ‚àß z.2 = r}\n    let f‚ÇÇ := fun x => sSup {z : WithTop ‚Ñù | ‚àÉ (h : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù),\n                                               (InClosedConvRn h) ‚àß (Minorizes h g) ‚àß (z = h x)}\n    let f‚ÇÉ := fun x => sSup {z : WithTop ‚Ñù | ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)) (b : ‚Ñù),\n                                               (‚àÄ y, inner ‚Ñù s y - b ‚â§ g y) ‚àß (z = inner ‚Ñù s x - b)}\n    (InClosedConvRn f‚ÇÅ) ‚àß (InClosedConvRn f‚ÇÇ) ‚àß (InClosedConvRn f‚ÇÉ) ‚àß\n    (‚àÄ x, (f‚ÇÅ x = f‚ÇÇ x) ‚àß (f‚ÇÇ x = f‚ÇÉ x))\n  := by sorry\n",
        "proof": ""
    },
    {
        "statement": "A function \\(\\sigma:\\mathbb R^n\\to\\mathbb R\\cup\\{+\\infty\\}\\) is sublinear if and only if its epigraph \\(\\operatorname{epi}\\sigma\\) is a nonempty convex cone in \\(\\mathbb R^n\\times\\mathbb R\\).",
        "title": "",
        "label": "prop:FCA-chapC-1.1.3",
        "lean_tag": [
            "FCA_chap_C_1_1_3"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_1_3 {n : ‚Ñï}\n  (œÉ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) :\n  let epi := epigraph (liftWithToptoEReal œÉ)\n  (IsSublinear (liftWithToptoEReal œÉ)) ‚Üî\n  (Set.Nonempty epi ‚àß Convex ‚Ñù epi ‚àß IsCone epi) := by\n  sorry",
        "proof": "We know that \\(\\sigma\\) is a convex function if and only if \\(\\operatorname{epi}\\sigma\\) is a nonempty convex set in \\(\\mathbb R^n\\times\\mathbb R\\) (Proposition B.1.1.6). Therefore, we just have to prove the equivalence between positive homogeneity and \\(\\operatorname{epi}\\sigma\\) being a cone.\n\nLet \\(\\sigma\\) be positively homogeneous. For \\((x,r)\\in\\operatorname{epi}\\sigma\\), the relation \\(\\sigma(x)\\le r\\) gives\n\\[\n\\sigma(tx)=t\\sigma(x)\\le tr\\qquad\\text{for all }t>0,\n\\]\nso \\(\\operatorname{epi}\\sigma\\) is a cone. Conversely, if \\(\\operatorname{epi}\\sigma\\) is a cone in \\(\\mathbb R^n\\times\\mathbb R\\), the property \\((x,\\sigma(x))\\in\\operatorname{epi}\\sigma\\) implies \\((tx,t\\sigma(x))\\in\\operatorname{epi}\\sigma\\), i.e.\n\\[\n\\sigma(tx)\\le t\\sigma(x)\\qquad\\text{for all }t>0.\n\\]\n\nFrom Remark 1.1.2, this is just positive homogeneity."
    },
    {
        "statement": "A function $\\sigma:\\mathbb{R}^n\\to\\mathbb{R}\\cup\\{+\\infty\\}$, not identically equal to $+\\infty$, is sublinear if and only if one of the following two properties holds:\n\\[\n\\sigma(t_1x_1+t_2x_2)\\le t_1\\sigma(x_1)+t_2\\sigma(x_2)\\qquad\\text{for all }x_1,x_2\\in\\mathbb{R}^n\\text{ and }t_1,t_2>0,\n\\tag{1.1.4}\n\\]\nor\n\\[\n\\sigma\\text{ is positively homogeneous and subadditive}.\n\\tag{1.1.5}\n\\]",
        "title": "",
        "label": "prop:FCA-chapC-1.1.4",
        "lean_tag": [
            "FCA_chap_C_1_1_4"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_1_4 {n : ‚Ñï}\n  (œÉ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hœÉ : ‚àÉ x, œÉ x ‚â† ‚ä§) :\n  (IsSublinear (liftWithToptoEReal œÉ)) ‚Üî\n  ((‚àÄ (x‚ÇÅ x‚ÇÇ : EuclideanSpace ‚Ñù (Fin n)), ‚àÄ (t‚ÇÅ t‚ÇÇ : ‚Ñù),\n   t‚ÇÅ > 0 ‚Üí t‚ÇÇ > 0 ‚Üí œÉ (t‚ÇÅ ‚Ä¢ x‚ÇÅ + t‚ÇÇ ‚Ä¢ x‚ÇÇ) ‚â§ t‚ÇÅ ‚Ä¢ (œÉ x‚ÇÅ) + t‚ÇÇ ‚Ä¢ (œÉ x‚ÇÇ)) ‚à®\n   ((IsKPosHomogeneous œÉ 1) ‚àß (IsSubadditive œÉ))) := by\n  sorry",
        "proof": "[sublinearity $\\implies$ (1.1.4)] For $x_1,x_2\\in\\mathbb{R}^n$ and $t_1,t_2>0$, set $t:=t_1+t_2>0$; we have\n\\[\n\\begin{aligned}\n\\sigma(t_1x_1+t_2x_2)&=\\sigma\\bigl(t\\bigl[\\tfrac{t_1}{t}x_1+\\tfrac{t_2}{t}x_2\\bigr]\\bigr)\\\\\n&=t\\sigma\\bigl(\\tfrac{t_1}{t}x_1+\\tfrac{t_2}{t}x_2\\bigr)\\qquad\\text{[positive homogeneity]}\\\\\n&\\le t\\bigl[\\tfrac{t_1}{t}\\sigma(x_1)+\\tfrac{t_2}{t}\\sigma(x_2)\\bigr]\\qquad\\text{[convexity]},\n\\end{aligned}\n\\]\nand (1.1.4) is proved.\n\n[(1.1.4) $\\implies$ (1.1.5)] A function satisfying (1.1.4) is obviously subadditive (take $t_1=t_2=1$) and satisfies (take $x_1=x_2=x$, $t_1=t_2=1/2t$)\n\\[\n\\sigma(tx)=t\\sigma(x),\n\\]\ni.e. it is positively homogeneous.\n\n[(1.1.5)$\\Rightarrow\\text{sublinearity}$] Take $t_1,t_2>0$ with $t_1+t_2=1$ and apply successively subadditivity and positive homogeneity:\n\\[\n\\sigma(t_1x_1+t_2x_2)\\le\\sigma(t_1x_1)+\\sigma(t_2x_2)=t_1\\sigma(x_1)+t_2\\sigma(x_2),\n\\]\nhence $\\sigma$ is convex."
    },
    {
        "statement": "If $\\sigma$ is sublinear, then\n\\[\n\\sigma(x)+\\sigma(-x)\\ge 0\\quad\\text{for all }x\\in\\mathbb{R}^n.\n\\tag{1.1.6}\n\\]",
        "title": "",
        "label": "cor:FCA-chapC-1.1.5",
        "lean_tag": [
            "FCA_chap_C_1_1_5"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_1_5 {n : ‚Ñï}\n  (œÉ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) :\n  (IsSublinear (liftWithToptoEReal œÉ)) ‚Üí\n  (‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)), œÉ x + œÉ (-x) ‚â• 0) := by\n  sorry",
        "proof": "Take $x_2=-x_1$ in (1.1.3) and remember that $\\sigma(0)\\ge 0$."
    },
    {
        "statement": "Let $\\sigma$ be sublinear and suppose that there exist $x_1,\\dots,x_m$ in $\\dom\\sigma$ such that\n\\[\n\\sigma(x_j)+\\sigma(-x_j)=0\\quad\\text{for } j=1,\\dots,m.\n\\tag{1.1.7}\n\\]\nThen $\\sigma$ is linear on the subspace spanned by $x_1,\\dots,x_m$.",
        "title": "",
        "label": "thm:FCA-chapC-1.1.6",
        "lean_tag": [
            "FCA_chap_C_1_1_6"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_1_6 {m n : ‚Ñï}\n  (œÉ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (x : ‚Ñï ‚Üí EuclideanSpace ‚Ñù (Fin n))\n  (hœÉ : IsSublinear (liftWithToptoEReal œÉ))\n  (h_eq_0 : ‚àÄ j ‚àà Finset.range m, œÉ (x j) + œÉ (-1 ‚Ä¢ (x j)) = 0) :\n  let ùìß := {v | InSubspaceSpanVec m x v}\n  (IsLinearOn ùìß œÉ):= by\n  sorry",
        "proof": "With $x_1,\\dots,x_m$ as stated, each $-x_j$ is in $\\dom\\sigma$. Let $x:=\\sum_{j=1}^m t_j x_j$ be an arbitrary linear combination of $x_1,\\dots,x_m$; we must prove that $\\sigma(x)=\\sum_{j=1}^m t_j\\sigma(x_j)$. Set\n\\[\nJ_1 := \\{j : t_j > 0\\},\\qquad J_2 := \\{j : t_j < 0\\},\n\\]\nand obtain (as usual, $\\sum_\\emptyset=0$):\n\n\\begin{align}\n\\sigma(x)\n&=\\sigma\\!\\biggl(\\sum_{j\\in J_1} t_j x_j + \\sum_{j\\in J_2}(-t_j)(-x_j)\\biggr)\\\\\n&\\le \\sum_{j\\in J_1} t_j\\sigma(x_j)+\\sum_{j\\in J_2}(-t_j)\\sigma(-x_j) \\tag*{[from (1.1.4)]}\\\\\n&= \\sum_{j\\in J_1} t_j\\sigma(x_j)+\\sum_{j\\in J_2} t_j\\sigma(x_j)=\\sum_{j=1}^m t_j\\sigma(x_j) \\tag*{[from (1.1.7)]}\\\\\n&= -\\sum_{j\\in J_1} t_j\\sigma(-x_j)-\\sum_{j\\in J_2}(-t_j)\\sigma(x_j) \\tag*{[from (1.1.7)]}\\\\\n&\\le -\\sigma\\!\\bigl(-\\sum_{j=1}^m t_j x_j\\bigr)\\tag*{[from (1.1.4)]}\\\\\n&= -\\sigma(-x)\\le \\sigma(x). \\tag*{[from (1.1.6)]}\n\\end{align}\n\n\nIn summary, we have proved \\(\\sigma(x)\\le \\sum_{j=1}^m t_j\\sigma(x_j)\\le -\\sigma(-x)\\le\\sigma(x).\\) \\qedhere"
    },
    {
        "statement": "Let $\\sigma$ be sublinear. If $x\\in U$, i.e.\\ if\n\\[\n\\sigma(x)+\\sigma(-x)=0,\n\\]\nthen there holds\n\\[\n\\sigma(x+y)=\\sigma(x)+\\sigma(y)\\qquad\\text{for all }y\\in\\mathbb{R}^n.\n\\]",
        "title": "",
        "label": "prop:FCA-chapC-1.1.7",
        "lean_tag": [
            "FCA_chap_C_1_1_7"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_1_7 {m n : ‚Ñï}\n  (œÉ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hœÉ : IsSublinear (liftWithToptoEReal œÉ)) :\n  (œÉ x + œÉ (-1 ‚Ä¢ x) = 0) ‚Üí\n  ‚àÄ (y : EuclideanSpace ‚Ñù (Fin n)), œÉ (x + y) = œÉ x + œÉ y := by\n  sorry",
        "proof": "In view of subadditivity, we just have to prove ``$\\ge$'' in (1.1.10). Start from the identity $y=x+y-x$; apply successively subadditivity and (1.1.9) to obtain\n\\[\n\\sigma(y)\\le\\sigma(x+y)+\\sigma(-x)=\\sigma(x+y)-\\sigma(x).\n\\]"
    },
    {
        "statement": "Let $C$ be a closed convex set containing the origin. Then\n\\begin{enumerate}\n\\item[(i)] its gauge $\\gamma_C$ is a nonnegative closed sublinear function;\n\\item[(ii)] $\\gamma_C$ is finite everywhere if and only if $0$ lies in the interior of $C$;\n\\item[(iii)] $C_\\infty$ being the asymptotic cone of $C$,\n\\[\n\\{x\\in\\mathbb{R}^n:\\ \\gamma_C(x)\\le r\\}=rC\\quad\\text{for all }r>0,\n\\qquad\n\\{x\\in\\mathbb{R}^n:\\ \\gamma_C(x)=0\\}=C_\\infty.\n\\]\n\\end{enumerate}",
        "title": "",
        "label": "thm:FCA-chapC-1.2.5",
        "lean_tag": [
            "FCA_chap_C_1_2_5"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_2_5 {m n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC_closed : IsClosed C) (hC_convex : Convex ‚Ñù C) (hC_origin : 0 ‚àà C) :\n  let g : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù := fun x => gauge C x\n  ((‚àÄ x, g x ‚â• 0) ‚àß (IsSublinear (liftWithToptoEReal g)) ‚àß (IsClosedFun g)) ‚àß\n  ((‚àÄ x, g x ‚â† ‚ä§) ‚Üî (0 ‚àà interior C)) := by\n  sorry",
        "proof": "[(i) and (iii)] Nonnegativity and positive homogeneity are obvious from the definition of $\\gamma_C$; also, $\\gamma_C(0)=0$ because $0\\in C$. We prove convexity via a geometric interpretation of (1.2.2). Let\n\\[\nK_C:=\\operatorname{cone}(C\\times\\{1\\})=\\{(\\lambda c,\\lambda)\\in\\mathbb{R}^n\\times\\mathbb{R}:\\ c\\in C,\\ \\lambda\\ge 0\\}\n\\]\nbe the convex conical hull of $C\\times\\{1\\}\\subset\\mathbb{R}^n\\times\\mathbb{R}$. It is convex (beware that $K_C$ need not be closed) and $\\gamma_C$ is clearly given by\n\\[\n\\gamma_C(x)=\\inf\\{\\lambda:\\ (x,\\lambda)\\in K_C\\}.\n\\]\nThus, $\\gamma_C$ is the lower-bound function of \\S B.1.3(g), constructed on the convex set $K_C$; this establishes the convexity of $\\gamma_C$, hence its sublinearity.\n\nNow we prove\n\\begin{equation}\\label{eq:1.2.3}\n\\{x\\in\\mathbb{R}^n:\\ \\gamma_C(x)\\le 1\\}=C.\n\\end{equation}\nThis will imply the first part in (iii), thanks to positive homogeneity. Then the second part will follow because of (A.2.2.2): $C_\\infty=\\cap\\{rC:\\ r>0\\}$ and closedness of $\\gamma_C$ will also result from (iii) via Proposition B.1.2.2.\n\nSo, to prove (1.2.3), observe first that $x\\in C$ implies from (1.2.2) that certainly $\\gamma_C(x)\\le 1$. Conversely, let $x$ be such that $\\gamma_C(x)\\le 1$; we must prove that $x\\in C$. For this we prove that $x_k:= (1-1/k)x\\in C$ for $k=1,2,\\dots$ (and then, the desired property will come from the closedness of $C$). By positive homogeneity, $\\gamma_C(x_k)=(1-1/k)\\gamma_C(x)\\le 1$, so there is $\\lambda_k\\in[0,1]$ such that $x_k=\\lambda_k C$, or equivalently $x_k/\\lambda_k\\in C$. Because $C$ is convex and contains the origin, $\\lambda_k (x_k/\\lambda_k)+(1-\\lambda_k)0 = x_k$ is in $C$, which is what we want.\n\n[(ii)] Assume $0\\in\\operatorname{int}C$. There is $\\varepsilon>0$ such that for all $x\\neq 0$, $x_\\varepsilon := x/\\|x\\|\\in C$; hence $\\gamma_C(x_\\varepsilon)\\le 1$ because of (1.2.3). We deduce by positive homogeneity\n\\[\n\\gamma_C(x)=\\frac{\\|x\\|}{\\varepsilon}\\,\\gamma_C(x_\\varepsilon)\\le\\frac{\\|x\\|}{\\varepsilon}\\,;\n\\]\nthis inequality actually holds for all $x\\in\\mathbb{R}^n$ ($\\gamma_C(0)=0$) and $\\gamma_C$ is a finite function.\n\nConversely, suppose $\\gamma_C$ is finite everywhere. By continuity (Theorem B.3.1.2), $\\gamma_C$ has an upper bound $L>0$ on the unit ball:\n\\[\n\\|x\\|\\le 1 \\quad\\Longrightarrow\\quad \\gamma_C(x)\\le L \\quad\\Longrightarrow\\quad x\\in L C,\n\\]\nwhere the last implication comes from (iii). In other words, $B(0,1/L)\\subset C$."
    },
    {
        "statement": "C is compact if and only if $\\gamma_C(x)>0$ for all $x\\neq 0$.",
        "title": "",
        "label": "cor:FCA-chapC-1.2.6",
        "lean_tag": [
            "FCA_chap_C_1_2_6"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_2_6 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC_closed : IsClosed C) (hC_convex : Convex ‚Ñù C) (hC_origin : 0 ‚àà C) :\n  let g : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù := fun x => gauge C x\n  (IsCompact C) ‚Üî (‚àÄ x, x ‚â† 0 ‚Üí g x > 0) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "\\begin{enumerate}\n    \\item[(i)] If $\\sigma_1$ and $\\sigma_2$ are [closed] sublinear and $t_1,t_2$ are positive numbers, then $\\sigma := t_1\\sigma_1 + t_2\\sigma_2$ is [closed] sublinear, if not identically $+\\infty$.\n    \\item[(ii)] If $\\{\\sigma_j\\}_{j\\in J}$ is a family of [closed] sublinear functions, then $\\sigma := \\sup_{j\\in J}\\sigma_j$ is [closed] sublinear, if not identically $+\\infty$.\n\\end{enumerate}",
        "title": "",
        "label": "prop:FCA-chapC-1.3.1",
        "lean_tag": [
            "FCA_chap_C_1_3_1_i",
            "FCA_chap_C_1_3_1_ii"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_3_1_i {n : ‚Ñï}\n  (œÉ‚ÇÅ œÉ‚ÇÇ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (t‚ÇÅ t‚ÇÇ : ‚Ñù)\n  (hœÉ : IsSublinear (liftWithToptoEReal œÉ‚ÇÅ) ‚àß IsSublinear (liftWithToptoEReal œÉ‚ÇÇ))\n  (ht : t‚ÇÅ > 0 ‚àß t‚ÇÇ > 0) :\n  let œÉ := t‚ÇÅ ‚Ä¢ œÉ‚ÇÅ + t‚ÇÇ ‚Ä¢ œÉ‚ÇÇ\n  (IsSublinear (liftWithToptoEReal œÉ)) ‚àß\n  (IsClosedFun œÉ‚ÇÅ ‚àß IsClosedFun œÉ‚ÇÇ ‚Üí (IsSublinear (liftWithToptoEReal œÉ)) ‚àß (IsClosedFun œÉ)):= by\n  sorry",
        "proof": "Concerning convexity and closedness, everything is known from \\S B.2. Note in passing that a closed sublinear function is zero (hence finite) at zero. As for positive homogeneity, it is straightforward."
    },
    {
        "statement": "Let $\\{\\sigma_j\\}_{j\\in J}$ be a family of sublinear functions all minorized by some linear function. Then\n\\begin{enumerate}\n    \\item[(i)] $\\sigma := \\operatorname{co}\\big(\\inf_{j\\in J}\\sigma_j\\big)$ is sublinear.\n    \\item[(ii)] If $J=\\{1,\\dots,m\\}$ is a finite set, we obtain the infimal convolution\n    \\[\n    \\operatorname{co}\\min\\{\\sigma_1,\\dots,\\sigma_m\\}=\\sigma_1\\infconv\\cdots\\infconv\\sigma_m.\n    \\]\n\\end{enumerate}",
        "title": "",
        "label": "prop:FCA-chapC-1.3.2",
        "lean_tag": [
            "FCA_chap_C_1_3_2_i",
            "FCA_chap_C_1_3_2_ii"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_3_2_i {n : ‚Ñï}\n  (œÉ : ‚Ñï ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù))\n  (J : Set ‚Ñï)\n  (hœÉ_sublinear : ‚àÄ j ‚àà J, IsSublinear (liftWithToptoEReal (œÉ j)))\n  (hœÉ_minorized : ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)), ‚àÉ (b : ‚Ñù),\n                  ‚àÄ j ‚àà J, ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)),\n                  (œÉ j) x ‚â• (inner ‚Ñù s x) + b) :\n  let œÉ_inf := fun x => sInf (‚ãÉ j ‚àà J, {(œÉ j) x})\n  let œÉ' := lscHull œÉ_inf\n  IsSublinear (liftWithToptoEReal œÉ') := by\n  sorry",
        "proof": "[(i)] Once again, the only thing to prove for (i) is positive homogeneity. Actually, it suffices to multiply $x$ and each $x_j$ by $t>0$ in a formula giving $\\operatorname{co}\\big(\\inf_j\\sigma_j\\big)(x)$, say (B.2.5.3).\n\n[(ii)] By definition, computing $\\operatorname{co}\\big(\\min_j\\sigma_j\\big)(x)$ amounts to solving the minimization problem in the $m$ couples of variables $(x_j,\\alpha_j)\\in\\operatorname{dom}\\sigma_j\\times\\mathbb{R}$\n\\[\n\\begin{aligned}\n&\\inf\\sum_{j=1}^m\\alpha_j\\sigma_j(x_j)\\qquad \\alpha_j\\ge 0\\\\\n&\\sum_{j=1}^m\\alpha_j=1,\\ \\sum_{j=1}^m\\alpha_j x_j=x.\n\\end{aligned}\n\\tag{1.3.1}\n\\]\n\nIn view of positive homogeneity, the variables $\\alpha_j$ play no role by themselves: the relevant variables are actually the products $\\alpha_j x_j$ and (1.3.1) can be written -- denoting $\\alpha_j x_j$ again by $x_j$:\n\\[\n\\operatorname{co}\\big(\\min_j\\sigma_j\\big)(x)=\\inf\\Big\\{\\sum_{j=1}^m\\sigma_j(x_j):\\sum_{j=1}^m x_j=x\\Big\\}.\n\\]\n\nWe recognize the infimal convolution of the $\\sigma_j$'s."
    },
    {
        "statement": "Let $(\\sigma_k)$ be a sequence of finite sublinear functions and let $\\sigma$ be a finite function.  Then the following are equivalent when $k\\to+\\infty$:\n\\begin{enumerate}\n\\item[(i)] $(\\sigma_k)$ converges pointwise to $\\sigma$;\n\\item[(ii)] $(\\sigma_k)$ converges to $\\sigma$ uniformly on each compact set of $\\mathbb{R}^n$;\n\\item[(iii)] $\\Delta(\\sigma_k,\\sigma)\\to 0$.\n\\end{enumerate}",
        "title": "",
        "label": "thm:FCA-chapC-1.3.5",
        "lean_tag": [
            "FCA_chap_C_1_3_5"
        ],
        "lean_formalization": "lemma FCA_chap_C_1_3_5 {n : ‚Ñï}\n  (œÉk : ‚Ñï ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù))\n  (œÉ : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù) :\n  let d := fun k => DistOnFunctions (œÉk k) œÉ\n  List.TFAE [\n    (‚àÄ x, Filter.Tendsto (fun k => (œÉk k) x) Filter.atTop (ùìù (œÉ x))),\n    (‚àÄ (K : Set (EuclideanSpace ‚Ñù (Fin n))), IsCompact K ‚Üí TendstoUniformlyOn œÉk œÉ Filter.atTop K),\n    (Filter.Tendsto d Filter.atTop (ùìù 0))\n  ] := by\n  sorry",
        "proof": "First, the (finite) function $\\sigma$ is of course sublinear whenever it is the pointwise limit of sublinear functions.  The equivalence between (i) and (ii) comes from the general Theorem B.3.1.4 on the convergence of convex functions.\n\nNow, (ii) clearly implies (iii).  Conversely $\\Delta(\\sigma_k,\\sigma)\\to 0$ is the uniform convergence on the unit ball, hence on any ball of radius $L>0$ (the maxmind in (1.3.2) is positively homogeneous), hence on any compact set."
    },
    {
        "statement": "A support function is closed and sublinear.",
        "title": "",
        "label": "prop:FCA-chapC-2.1.2",
        "lean_tag": [
            "FCA_chap_C_2_1_2"
        ],
        "lean_formalization": "lemma FCA_chap_C_2_1_2 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hS : Set.Nonempty S) :\n  let support_fun := SupportFun S\n  (IsSublinear (liftWithToptoEReal support_fun)) ‚àß (IsClosedFun support_fun)\n  := by\n  sorry",
        "proof": "This results from Proposition 1.3.1(ii) (a linear form is closed and convex!). Observe in particular that a support function is null (hence $< +\\infty$) at the origin."
    },
    {
        "statement": "The support function of $S$ is finite everywhere if and only if $S$ is bounded.",
        "title": "",
        "label": "prop:FCA-chapC-2.1.3",
        "lean_tag": [
            "FCA_chap_C_2_1_3"
        ],
        "lean_formalization": "lemma FCA_chap_C_2_1_3 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hS : Set.Nonempty S) :\n  let support_fun := SupportFun S\n  (‚àÄ x, support_fun x ‚â† ‚ä§) ‚Üî\n  (Bornology.IsBounded S) := by\n  sorry",
        "proof": "Let $S$ be bounded, say $S\\subset B(0,L)$ for some $L>0$. Then\n\\[\n\\langle s,x\\rangle \\le \\|s\\|\\,\\|x\\| \\le L\\|x\\|\\qquad\\text{for all } s\\in S,\n\\]\nwhich implies $\\sigma_S(x)\\le L\\|x\\|$ for all $x\\in\\mathbb{R}^n$.\n\nConversely, finiteness of the convex $\\sigma_S$ implies its continuity on the whole space (Theorem B.3.1.2), hence its local boundedness: for some $L$,\n\\[\n\\langle s,x\\rangle \\le \\sigma_S(x)\\le L\\qquad\\text{for all }(s,x)\\in S\\times B(0,1).\n\\]\nIf $s\\neq 0$, we can take $x=s/\\|s\\|$ in the above relation, which implies \\(\\|s\\|\\le L\\)."
    },
    {
        "statement": "For \\(S\\subset\\mathbb{R}^n\\) nonempty, there holds \\(\\sigma_S=\\sigma_{\\operatorname{cl} S}=\\sigma_{\\operatorname{co} S}\\); whence\n\\[\n\\sigma_S=\\sigma_{\\overline{\\operatorname{co}}\\,S}.\n\\tag{2.2.1}\n\\]",
        "title": "",
        "label": "prop:FCA-chapC-2.2.1",
        "lean_tag": [
            "FCA_chap_C_2_2_2"
        ],
        "lean_formalization": "lemma FCA_chap_C_2_2_2 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (s : EuclideanSpace ‚Ñù (Fin n))\n  (hS : Set.Nonempty S) :\n  let sf_S := SupportFun S\n  (s ‚àà closure (convexHull ‚Ñù S)) ‚Üî\n  (‚àÄ (d : EuclideanSpace ‚Ñù (Fin n)), inner ‚Ñù s d ‚â§ sf_S d) := by\n  sorry",
        "proof": "The continuity [resp.\\ linearity, hence convexity] of the function \\(\\langle s,\\cdot\\rangle\\), which is maximized over \\(S\\), implies that \\(\\sigma_S=\\sigma_{\\operatorname{cl} S}\\) [resp.\\ \\(\\sigma_S=\\sigma_{\\operatorname{co} S}\\)]. Knowing that \\(\\overline{\\operatorname{co}}\\,S=\\operatorname{cl}\\,\\operatorname{co}\\,S\\) (Proposition A.1.4.2), (2.2.1) follows immediately."
    },
    {
        "statement": "For the nonempty $S\\subset\\mathbb{R}^n$ and its support function $\\sigma_S$, there holds\n\\[\ns\\in\\overline{\\operatorname{co}}S\\iff\\bigl[\\langle s,d\\rangle\\le\\sigma_S(d)\\quad\\text{for all }d\\in X\\bigr],\n\\tag{2.2.2}\n\\]\nwhere the set $X$ can be indifferently taken as: the whole of $\\mathbb{R}^n$, the unit ball $B(0,1)$ or its boundary the unit sphere $\\tilde{B}$, or $\\operatorname{dom}\\sigma_S$.",
        "title": "",
        "label": "thm:FCA-chapC-2.2.2",
        "lean_tag": [
            "FCA_chap_C_2_2_2"
        ],
        "lean_formalization": "lemma FCA_chap_C_2_2_2 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (s : EuclideanSpace ‚Ñù (Fin n))\n  (hS : Set.Nonempty S) :\n  let sf_S := SupportFun S\n  (s ‚àà closure (convexHull ‚Ñù S)) ‚Üî\n  (‚àÄ (d : EuclideanSpace ‚Ñù (Fin n)), inner ‚Ñù s d ‚â§ sf_S d) := by\n  sorry",
        "proof": "First, the equivalence between all the choices for $X$ is clear enough; in particular due to positive homogeneity. Because ``$\\Rightarrow$'' is Proposition 2.2.1, we have to prove ``$\\Leftarrow$'' only, with $X=\\mathbb{R}^n$ say.\n\nSo suppose that $s\\notin\\overline{\\operatorname{co}}S$. Then $\\{s\\}$ and $\\overline{\\operatorname{co}}S$ can be strictly separated (Theorem A.4.1.1): there exists $d_0\\in\\mathbb{R}^n$ such that\n\\[\n\\langle s,d_0\\rangle>\\sup\\{\\langle s',d_0\\rangle:s'\\in\\overline{\\operatorname{co}}S\\}=\\sigma_S(d_0),\n\\]\nwhere the last equality is (2.2.1). Our result is proved by contradiction."
    },
    {
        "statement": "Let $S$ be a nonempty closed convex set in $\\mathbb{R}^n$. Then\n\\begin{enumerate}\n\\item[(i)] $s\\in\\operatorname{aff}S$ if and only if\n\\[\n\\langle s,d\\rangle=\\sigma_S(d)\\quad\\text{for all }d\\text{ with }\\sigma_S(d)+\\sigma_S(-d)=0;\n\\tag{2.2.3}\n\\]\n\\item[(ii)] $s\\in\\operatorname{ri}S$ if and only if\n\\[\n\\langle s,d\\rangle<\\sigma_S(d)\\quad\\text{for all }d\\text{ with }\\sigma_S(d)+\\sigma_S(-d)>0;\n\\tag{2.2.4}\n\\]\n\\item[(iii)] in particular, $s\\in\\operatorname{int}S$ if and only if\n\\[\n\\langle s,d\\rangle<\\sigma_S(d)\\quad\\text{for all }d\\neq0.\n\\tag{2.2.5}\n\\]\n\\end{enumerate}",
        "title": "",
        "label": "thm:FCA-chapC-2.2.3",
        "lean_tag": [
            "FCA_chap_C_2_2_3"
        ],
        "lean_formalization": "lemma FCA_chap_C_2_2_3 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (s : EuclideanSpace ‚Ñù (Fin n))\n  (hS : Set.Nonempty S) :\n  let œÉS := SupportFun S\n  ((s ‚àà affineHull S) ‚Üî (‚àÄ d, œÉS d + œÉS (-1 ‚Ä¢ d) = 0 ‚Üí inner ‚Ñù s d = œÉS d)) ‚àß\n  ((s ‚àà intrinsicInterior ‚Ñù S) ‚Üî (‚àÄ d, œÉS d + œÉS (-1 ‚Ä¢ d) > 0 ‚Üí inner ‚Ñù s d < œÉS d)) ‚àß\n  ((s ‚àà interior S) ‚Üî (‚àÄ d, d ‚â† 0 ‚Üí inner ‚Ñù s d < œÉS d)):= by\n  sorry",
        "proof": "[(i)] Let first $s\\in S$. We have already seen in Definition 2.1.4 that\n\\[\n- \\sigma_S(-d) \\le \\langle s,d\\rangle \\le \\sigma_S(d)\\qquad\\text{for all } d\\in\\mathbb{R}^n.\n\\]\nIf the breadth of $S$ along $d$ is zero, we obtain a pair of equalities: for such $d$, there holds\n\\[\n\\langle s,d\\rangle = \\sigma_S(d),\n\\]\nan equality which extends by affine combination to any element \\(s\\in\\operatorname{aff}S\\).\n\nConversely, let \\(s\\) satisfy (2.2.3). A first case is when the only \\(d\\) described in (2.2.3) is \\(d = 0\\); as a consequence of our observations in Definition 2.1.4, there is no affine hyperplane containing \\(S\\), i.e.\\ \\(\\operatorname{aff}S = \\mathbb{R}^n\\) and there is nothing to prove. Otherwise, there does exist a hyperplane \\(H\\) containing \\(S\\); it is defined by\n\\[\nH := \\{p \\in \\mathbb{R}^n : \\langle p,d_H\\rangle = \\sigma_S(d_H)\\}, \\tag{2.2.6}\n\\]\nfor some \\(d_H \\neq 0\\). We proceed to prove \\(\\langle s,\\cdot\\rangle \\le \\sigma_H\\).\n\nIn fact, the breadth of \\(S\\) along \\(d_H\\) is certainly 0, hence \\(\\langle s,d_H\\rangle = \\sigma_S(d_H)\\) because of (2.2.3), while (2.2.6) shows that \\(\\sigma_S(d_H) = \\sigma_H(d_H)\\). On the other hand, it is obvious that \\(\\sigma_H(d) = +\\infty\\) if \\(d\\) is not collinear to \\(d_H\\). In summary, we have proved \\(\\langle s,d\\rangle \\le \\sigma_H(d)\\) for all \\(d\\), i.e.\\ \\(s \\in H\\). We conclude that our \\(s\\) is in any affine manifold containing \\(S\\): \\(s \\in \\operatorname{aff}S\\).\n\n[(iii)] In view of positive homogeneity, we can normalize \\(d\\) in (2.2.5). For \\(s \\in \\operatorname{int} S\\), there exists \\(\\varepsilon > 0\\) such that \\(s + \\varepsilon d \\in S\\) for all \\(d\\) in the unit sphere \\(\\widetilde{B}\\). Then, from the very definition (2.1.1),\n\\[\n\\sigma_S(d) \\ge \\langle s + \\varepsilon d,d\\rangle = \\langle s,d\\rangle + \\varepsilon \\quad\\text{for all } d \\in \\widetilde{B}.\n\\]\n\nConversely, let \\(s \\in \\mathbb{R}^n\\) be such that\n\\[\n\\sigma_S(d) - \\langle s,d\\rangle > 0 \\quad\\text{for all } d \\in \\widetilde{B},\n\\]\nwhich implies, because \\(\\sigma_S\\) is closed and the unit sphere is compact:\n\\[\n0 < \\varepsilon := \\inf\\{\\sigma_S(d) - \\langle s,d\\rangle : d \\in \\widetilde{B}\\} \\le +\\infty.\n\\]\nThus\n\\[\n\\langle s,d\\rangle + \\varepsilon \\le \\sigma_S(d)\\quad\\text{for all } d \\in \\widetilde{B}.\n\\]\n\nNow take \\(u\\) with \\(\\|u\\| < \\varepsilon\\). From the Cauchy-Schwarz inequality, we have for all \\(d \\in \\widetilde{B}\\)\n\\[\n\\langle s+u,d\\rangle = \\langle s,d\\rangle + \\langle u,d\\rangle \\le \\langle s,d\\rangle + \\varepsilon \\le \\sigma_S(d)\n\\]\nand this implies \\(s + u \\in S\\) because of Theorem 2.2.2: \\(s \\in \\operatorname{int} S\\) and (iii) is proved.\n\n[(ii)] Look at Fig. 2.2.2 again: decompose \\(\\mathbb{R}^n = V \\oplus U\\), where \\(V\\) is the subspace parallel to \\(\\operatorname{aff}S\\) and \\(U = V^\\perp\\). In the decomposition \\(d = d_V + d_U\\), \\(\\langle\\cdot,d_U\\rangle\\) is constant over \\(S\\), so \\(S\\) has 0-breadth along \\(d_U\\) and\n\\[\n\\sigma_S(d) = \\sup_{s\\in S}\\langle s,d_V + d_U\\rangle = \\langle s,d_U\\rangle + \\sup_{s\\in S}\\langle s,d_V\\rangle\n\\]\nfor any \\(s \\in S\\). With these notations, a direction described as in (2.2.4) is a \\(d\\) such that\n\\[\n\\sigma_S(d) + \\sigma_S(-d) = \\sigma_S(d_V) + \\sigma_S(-d_V) > 0.\n\\]\nThen, (ii) is just (iii) written in the subspace \\(V\\)."
    },
    {
        "statement": "Let $S$ be a nonempty closed convex set in $\\mathbb{R}^n$. Then $\\overline{\\operatorname{dom}\\sigma_S}$ and the asymptotic cone $S_\\infty$ of $S$ are mutually polar cones.",
        "title": "",
        "label": "prop:FCA-chapC-2.2.4",
        "lean_tag": [
            "FCA_chap_C_2_2_4"
        ],
        "lean_formalization": "lemma FCA_chap_C_2_2_4 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hS_nonempty : Set.Nonempty S)\n  (hS_closed : IsClosed S)\n  (hS_convex : Convex ‚Ñù S) :\n  let œÉS := SupportFun S\n  let Sinfty := AsymptoticCone S x\n  PolarCone (closure (effDom (liftWithToptoEReal œÉS))) = Sinfty := by\n  sorry",
        "proof": "Recall from \\S A.3.2 that, if $K_1$ and $K_2$ are two closed convex cones, then $K_1\\subset K_2$ if and only if $(K_1)^\\circ \\supset (K_2)^\\circ$.\n\nLet $p\\in S_\\infty$. Fix $s_0$ arbitrary in $S$ and use the fact that $S_\\infty = \\bigcap_{t>0} t(S-s_0)$ ( \\S A.2.2); for all $t>0$, we can find $s_t\\in S$ such that $p=t(s_t-s_0)$. Now, for $q\\in\\operatorname{dom}\\sigma_S$, there holds\n\\[\n\\langle p,q\\rangle = t\\langle s_t-s_0,q\\rangle \\le t\\big[\\sigma_S(q)-\\langle s_0,q\\rangle\\big]<+\\infty\n\\]\nand letting $t\\downarrow 0$ shows that $\\langle p,q\\rangle\\le 0$. In other words, $\\operatorname{dom}\\sigma_S\\subset (S_\\infty)^\\circ$; then $\\overline{\\operatorname{dom}\\sigma_S}\\subset (S_\\infty)^\\circ$ since the latter is closed.\n\nConversely, let $q\\in (\\operatorname{dom}\\sigma_S)^\\circ$, which is a cone, hence $tq\\in(\\operatorname{dom}\\sigma_S)^\\circ$ for any $t>0$. Thus, given $s_0\\in S$, we have for arbitrary $p\\in\\operatorname{dom}\\sigma_S$\n\\[\n\\langle s_0+tq,p\\rangle = \\langle s_0,p\\rangle + t\\langle q,p\\rangle \\le \\langle s_0,p\\rangle \\le \\sigma_S(p),\n\\]\nso $s_0+tq\\in S$ by virtue of Theorem 2.2.2. In other words: $q\\in (S-s_0)/t$ for all $t>0$ and $q\\in S_\\infty$."
    },
    {
        "statement": "Let $\\sigma$ be a closed sublinear function; then there is a linear function minorizing $\\sigma$.  In fact, $\\sigma$ is the supremum of the linear functions minorizing it. In other words, $\\sigma$ is the support function of the nonempty closed convex set\n\\[\nS_\\sigma := \\{s\\in\\mathbb{R}^n : \\langle s,d\\rangle \\le \\sigma(d)\\ \\text{for all } d\\in\\mathbb{R}^n\\}.\n\\tag{3.1.1}\n\\]",
        "title": "",
        "label": "thm:FCA-chapC-3.1.1",
        "lean_tag": [
            "FCA_chap_C_3_1_1"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_1_1 {n : ‚Ñï}\n  (œÉ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hœÉ_closed : IsClosedFun œÉ) (hœÉ_sublinear : IsSublinear (liftWithToptoEReal œÉ)) :\n  let SœÉ := {s | ‚àÄ d, inner ‚Ñù s d ‚â§ œÉ d}\n  ((‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)) (b : ‚Ñù), ‚àÄ x, inner ‚Ñù s x + b ‚â§ œÉ x)) ‚àß\n  (‚àÄ x, œÉ x = SupportFun SœÉ x) := by\n  sorry",
        "proof": "Being convex, $\\sigma$ is minorized by some affine function (Proposition B.1.2.1): for some $(s,r)\\in\\mathbb{R}^n\\times\\mathbb{R}$,\n\\[\n\\langle s,d\\rangle - r \\le \\sigma(d)\\qquad\\text{for all } d\\in\\mathbb{R}^n.\n\\tag{3.1.2}\n\\]\nBecause $\\sigma(0)=0$, the above $r$ is nonnegative.  Also, by positive homogeneity,\n\\[\n\\langle s,d\\rangle - \\tfrac{1}{t}r \\le \\sigma(d)\\qquad\\text{for all } d\\in\\mathbb{R}^n\\ \\text{and all } t>0.\n\\]\nLetting $t\\to+\\infty$, we see that $\\sigma$ is actually minorized by a linear function:\n\\[\n\\langle s,d\\rangle \\le \\sigma(d)\\qquad\\text{for all } d\\in\\mathbb{R}^n.\n\\tag{3.1.3}\n\\]\nNow observe that the minorization (3.1.3) is sharper than (3.1.2): when expressing the closed convex $\\sigma$ as the supremum of all the affine functions minorizing it (Proposition B.1.2.8), we can restrict ourselves to linear functions.  In other words\n\\[\n\\sigma(d)=\\sup\\{\\langle s,d\\rangle :\\ \\text{the linear }\\langle s,\\cdot\\rangle\\ \\text{minorizes }\\sigma\\};\n\\]\nin the above index-set, we just recognize $S_\\sigma$."
    },
    {
        "statement": "For a nonempty closed convex set $S$ and a closed sublinear function $\\sigma$, the following are equivalent:\n\\begin{enumerate}\n    \\item[(i)] \\(\\sigma\\) is the support function of \\(S\\).\n    \\item[(ii)] \\(S=\\{s:\\ \\langle s,d\\rangle\\le\\sigma(d)\\text{ for all }d\\in X\\},\\) where the set \\(X\\) can be indifferently taken as: the whole of \\(\\mathbb{R}^n\\), the unit ball \\(B(0,1)\\) or its boundary, or \\(\\operatorname{dom}\\sigma\\).\n\\end{enumerate}",
        "title": "",
        "label": "cor:FCA-chapC-3.1.2",
        "lean_tag": [
            "FCA_chap_C_3_1_2"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_1_2 {n : ‚Ñï}\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (œÉ : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hS_nonempty : Set.Nonempty S) (hS_closed : IsClosed S) (hS_convex : Convex ‚Ñù S)\n  (hœÉ_closed : IsClosedFun œÉ) (hœÉ_sublinear : IsSublinear (liftWithToptoEReal œÉ)) :\n  let support_fun := SupportFun S\n  let S' := {s | ‚àÄ (d : EuclideanSpace ‚Ñù (Fin n)), inner ‚Ñù s d ‚â§ œÉ d}\n  List.TFAE [\n    ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)), support_fun x = œÉ x,\n    S = S'\n  ] := by\n  sorry",
        "proof": "The case \\(X=\\mathbb{R}^n\\) is just Theorem 3.1.1. The other cases are then clear."
    },
    {
        "statement": "For $x$ in a nonempty closed convex set $C$, it holds\n\\[\nx\\in F_C(d)\\iff d\\in N_C(x).\n\\]",
        "title": "",
        "label": "prop:FCA-chapC-3.1.4",
        "lean_tag": [
            "FCA_chap_C_3_1_4"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_1_4 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (x : EuclideanSpace ‚Ñù (Fin n)) (d : EuclideanSpace ‚Ñù (Fin n))\n  (hC_nonempty : Set.Nonempty C) (hC_closed : IsClosed C) (hC_convex : Convex ‚Ñù C)\n  (hx : x ‚àà C) (hd : d ‚â† 0) :\n  x ‚àà DirectionExposingFace C d ‚Üî d ‚àà NormalCone x C := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Let $C$ be a closed convex set containing the origin. Its gauge $\\gamma_C$ is the support function of a closed convex set containing the origin, namely\n\\[\nC^\\circ := \\{ s\\in\\mathbb{R}^n : \\langle s,d\\rangle \\le 1\\ \\text{for all } d\\in C\\},\n\\tag{3.2.8}\n\\]\nwhich defines the polar (set) of $C$.",
        "title": "",
        "label": "prop:FCA-chapC-3.2.4",
        "lean_tag": [
            "FCA_chap_C_3_2_4"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_2_4 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC_closed : IsClosed C) (hC_convex : Convex ‚Ñù C) (hC_origin : 0 ‚àà C) :\n  let Œ≥C := gauge C\n  let C' := {s | ‚àÄ d ‚àà C, inner ‚Ñù s d ‚â§ 1}\n  let œÉC' := SupportFun C'\n  ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)), Œ≥C x = œÉC' x := by\n  sorry",
        "proof": "We know that $\\gamma_C$ (which, by Theorem 1.2.5(i), is closed, sublinear and nonnegative) is the support function of some closed convex set containing the origin, say $D$; from (3.1.1),\n\\[\nD=\\{s\\in\\mathbb{R}^n:\\ \\langle s,d\\rangle \\le r\\ \\text{ for all }(d,r)\\in\\operatorname{epi}\\gamma_C\\}.\n\\]\nAs seen in (1.2.4), $\\operatorname{epi}\\gamma_C$ is the closed convex conical hull of $C\\times\\{1\\}$; we can use positive homogeneity to write\n\\[\nD=\\{s\\in\\mathbb{R}^n:\\ \\langle s,d\\rangle \\le 1\\ \\text{ for all }d\\ \\text{such that }\\gamma_C(d)\\le 1\\}.\n\\]\nIn view of Theorem 1.2.5(iii), the above index-set is just $C$; in other words, $D=C^\\circ$."
    },
    {
        "statement": "Let $C$ be a closed convex set containing the origin. Its support function $\\sigma_C$ is the gauge of $C^\\circ$.",
        "title": "",
        "label": "cor:FCA-chapC-3.2.5",
        "lean_tag": [
            "FCA_chap_C_3_2_5"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_2_5 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC_closed : IsClosed C) (hC_convex : Convex ‚Ñù C) (hC_origin : 0 ‚àà C) :\n  let C' := {s | ‚àÄ d ‚àà C, inner ‚Ñù s d ‚â§ 1}\n  let œÉC := SupportFun C\n  let Œ≥C' := gauge C'\n  ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)), Œ≥C' x = œÉC x := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Let $C$ be a nonempty compact convex set having $0$ in its interior, so that $C^\\circ$ enjoys the same properties. Then, for all $d$ and $s$ in $\\mathbb{R}^n$, the following statements are equivalent (the notation (3.2.9) is used)\n\\begin{enumerate}\n\\item[(i)] $H(s)$ is a supporting hyperplane to $C$ at $d$;\n\\item[(ii)] $H(d)$ is a supporting hyperplane to $C^\\circ$ at $s$;\n\\item[(iii)] $d\\in\\operatorname{bd}C,\\ s\\in\\operatorname{bd}C^\\circ\\text{ and }\\langle s,d\\rangle=1$;\n\\item[(iv)] $d\\in C,\\ s\\in C^\\circ\\text{ and }\\langle s,d\\rangle=1$.\n\\end{enumerate}",
        "title": "",
        "label": "prop:FCA-chapC-3.2.7",
        "lean_tag": [
            "FCA_chap_C_3_2_7"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_2_7 {n : ‚Ñï}\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (d s : EuclideanSpace ‚Ñù (Fin n))\n  (hC_nonempty : Set.Nonempty C)\n  (hC_compact : IsCompact C)\n  (hC_convex : Convex ‚Ñù C)\n  (hC_origin : 0 ‚àà interior C) :\n  let C' := {s | ‚àÄ v ‚àà C, inner ‚Ñù s v ‚â§ 1}\n  let Hs := {y | inner ‚Ñù s y = 1}\n  let Hd := {y | inner ‚Ñù d y = 1}\n  List.TFAE [\n    ‚àÉ (s' : EuclideanSpace ‚Ñù (Fin n)) (t' : ‚Ñù), (SupportingHyperplaneAt s' d t' C) ‚àß (AffineHyperplane s' t' = Hs),\n    ‚àÉ (d' : EuclideanSpace ‚Ñù (Fin n)) (t' : ‚Ñù), (SupportingHyperplaneAt d' s t' C) ‚àß (AffineHyperplane d' t' = Hd),\n    (d ‚àà frontier C) ‚àß (s ‚àà frontier C') ‚àß (inner ‚Ñù s d = 1),\n    (d ‚àà C) ‚àß (s ‚àà C') ‚àß (inner ‚Ñù s d = 1)\n  ] := by\n  sorry",
        "proof": "Left as an exercise; the assumptions are present to make sure that every nonzero vector in $\\mathbb{R}^n$ does expose a face in each set."
    },
    {
        "statement": "Let $S_1$ and $S_2$ be nonempty closed convex sets; call $\\sigma_1$ and $\\sigma_2$ their support functions. Then\n\\[\nS_1\\subset S_2 \\iff \\sigma_1(d)\\le \\sigma_2(d)\\text{ for all }d\\in\\mathbb{R}^n.\n\\]",
        "title": "",
        "label": "thm:FCA-chapC-3.3.1",
        "lean_tag": [
            "FCA_chap_C_3_3_1"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_3_1 {n : ‚Ñï}\n  (S‚ÇÅ S‚ÇÇ : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hS_nonempty : Set.Nonempty S‚ÇÅ ‚àß Set.Nonempty S‚ÇÇ)\n  (hS_closed : IsClosed S‚ÇÅ ‚àß IsClosed S‚ÇÇ)\n  (hS_convex : Convex ‚Ñù S‚ÇÅ ‚àß Convex ‚Ñù S‚ÇÇ) :\n  let œÉ‚ÇÅ := SupportFun S‚ÇÅ\n  let œÉ‚ÇÇ := SupportFun S‚ÇÇ\n  S‚ÇÅ ‚äÜ S‚ÇÇ ‚Üî ‚àÄ d, œÉ‚ÇÅ d ‚â§ œÉ‚ÇÇ d := by\n  sorry",
        "proof": "Apply the equivalence stated in Corollary 3.1.2:\n\\[\nS_1\\subset S_2 \\iff s\\in S_2\\text{ for all }s\\in S_1\n\\]\n\\[\n\\iff \\sigma_2(d)\\ge\\langle s,d\\rangle\\text{ for all }s\\in S_1\\text{ and all }d\\in\\mathbb{R}^n\n\\]\n\\[\n\\iff \\sigma_2(d)\\ge\\sup_{s\\in S_1}\\langle s,d\\rangle\\text{ for all }d\\in\\mathbb{R}^n.\n\\]"
    },
    {
        "statement": "\\begin{enumerate}\n    \\item[(i)] Let $\\sigma_1$ and $\\sigma_2$ be the support functions of the nonempty closed convex sets $S_1$ and $S_2$. If $t_1$ and $t_2$ are positive, then\n    \\[\n    t_1\\sigma_1+t_2\\sigma_2\\ \\text{is the support function of }\\ \\overline{(t_1S_1+t_2S_2)}.\n    \\]\n    \\item[(ii)] Let $\\{\\sigma_j\\}_{j\\in J}$ be the support functions of the family of nonempty closed convex sets $\\{S_j\\}_{j\\in J}$. Then\n    \\[\n    \\sup_{j\\in J}\\sigma_j\\text{ is the support function of }\\overline{\\operatorname{co}}\\{\\,\\bigcup_{j\\in J}S_j:\\; j\\in J\\}.\n    \\]\n    \\item[(iii)] Let $\\{\\sigma_j\\}_{j\\in J}$ be the support functions of the family of closed convex sets $\\{S_j\\}_{j\\in J}$. If\n    \\[\n    S:=\\bigcap_{j\\in J}S_j\\neq\\varnothing,\n    \\]\n    then\n    \\[\n    \\sigma_S=\\overline{\\operatorname{co}}\\{\\inf\\sigma_j:\\; j\\in J\\}.\n    \\]\n\\end{enumerate}",
        "title": "",
        "label": "thm:FCA-chapC-3.3.2",
        "lean_tag": [
            "FCA_chap_C_3_3_2_i",
            "FCA_chap_C_3_3_2_ii",
            "FCA_chap_C_3_3_2_iii"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_3_2_i {n : ‚Ñï}\n  (S‚ÇÅ S‚ÇÇ : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (t‚ÇÅ t‚ÇÇ : ‚Ñù)\n  (hS_nonempty : Set.Nonempty S‚ÇÅ ‚àß Set.Nonempty S‚ÇÇ)\n  (hS_closed : IsClosed S‚ÇÅ ‚àß IsClosed S‚ÇÇ)\n  (hS_convex : Convex ‚Ñù S‚ÇÅ ‚àß Convex ‚Ñù S‚ÇÇ)\n  (ht : t‚ÇÅ > 0 ‚àß t‚ÇÇ > 0):\n  let œÉ‚ÇÅ := SupportFun S‚ÇÅ\n  let œÉ‚ÇÇ := SupportFun S‚ÇÇ\n  let S‚ÇÅ' := {x | ‚àÉ s ‚àà S‚ÇÅ, x = t‚ÇÅ ‚Ä¢ s}\n  let S‚ÇÇ' := {x | ‚àÉ s ‚àà S‚ÇÇ, x = t‚ÇÇ ‚Ä¢ s}\n  let S := closure {x | ‚àÉ s‚ÇÅ ‚àà S‚ÇÅ', ‚àÉ s‚ÇÇ ‚àà S‚ÇÇ', x = s‚ÇÅ + s‚ÇÇ}\n  ‚àÄ x, (t‚ÇÅ ‚Ä¢ (œÉ‚ÇÅ x) + t‚ÇÇ ‚Ä¢ (œÉ‚ÇÇ x)) = SupportFun S x := by\n  sorry",
        "proof": "[(i)] Call $S$ the closed convex set $\\operatorname{cl}(t_1S_1+t_2S_2)$. By definition, its support function is\n\\[\n\\sigma_S(d)=\\sup\\{\\langle t_1s_1+t_2s_2,d\\rangle:\\; s_1\\in S_1,\\; s_2\\in S_2\\}.\n\\]\nIn the above expression, $s_1$ and $s_2$ run independently in their index sets $S_1$ and $S_2$, $t_1$ and $t_2$ are positive, so\n\\[\n\\sigma_S(d)=t_1\\sup_{s\\in S_1}\\langle s,d\\rangle+t_2\\sup_{s\\in S_2}\\langle s,d\\rangle.\n\\]\n\n[(ii)] The support function of $S:=\\bigcup_{j\\in J}S_j$ is\n\\[\n\\sup_{s\\in\\bigcup_{j\\in J}S_j}\\langle s,d\\rangle=\\sup_{j\\in J}\\sup_{s_j\\in S_j}\\langle s_j,d\\rangle=\\sup_{j\\in J}\\sigma_j(d).\n\\]\nThis implies (ii) since $\\sigma_S=\\sigma_{\\overline{\\operatorname{co}}\\,S}$.\n\n[(iii)] The set $S:=\\bigcap_j S_j$ being nonempty, it has a support function $\\sigma_S$. Now, from Corollary 3.1.2,\n\\[\ns\\in S\\iff s\\in S_j\\text{ for all }j\\in J\n\\]\n\\[\n\\iff\\langle s,\\cdot\\rangle\\le\\sigma_j\\text{ for all }j\\in J\n\\]\n\\[\n\\iff\\langle s,\\cdot\\rangle\\le\\inf_{j\\in J}\\sigma_j\n\\]\n\\[\n\\iff\\langle s,\\cdot\\rangle\\le\\overline{\\operatorname{co}}\\bigl(\\inf_{j\\in J}\\sigma_j\\bigr),\n\\]\nwhere the last equivalence comes directly from the Definition B.2.5.3 of a closed convex hull. Again Corollary 3.1.2 tells us that the closed sublinear function $\\overline{\\operatorname{co}}(\\inf\\sigma_j)$ is just the support function of $S$."
    },
    {
        "statement": "Let $A:\\mathbb{R}^n\\to\\mathbb{R}^m$ be a linear operator, with adjoint $A^*$ (for some scalar product $\\langle\\cdot,\\cdot\\rangle$ in $\\mathbb{R}^m$). For $S\\subset\\mathbb{R}^n$ nonempty, we have\n\\[\n\\sigma_{\\mathrm{cl}\\,A(S)}(y)=\\sigma_{S}(A^*y)\\qquad\\text{for all }y\\in\\mathbb{R}^m.\n\\]",
        "title": "",
        "label": "prop:FCA-chapC-3.3.3",
        "lean_tag": [
            "FCA_chap_C_3_3_3"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_3_3 {m n : ‚Ñï}\n  (A : EuclideanSpace ‚Ñù (Fin n) ‚Üí‚Çó[‚Ñù] EuclideanSpace ‚Ñù (Fin m))\n  (S : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hS_nonempty : Set.Nonempty S) :\n  let A_adj := A.adjoint\n  let cl_AS := closure (Set.image A S)\n  let œÉ_clAS := SupportFun cl_AS\n  let œÉ_S_Aadj := fun y => SupportFun S (A_adj y)\n  ‚àÄ (y : EuclideanSpace ‚Ñù (Fin m)), œÉ_clAS y = œÉ_S_Aadj y := by\n  sorry",
        "proof": "Just write the definitions\n\\[\n\\sigma_{A(S)}(y)=\\sup_{s\\in S}\\langle As,y\\rangle=\\sup_{s\\in S}\\langle s,A^*y\\rangle\n\\]\nand use Proposition 2.2.1 to obtain the result."
    },
    {
        "statement": "Let $A:\\mathbb{R}^m\\to\\mathbb{R}^n$ be a linear operator, with adjoint $A^*$ (for some scalar product $\\langle\\cdot,\\cdot\\rangle$ in $\\mathbb{R}^m$). Let $\\sigma$ be the support function of a nonempty closed convex set $S\\subset\\mathbb{R}^m$. If $\\sigma$ is minorized on the inverse image\n\\[\nA^{-1}(d)=\\{p\\in\\mathbb{R}^m:\\;Ap=d\\}\\tag{3.3.3}\n\\]\nof each $d\\in\\mathbb{R}^n$, then the support function of the set $(A^{-1})^*(S)$ is the closure of the image-function $A\\sigma$.",
        "title": "",
        "label": "prop:FCA-chapC-3.3.4",
        "lean_tag": [
            "FCA_chap_C_3_3_4"
        ],
        "lean_formalization": "lemma FCA_chap_C_3_3_4 {m n : ‚Ñï}\n  (A : EuclideanSpace ‚Ñù (Fin m) ‚Üí‚Çó[‚Ñù] EuclideanSpace ‚Ñù (Fin n))\n  (s : EuclideanSpace ‚Ñù (Fin m) ‚Üí EuclideanSpace ‚Ñù (Fin m) ‚Üí ‚Ñù)\n  (S : Set (EuclideanSpace ‚Ñù (Fin m)))\n  (hs : IsScalarProduct s)\n  (hS_nonempty : Set.Nonempty S) (hS_closed : IsClosed S) (hS_convex : Convex ‚Ñù S) :\n  let A_star := A.adjoint\n  let œÉ := SupportFun S\n  let A_inv := fun d => {p : EuclideanSpace ‚Ñù (Fin m) | A p = d}\n  let A_adj_inv_S := {p : EuclideanSpace ‚Ñù (Fin n) | ‚àÉ d ‚àà S, A_star p = d}\n  let œÉ_adj_inv := SupportFun A_adj_inv_S\n  (‚àÄ (d : EuclideanSpace ‚Ñù (Fin n)), IsMinorizedOn œÉ (A_inv d)) ‚Üí\n  (‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)), œÉ_adj_inv x = lscHull (fun v => ImageFunction A œÉ v) x) := by\n  sorry\n",
        "proof": "Our assumption is tailored to guarantee $A\\sigma\\in\\operatorname{Conv}\\mathbb{R}^n$ (Theorem B.2.4.2). The positive homogeneity of $A\\sigma$ is clear: for $d\\in\\mathbb{R}^n$ and $t>0$,\n\\[\n(A\\sigma)(td)=\\inf_{Ap=td}\\sigma(p)=\\inf_{A(p/t)=d}t\\sigma(p/t)=t\\inf_{Aq=d}\\sigma(q)=t(A\\sigma)(d).\n\\]\n\nThus, the closed sublinear function $\\operatorname{cl}(A\\sigma)$ supports some set $S'$; by definition,\n$s\\in S'$ if and only if\n\\[\n\\langle s,d\\rangle \\le \\inf\\{\\sigma(p):\\;Ap=d\\}\\qquad\\text{for all }d\\in\\mathbb R^n;\n\\]\nbut this just means\n\\[\n\\langle s,Ap\\rangle \\le \\sigma(p)\\qquad\\text{for all }p\\in\\mathbb R^m,\n\\]\ni.e.\\ $A^*s\\in S$, because $\\langle s,Ap\\rangle=\\langle A^*s,p\\rangle$."
    },
    {
        "statement": "For fixed $x$, the function $f'(x,\\cdot)$ is finite sublinear.",
        "title": "",
        "label": "prop:FCA-chapD-1.1.2",
        "lean_tag": [
            "FCA_chap_D_1_1_2"
        ],
        "lean_formalization": "lemma FCA_chap_D_1_1_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf : ConvexOn ‚Ñù Set.univ f) :\n  let f' := fun d => directionalDeriv (liftRealtoEReal f) x d\n  (‚àÄ (z : EuclideanSpace ‚Ñù (Fin n)), f' z < ‚ä§ ‚àß f' z > ‚ä•) ‚àß (IsSublinear f') := by\n  sorry",
        "proof": "Let $d_1,d_2\\in\\mathbb{R}^n$, and positive $\\alpha_1,\\alpha_2$ with $\\alpha_1+\\alpha_2=1$. From the convexity of $f$:\n\\[\nf\\bigl(x+t(\\alpha_1d_1+\\alpha_2d_2)\\bigr)-f(x)=\n\\]\n\\[\nf\\bigl(\\alpha_1(x+td_1)+\\alpha_2(x+td_2)\\bigr)-\\alpha_1f(x)-\\alpha_2f(x)\\le\n\\]\n\\[\n\\le\\alpha_1\\bigl[f(x+td_1)-f(x)\\bigr]+\\alpha_2\\bigl[f(x+td_2)-f(x)\\bigr].\n\\]\nfor all $t$. Dividing by $t>0$ and letting $t\\downarrow0$, we obtain\n\\[\nf'(x,\\alpha_1d_1+\\alpha_2d_2)\\le\\alpha_1f'(x,d_1)+\\alpha_2f'(x,d_2)\n\\]\nwhich establishes the convexity of $f'$ with respect to $d$. Its positive homogeneity is clear: for $\\lambda>0$\n\\[\nf'(x,\\lambda d)=\\lim_{t\\downarrow0}\\lambda\\frac{f(x+\\lambda td)-f(x)}{\\lambda t}\n=\\lambda\\lim_{\\tau\\downarrow0}\\frac{f(x+\\tau d)-f(x)}{\\tau}\n=\\lambda f'(x,d).\n\\]\n\nFinally suppose $\\|d\\|=1$. As a finite convex function, $f$ is Lipschitz continuous around $x$ (Theorem B.3.1.2); in particular there exist $\\varepsilon>0$ and $L>0$ such that\n\\[\n|f(x+td)-f(x)|\\le Lt\\quad\\text{for }0\\le t\\le\\varepsilon.\n\\]\nHence, $|f'(x,d)|\\le L$ and we conclude with positive homogeneity:\n\\[\n|f'(x,d)|\\le L\\|d\\|\\qquad\\text{for all }d\\in\\mathbb{R}^n.\n\\tag{1.1.5}\n\\]"
    },
    {
        "statement": "The finite sublinear function $d\\mapsto\\sigma(d):=f'(x,d)$ satisfies\n\\[\n\\sigma'(0,\\delta)=f'(x,\\delta)\\qquad\\text{for all }\\delta\\in\\mathbb{R}^n;\n\\tag{1.1.8}\n\\]\n\\[\n\\sigma(\\delta)=\\sigma(0)+\\sigma'(0,\\delta)=\\sigma'(0,\\delta)\\qquad\\text{for all }\\delta\\in\\mathbb{R}^n;\n\\tag{1.1.9}\n\\]\n\\[\n\\partial\\sigma(0)=\\partial f(x).\n\\tag{1.1.10}\n\\]",
        "title": "",
        "label": "prop:FCA-chapD-1.1.6",
        "lean_tag": [
            "FCA_chap_D_1_1_6"
        ],
        "lean_formalization": "lemma FCA_chap_D_1_1_6 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf : ConvexOn ‚Ñù Set.univ f) :\n  let œÉ := fun (d : EuclideanSpace ‚Ñù (Fin n)) => directionalDeriv (liftRealtoEReal f) x d\n  let œÉ' := fun (d : EuclideanSpace ‚Ñù (Fin n)) => directionalDeriv œÉ 0 d\n  (‚àÄ (Œ¥ : EuclideanSpace ‚Ñù (Fin n)), œÉ' Œ¥ = œÉ Œ¥) ‚àß\n  (‚àÄ (Œ¥ : EuclideanSpace ‚Ñù (Fin n)), (œÉ Œ¥ = œÉ 0 + œÉ' Œ¥) ‚àß (œÉ Œ¥ = œÉ' Œ¥)) ‚àß\n  (SubdifferentialI œÉ 0 = SubdifferentialI (liftRealtoEReal f) x) := by\n  sorry",
        "proof": "Because $\\sigma$ is positively homogeneous and $\\sigma(0)=0$,\n\\[\n\\frac{\\sigma(t\\delta)-\\sigma(0)}{t}=\\sigma(\\delta)=f'(x,\\delta)\\qquad\\text{for all }t>0.\n\\]\nThis implies immediately (1.1.8) and (1.1.9). Then (1.1.10) follows from uniqueness of the supported set."
    },
    {
        "statement": "The definitions 1.1.4 and 1.2.1 are equivalent.",
        "title": "",
        "label": "thm:FCA-chapD-1.2.2",
        "lean_tag": [
            "FCA_chap_D_1_2_2"
        ],
        "lean_formalization": "lemma FCA_chap_D_1_2_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n)) (s : EuclideanSpace ‚Ñù (Fin n))\n  (hf : ConvexOn ‚Ñù Set.univ f) :\n  s ‚àà SubdifferentialI (liftRealtoEReal f) x ‚Üî s ‚àà SubdifferentialII (liftRealtoEReal f) x := by\n  sorry",
        "proof": "Let $s$ satisfy (1.1.6), i.e.\n\\[\n\\langle s,d\\rangle \\le f'(x,d)\\qquad\\text{for all }d\\in\\mathbb{R}^n. \\tag{1.2.2}\n\\]\n\nThe second equality in (1.1.2) makes it clear that (1.2.2) is equivalent to\n\\[\n\\langle s,d\\rangle \\le \\frac{f(x+td)-f(x)}{t}\\qquad\\text{for all }d\\in\\mathbb{R}^n\\text{ and }t>0. \\tag{1.2.3}\n\\]\n\nWhen $d$ describes $\\mathbb{R}^n$ and $t$ describes $\\mathbb{R}_+^*$, $y:=x+td$ describes $\\mathbb{R}^n$ and we realize that (1.2.3) is just (1.2.1)."
    },
    {
        "statement": "\\begin{enumerate}\n    \\item[(i)] A vector $s\\in\\mathbb{R}^n$ is a subgradient of $f$ at $x$ if and only if $(s,-1)\\in\\mathbb{R}^n\\times\\mathbb{R}$ is normal to $\\operatorname{epi}f$ at $(x,f(x))$.  In other words:\n    \\[\n    N_{\\operatorname{epi}f}(x,f(x))=\\{(\\lambda s,-\\lambda): s\\in\\partial f(x),\\ \\lambda\\ge 0\\}.\n    \\]\n    \\item[(ii)] The tangent cone to the set $\\operatorname{epi}f$ at $(x,f(x))$ is the epigraph of the directional-derivative function $d\\mapsto f'(x,d)$:\n    \\[\n    T_{\\operatorname{epi}f}(x,f(x))=\\{(d,r): r\\ge f'(x,d)\\}.\n    \\]\n\\end{enumerate}",
        "title": "",
        "label": "prop:FCA-chapD-1.3.1",
        "lean_tag": [
            "FCA_chap_D_1_3_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_1_3_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x s : EuclideanSpace ‚Ñù (Fin n))\n  (hf : ConvexOn ‚Ñù Set.univ f) :\n  let f' := fun (d : EuclideanSpace ‚Ñù (Fin n)) => directionalDeriv (liftRealtoEReal f) x\n  let f'_epi := {v : EuclideanSpace ‚Ñù (Fin (n + 1)) |\n                     ‚àÉ z ‚àà (epigraph (f' x)), v = Fin.snoc z.1 z.2}\n  let epi_concat := {v : EuclideanSpace ‚Ñù (Fin (n + 1)) |\n                         ‚àÉ z ‚àà (epigraph (liftRealtoEReal f)), v = Fin.snoc z.1 z.2}\n  let s' : EuclideanSpace ‚Ñù (Fin (n + 1)) := Fin.snoc s (-1)\n  (IsSubgradientAt (liftRealtoEReal f) x s ‚Üî IsNormalTo epi_concat (Fin.snoc x (f x)) s') ‚àß\n  (tangentConeAt ‚Ñù epi_concat (Fin.snoc x (f x)) = f'_epi) := by\n  sorry",
        "proof": "[(i)] Apply Definition A.5.2.3 to see that $(s,-1)\\in N_{\\operatorname{epi}f}(x,f(x))$ means\n\\[\n\\langle s,y-x\\rangle+(-1)[r-f(x)]\\le 0\\qquad\\text{for all }y\\in\\mathbb{R}^n\\text{ and }r\\ge f(y)\n\\]\nand the equivalence with (1.2.1) is clear.  The formula follows since the set of normals forms a cone containing the origin.\n\n[(ii)] The tangent cone to $\\operatorname{epi}f$ is the polar of the above normal cone, i.e. the set of $(d,r)\\in\\mathbb{R}^n\\times\\mathbb{R}$ such that\n\\[\n\\langle\\lambda s,d\\rangle+(-\\lambda)r\\le 0\\qquad\\text{for all }s\\in\\partial f(x)\\text{ and }\\lambda\\ge 0.\n\\]\nBarring the trivial case $\\lambda=0$, we divide by $\\lambda>0$ to obtain\n\\[\nr\\ge\\max\\{\\langle s,d\\rangle: s\\in\\partial f(x)\\}=f'(x,d).\n\\]"
    },
    {
        "statement": "For the convex function $f:\\mathbb{R}^n\\to\\mathbb{R}$ and the sublevel-set (1.3.1), we have\n\\[\nT_{S_{f(x)} }(x)\\subset\\{d:\\;f'(x,d)\\le 0\\}. \\tag{1.3.2}\n\\]",
        "title": "",
        "label": "lem:FCA-chapD-1.3.2",
        "lean_tag": [
            "FCA_chap_D_1_3_2"
        ],
        "lean_formalization": "lemma FCA_chap_D_1_3_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf : ConvexOn ‚Ñù Set.univ f) :\n  let S := sublevelSetFun (liftRealtoEReal f) x\n  tangentConeAt ‚Ñù S x ‚äÜ {d | directionalDeriv (liftRealtoEReal f) x d ‚â§ 0} := by\n  sorry",
        "proof": "Take arbitrary $y\\in S_{f(x)},\\ t>0$, and set $d:=t(y-x)$. Then, using the second equality in (1.1.2),\n\\[\n0\\ge t[f(y)-f(x)]=\\frac{f(x+d/t)-f(x)}{1/t}\\ge f'(x,d).\n\\]\nSo we have proved\n\\[\n\\mathbb{R}^+[S_{f(x)}-x]\\subset\\{d:\\;f'(x,d)\\le 0\\} \\tag{1.3.3}\n\\]\n(note: the case $d=0$ is covered since $0\\in S_{f(x)}-x$).\n\nBecause $f'(\\cdot,\\cdot)$ is a closed function, the righthand set in (1.3.3) is closed. Knowing that $T_{S_{f(x)}}(x)$ is the closure of the lefthand side in (1.3.3) (Proposition A.5.2.1), we deduce the result by taking the closure of both sides in (1.3.3)."
    },
    {
        "statement": "Let $g:\\mathbb{R}^n\\to\\mathbb{R}$ be convex and suppose that $g(x_0)<0$ for some $x_0\\in\\mathbb{R}^n$. Then\n\\[\n\\operatorname{cl}\\{z: g(z)<0\\}=\\{z: g(z)\\le 0\\},\\tag{1.3.4}\n\\]\n\\[\n\\{z: g(z)<0\\}=\\operatorname{int}\\{z: g(z)\\le 0\\}.\\tag{1.3.5}\n\\]\nIt follows\n\\[\n\\operatorname{bd}\\{z: g(z)\\le 0\\}=\\{z: g(z)=0\\}.\\tag{1.3.6}\n\\]",
        "title": "",
        "label": "prop:FCA-chapD-1.3.3",
        "lean_tag": [
            "FCA_chap_D_1_3_3"
        ],
        "lean_formalization": "lemma FCA_chap_D_1_3_3 {n : ‚Ñï}\n  (g : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (hg_convex : ConvexOn ‚Ñù Set.univ g)\n  (hg_neg : ‚àÉ (x‚ÇÄ : EuclideanSpace ‚Ñù (Fin n)), g x‚ÇÄ < 0):\n  (closure {z | g z < 0} = {z | g z ‚â§ 0}) ‚àß\n  ({z | g z < 0} = interior {z | g z ‚â§ 0}) ‚àß\n  (frontier {z | g z < 0} = {z | g z = 0}) := by\n  sorry",
        "proof": "Because $g$ is (lower semi-) continuous, the inclusion ``$\\subset$'' automatically holds in (1.3.4). Conversely, let $\\bar z$ be arbitrary with $g(\\bar z)\\le 0$ and, for $k>0$, set\n\\[\nz_k:=\\tfrac{1}{k}x_0+(1-\\tfrac{1}{k})\\bar z.\n\\]\nBy convexity of $g$, $g(z_k)<0$, so (1.3.4) is established by letting $k\\to+\\infty$.\n\nNow, take the interior of both sides in (1.3.4). The ``int cl'' on the left is actually an ``int'' (Proposition A.2.1.8), and this ``int''-operation is useless because $g$ is (upper semi-) continuous: (1.3.5) is established."
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}$ be convex and suppose $0\\notin\\partial f(x)$. Then, $S_{f}(x)$ being the sublevel-set (1.3.1),\n\\[\nT_{S_{f}(x)}(x)=\\{d\\in\\mathbb{R}^n:\\;f'(x,d)\\le 0\\}\\tag{1.3.7}\n\\]\n\\[\n\\operatorname{int}\\big[T_{S_{f}(x)}(x)\\big]=\\{d\\in\\mathbb{R}^n:\\;f'(x,d)<0\\}\\neq\\varnothing.\\tag{1.3.8}\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-1.3.4",
        "lean_tag": [
            "FCA_chap_D_1_3_4"
        ],
        "lean_formalization": "lemma FCA_chap_D_1_3_4 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f)\n  (hf_subdiff : Set.Nonempty (SubdifferentialI (liftRealtoEReal f) x)) :\n  let S := sublevelSetFun (liftRealtoEReal f) x\n  (tangentConeAt ‚Ñù S x = {d | directionalDeriv (liftRealtoEReal f) x d ‚â§ 0}) ‚àß\n  (interior (tangentConeAt ‚Ñù S x) = {d | directionalDeriv (liftRealtoEReal f) x d < 0}) ‚àß\n  Set.Nonempty (interior (tangentConeAt ‚Ñù S x)):= by\n  sorry",
        "proof": "From the very definition (1.1.6), our assumption means that $f'(x,d)<0$ for some $d$, and (1.1.2) then implies that $f(x+td)<f(x)$ for $t>0$ small enough: our $d$ is of the form $(x+td-x)/t$ with $x+td\\in S_{f}(x)$ and we have proved\n\\[\n\\{d:\\;f'(x,d)<0\\}\\subset\\mathbb{R}^+[S_{f}(x)-x]\\subset T_{S_{f}(x)}(x).\\tag{1.3.9}\n\\]\n\nNow, we can apply (1.3.4) with $g=f'(x,\\cdot)$:\n\\[\n\\operatorname{cl}\\{d:\\;f'(x,d)<0\\}=\\{d:\\;f'(x,d)\\le 0\\},\n\\]\nso (1.3.7) is proved by closing the sets in (1.3.9) and using (1.3.2). Finally, take the interior of both sides in (1.3.7) and apply (1.3.5) with $g=f'(x,\\cdot)$ to prove (1.3.8)."
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}$ be convex and suppose $0\\notin\\partial f(x)$.  Then a direction $d$ is normal to $S f(x)$ at $x$ if and only if there is some $t\\ge 0$ and some $s\\in\\partial f(x)$ such that $d=ts$:\n\\[\nN_{S f(x)}(x)=\\mathbb{R}^+ \\partial f(x).\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-1.3.5",
        "lean_tag": [
            "FCA_chap_D_1_3_5"
        ],
        "lean_formalization": "lemma FCA_chap_D_1_3_5 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x d : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f)\n  (hf_subdiff : Set.Nonempty (SubdifferentialI (liftRealtoEReal f) x)) :\n  let S := sublevelSetFun (liftRealtoEReal f) x\n  (IsNormalTo S x d) ‚Üî\n  (‚àÉ (t : ‚Ñù) (s : EuclideanSpace ‚Ñù (Fin n)),\n  (t ‚â• 0) ‚àß (s ‚àà SubdifferentialI (liftRealtoEReal f) x) ‚àß (d = t ‚Ä¢ s)) := by\n  sorry",
        "proof": "Write (1.3.7) as\n\\[\nT_{S f(x)}(x)=\\{d\\in\\mathbb{R}^n:\\langle s,d\\rangle\\le 0\\ \\text{for all }s\\in\\partial f(x)\\}\n=\\{d\\in\\mathbb{R}^n:\\langle \\lambda s,d\\rangle\\le 0\\ \\text{for all }\\lambda\\ge 0\\ \\text{and }s\\in\\partial f(x)\\}=[\\mathbb{R}^+\\partial f(x)]^\\circ.\n\\]\nThe result follows by taking the polar cone of both sides, and observing that the assumption implies closedness of $\\mathbb{R}^+\\partial f(x)$ (Proposition A.1.4.7):\n\\[\nN_{S f(x)}(x)=\\operatorname{cl}[\\mathbb{R}^+\\partial f(x)]=\\mathbb{R}^+\\partial f(x).\n\\]"
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}$ be convex and $x\\in\\mathbb{R}^n$. For any $\\varepsilon>0$, there exists $\\delta>0$ such that $\\|h\\|\\le\\delta$ implies\n\\[\n\\big|f(x+h)-f(x)-f'(x,h)\\big|\\le\\varepsilon\\|h\\|.\n\\tag{2.1.1}\n\\]",
        "title": "",
        "label": "lem:FCA-chapD-2.1.1",
        "lean_tag": [
            "FCA_chap_D_2_1_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_2_1_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  let f'_ereal := fun (d : EuclideanSpace ‚Ñù (Fin n)) => directionalDeriv (liftRealtoEReal f) x d\n  let f'_real := fun (d : EuclideanSpace ‚Ñù (Fin n)) => realDirectionalDeriv f x d\n  (‚àÄ x, f'_ereal x = f'_real x) ‚àß\n  (‚àÄ (Œµ : ‚Ñù), (Œµ > 0) ‚Üí ‚àÉ Œ¥ > 0,\n  ‚àÄ (h : EuclideanSpace ‚Ñù (Fin n)), ‚Äñh‚Äñ ‚â§ Œ¥ ‚Üí\n  abs (f (x + h) - f x - realDirectionalDeriv f x h) ‚â§ Œµ ‚Ä¢ ‚Äñh‚Äñ) := by\n  sorry",
        "proof": "Suppose for contradiction that there is $\\varepsilon>0$ and a sequence $(h_k)$ with $\\|h_k\\|=:t_k\\le 1/k$ such that\n\n\\[\n|f(x+h_k)-f(x)-f'(x,h_k)|>\\varepsilon t_k\\qquad\\text{for }k=1,2,\\dots\n\\]\n\nExtracting a subsequence if necessary, assume that $h_k/t_k\\to d$ for some $d$ of norm $1$. Then take a local Lipschitz constant $L$ of $f$ (see Remark 1.1.3) and expand:\n\\[\n\\varepsilon t_k<|f(x+h_k)-f(x)-f'(x,h_k)|\n\\le |f(x+h_k)-f(x+t_kd)|+\n\\]\n\\[\n\\quad +|f(x+t_kd)-f(x)-f'(x,t_kd)|+|f'(x,t_kd)-f'(x,h_k)|\n\\]\n\\[\n\\le 2L\\|h_k-t_kd\\|+|f(x+t_kd)-f(x)-t_kf'(x,d)|.\n\\]\n\nDivide by $t_k>0$ and pass to the limit to obtain the contradiction $\\varepsilon\\le 0$."
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}$ be convex. At any $x$,\n\\[\nf(x+h)=f(x)+\\langle s,h\\rangle+o(\\|h\\|)\n\\]\nwhenever one of the following equivalent properties holds:\n\\[\ns\\in\\partial f(x)(h)\\iff h\\in N_{\\partial f(x)}(s)\\iff s=p_{\\partial f(x)}(s+h).\n\\]",
        "title": "",
        "label": "cor:FCA-chapD-2.1.3",
        "lean_tag": [
            "FCA_chap_D_2_1_3"
        ],
        "lean_formalization": "lemma FCA_chap_D_2_1_3 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (s h : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  (‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)), (h ‚àà normalConeAt (SubdifferentialI (liftRealtoEReal f) x) s) ‚Üí\n  Asymptotics.IsLittleO (ùìù 0) (fun h => f (x + h) - f x - inner ‚Ñù s h) (fun h => ‚Äñh‚Äñ)) ‚àß\n  (‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)), (s ‚àà ExposedFace (SubdifferentialI (liftRealtoEReal f) x) h) ‚Üí\n  Asymptotics.IsLittleO (ùìù 0) (fun h => f (x + h) - f x - inner ‚Ñù s h) (fun h => ‚Äñh‚Äñ)) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}$ be convex. For all $x$ and $d$ in $\\mathbb{R}^n$, we have\n\\[\nF_{\\partial f(x)}(d)=\\partial[f'(x,\\cdot)](d).\n\\]",
        "title": "",
        "label": "prop:FCA-chapD-2.1.5",
        "lean_tag": [
            "FCA_chap_D_2_1_5"
        ],
        "lean_formalization": "lemma FCA_chap_D_2_1_5 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x d : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  let f' := fun (d : EuclideanSpace ‚Ñù (Fin n)) => directionalDeriv (liftRealtoEReal f) x d\n  SubdifferentialI f' d = ExposedFace (SubdifferentialI (liftRealtoEReal f) x) d := by\n  sorry",
        "proof": "If $s\\in\\partial f(x)$ then $f'(x,d')\\ge\\langle s,d'\\rangle$ for all $d'\\in\\mathbb{R}^n$, simply because $f'(x,\\cdot)$ is the support function of $\\partial f(x)$. If, in addition, $\\langle s,d\\rangle=f'(x,d)$, we get\n\\[\nf'(x,d')\\ge f'(x,d)+\\langle s,d'-d\\rangle\\qquad\\text{for all }d'\\in\\mathbb{R}^n\n\\tag{2.1.4}\n\\]\nwhich proves the inclusion $F_{\\partial f(x)}(d)\\subset\\partial[f'(x,\\cdot)](d)$.\n\nConversely, let $s$ satisfy (2.1.4). Set $d'':=d'-d$ and deduce from subadditivity\n\\[\nf'(x,d)+f'(x,d'')\\ge f'(x,d')\\ge f'(x,d)+\\langle s,d''\\rangle\\qquad\\text{for all }d''\\in\\mathbb{R}^n\n\\]\nwhich implies $f'(x,\\cdot)\\ge\\langle s,\\cdot\\rangle$, hence $s\\in\\partial f(x)$. Also, putting $d'=0$ in (2.1.4) shows that $\\langle s,d\\rangle\\ge f'(x,d)$. Altogether, we have $s\\in F_{\\partial f(x)}(d)$. \\qedhere"
    },
    {
        "statement": "For $f:\\mathbb{R}^n\\to\\mathbb{R}$ convex, the following three properties are equivalent:\n\\begin{enumerate}\n\\item[(i)] $f$ is minimized at $x$ over $\\mathbb{R}^n$, i.e., $f(y)\\ge f(x)$ for all $y\\in\\mathbb{R}^n$;\n\\item[(ii)] $0\\in\\partial f(x)$;\n\\item[(iii)] $f'(x,d)\\ge 0$ for all $d\\in\\mathbb{R}^n$.\n\\end{enumerate}",
        "title": "",
        "label": "thm:FCA-chapD-2.2.1",
        "lean_tag": [
            "FCA_chap_D_2_2_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_2_2_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  List.TFAE [\n    ‚àÄ (y : EuclideanSpace ‚Ñù (Fin n)), f y ‚â• f x,\n    0 ‚àà SubdifferentialI (liftRealtoEReal f) x,\n    ‚àÄ (d : EuclideanSpace ‚Ñù (Fin n)), directionalDeriv (liftRealtoEReal f) x d ‚â• 0\n  ] := by\n  sorry",
        "proof": "The equivalence (i) $\\Leftrightarrow$ (ii) [resp.\\ (ii) $\\Leftrightarrow$ (iii)] is obvious from (1.2.1) [resp.\\ (1.1.6)]."
    },
    {
        "statement": "The subdifferential of $\\varphi$ defined by (2.3.1) is\n\\[\n\\partial\\varphi(t)=\\{\\;s,y-x\\;:\\;s\\in\\partial f(x_t)\\;\\}\n\\]\nor, more symbolically:\n\\[\n\\partial\\varphi(t)=\\langle\\partial f(x_t),\\,y-x\\rangle.\n\\]",
        "title": "",
        "label": "lem:FCA-chapD-2.3.1",
        "lean_tag": [
            "FCA_chap_D_2_3_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_2_3_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x y : EuclideanSpace ‚Ñù (Fin n)) (t : ‚Ñù)\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) (ht : 0 ‚â§ t ‚àß t ‚â§ 1):\n  let xt := t ‚Ä¢ y + (1 - t) ‚Ä¢ x\n  let phi := fun (v : EuclideanSpace ‚Ñù (Fin 1)) => f xt\n  let t_asvec := fun _ => t\n  -- work in ‚Ñù, rather than EuclideanSpace ‚Ñù (Fin n)\n  let subdiff := {v : ‚Ñù | ‚àÉ v' ‚àà SubdifferentialI (liftRealtoEReal phi) t_asvec, v' 0 = v}\n  subdiff = {z : ‚Ñù | ‚àÉ s ‚àà (SubdifferentialI (liftRealtoEReal f) xt), z = inner ‚Ñù s (y - x)} := by\n  sorry",
        "proof": "In terms of right- and left-derivatives (see Theorem 0.6.3), we have\n\\[\nD_{+}\\varphi(t)=\\lim_{\\tau\\downarrow 0}\\frac{f(x_t+\\tau(y-x))-f(x_t)}{\\tau}=f'(x_t,y-x),\n\\]\n\\[\nD_{-}\\varphi(t)=\\lim_{\\tau\\uparrow 0}\\frac{f(x_t+\\tau(y-x))-f(x_t)}{\\tau}=-f'(x_t,-(y-x));\n\\]\nso, knowing that\n\\[\nf'(x_t,y-x)=\\max_{s\\in\\partial f(x_t)}\\langle s,y-x\\rangle,\n\\]\n\\[\n-\\,f'(x_t,-(y-x))=\\min_{s\\in\\partial f(x_t)}\\langle s,y-x\\rangle,\n\\]\nwe obtain \\(\\partial\\varphi(t):=[D_{-}\\varphi(t),D_{+}\\varphi(t)]=\\{\\langle s,y-x\\rangle : s\\in\\partial f(x)\\}.\\)"
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}$ be convex. Given two points $x\\neq y$ in $\\mathbb{R}^n$, there exist $t\\in ]0,1[$ and $s\\in\\partial f(x_t)$ such that\n\\[\nf(y)-f(x)=\\langle s,\\,y-x\\rangle.\n\\tag{2.3.2}\n\\]\nIn other words,\n\\[\nf(y)-f(x)\\in\\bigcup_{t\\in]0,1[}\\{\\langle\\partial f(x_t),\\,y-x\\rangle\\}.\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-2.3.3",
        "lean_tag": [
            "FCA_chap_D_2_3_3"
        ],
        "lean_formalization": "lemma FCA_chap_D_2_3_3 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x y : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) (hxy : x ‚â† y) :\n  ‚àÉ t ‚àà Set.Ioo 0 1, ‚àÉ s ‚àà SubdifferentialI (liftRealtoEReal f) (t ‚Ä¢ y + (1 - t) ‚Ä¢ x),\n  f y - f x = inner ‚Ñù s (y - x) := by\n  sorry",
        "proof": "Start from the function $\\varphi$ of (2.3.1) and, as usual in this context, consider the auxiliary function\n\\[\n\\psi(t):=\\varphi(t)-\\varphi(0)-t[\\varphi(1)-\\varphi(0)],\n\\]\nwhich is clearly convex. Computing directional derivatives gives easily $\\partial\\psi(t)=\\partial\\varphi(t)-[\\varphi(1)-\\varphi(0)]$. Now $\\psi$ is continuous on $[0,1]$, it has been constructed so that $\\psi(0)=\\psi(1)=0$, so it is minimal at some $t\\in ]0,1[$: at this $t$, $0\\in\\partial\\psi(t)$ (Theorem 2.2.1). In view of Lemma 2.3.1, this means that there is $s\\in\\partial f(x_t)$ such that\n\\[\n\\langle s,\\,y-x\\rangle=\\varphi(1)-\\varphi(0)=f(y)-f(x).\n\\]"
    },
    {
        "statement": "Let $f_1,f_2$ be two convex functions from $\\mathbb{R}^n$ to $\\mathbb{R}$ and $t_1,t_2$ be positive. Then\n\\[\n\\partial (t_1 f_1 + t_2 f_2)(x) = t_1\\partial f_1(x) + t_2\\partial f_2(x)\n\\qquad\\text{for all }x\\in\\mathbb{R}^n.\n\\tag{4.1.1}\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-4.1.1",
        "lean_tag": [
            "FCA_chap_D_4_1_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_1_1 {n : ‚Ñï}\n  (f‚ÇÅ f‚ÇÇ : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (t‚ÇÅ t‚ÇÇ : ‚Ñù)\n  (hf_convex : ConvexOn ‚Ñù Set.univ f‚ÇÅ ‚àß ConvexOn ‚Ñù Set.univ f‚ÇÇ)\n  (ht : t‚ÇÅ > 0 ‚àß t‚ÇÇ > 0) :\n  ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)),\n  SubdifferentialI (fun x => t‚ÇÅ ‚Ä¢ (f‚ÇÅ x) + t‚ÇÇ ‚Ä¢ (f‚ÇÇ x)) x =\n  {v | ‚àÉ v‚ÇÅ ‚àà (SubdifferentialI (liftRealtoEReal f‚ÇÅ) x), ‚àÉ v‚ÇÇ ‚àà (SubdifferentialI (liftRealtoEReal f‚ÇÇ) x),\n       v = t‚ÇÅ ‚Ä¢ v‚ÇÅ + t‚ÇÇ ‚Ä¢ v‚ÇÇ} := by\n  sorry",
        "proof": "Apply Theorem C.3.3.2(i): $t_1\\partial f_1(x)+t_2\\partial f_2(x)$ is a compact convex set whose support function is\n\\[\nt_1 f_1'(x,\\cdot) + t_2 f_2'(x,\\cdot).\n\\tag{4.1.2}\n\\]\nOn the other hand, the support function of $\\partial (t_1 f_1 + t_2 f_2)(x)$ is by definition the directional derivative $(t_1 f_1 + t_2 f_2)'(x,\\cdot)$ which, from elementary calculus, is just (4.1.2). Therefore the two (compact convex) sets in (4.1.1) coincide, since they have the same support function."
    },
    {
        "statement": "Let $A:\\mathbb{R}^n\\to\\mathbb{R}^m$ be an affine mapping ( $Ax = A_0x + b$, with $A_0$ linear and $b\\in\\mathbb{R}^m$) and let $g$ be a finite convex function on $\\mathbb{R}^m$. Then\n\\[\n\\partial (g\\circ A)(x)=A_0^*\\partial g(Ax)\\qquad\\text{for all }x\\in\\mathbb{R}^n.\n\\tag{4.2.1}\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-4.2.1",
        "lean_tag": [
            "FCA_chap_D_4_2_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_2_1 {n m : ‚Ñï}\n  (g : EuclideanSpace ‚Ñù (Fin m) ‚Üí ‚Ñù)\n  (A‚ÇÄ : EuclideanSpace ‚Ñù (Fin n) ‚Üí‚Çó[‚Ñù] EuclideanSpace ‚Ñù (Fin m))\n  (b : EuclideanSpace ‚Ñù (Fin m))\n  (hf_convex : ConvexOn ‚Ñù Set.univ g) :\n  ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)),\n  (SubdifferentialI (fun v => g (A‚ÇÄ v + b)) x) = Set.image A‚ÇÄ.adjoint (SubdifferentialI (liftRealtoEReal g) (A‚ÇÄ x + b)) := by\n  sorry",
        "proof": "Form the difference quotient giving rise to $(g\\circ A)'(x,d)$ and use the relation $A(x+td)=Ax+tA_0d$ to obtain\n\\[\n(g\\circ A)'(x,d)=g'(Ax,A_0d)\\qquad\\text{for all }d\\in\\mathbb{R}^n.\n\\]\nFrom Proposition C.3.3.3, the righthand side in the above equality is the support function of the convex compact set $A_0^*\\partial g(Ax)$. \\qedhere"
    },
    {
        "statement": "Let $f$, $F$ and $g$ be defined as above. For all $x\\in\\mathbb{R}^n$,\n\\[\n\\partial (g\\circ F)(x)=\\big\\{\\sum_{i=1}^m \\rho^i s_i :\\; (\\rho^1,\\dots,\\rho^m)\\in\\partial g(F(x)),\n\\; s_i\\in\\partial f_i(x)\\ \\text{ for } i=1,\\dots,m\\big\\}.\n\\tag{4.3.1}\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-4.3.1",
        "lean_tag": [
            "FCA_chap_D_4_3_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_3_1 {n m : ‚Ñï}\n  (f : ‚Ñï ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù))\n  (g : EuclideanSpace ‚Ñù (Fin m) ‚Üí ‚Ñù)\n  (hf_convex : ‚àÄ i ‚àà Finset.range m, ConvexOn ‚Ñù Set.univ (f i))\n  (hg_convex : ConvexOn ‚Ñù Set.univ g)\n  (hg_increasing : ‚àÄ y z, (‚àÄ i, y i ‚â• z i) ‚Üí g y ‚â• g z) :\n  let F : (EuclideanSpace ‚Ñù (Fin n)) ‚Üí EuclideanSpace ‚Ñù (Fin m) :=\n          fun x => (fun i => (f i) x)\n  ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)),\n  SubdifferentialI (liftRealtoEReal (g ‚àò F)) x =\n  {v | ‚àÉ œÅ ‚àà SubdifferentialI (liftRealtoEReal g) (F x), ‚àÉ (s : ‚Ñï ‚Üí EuclideanSpace ‚Ñù (Fin n)),\n       (‚àÄ i ‚àà Finset.range m, s i ‚àà SubdifferentialI (liftRealtoEReal (f i)) x) ‚àß\n       (v = ‚àë i : Fin m, (œÅ i) ‚Ä¢ (s i))} := by\n  sorry",
        "proof": "[Preamble] Our aim is to show the formula via support functions, hence we need to establish the convexity and compactness of the righthand side in (4.3.1) -- call it $S$. Boundedness and closedness are easy, coming from the fact that a subdifferential (be it $\\partial g$ or $\\partial f_i$) is bounded and closed. As for convexity, pick two points in $S$ and form their convex combination\n\\[\ns=\\alpha\\sum_{i=1}^m \\rho^i s_i + (1-\\alpha)\\sum_{i=1}^m \\rho^{\\prime i} s_i' =\n\\sum_{i=1}^m\\big[\\alpha\\rho^i s_i + (1-\\alpha)\\rho^{\\prime i}s_i'\\big],\n\\]\nwhere $\\alpha\\in[0,1]$. Remember that each $\\rho^i$ and $\\rho^{\\prime i}$ is nonnegative and the above sum can be restricted to those terms such that $\\rho^{\\prime\\prime i}:=\\alpha\\rho^i+(1-\\alpha)\\rho^{\\prime i}>0$. Then we write each such term as\n\\[\n\\rho^{\\prime\\prime i}\\big[\\frac{\\alpha\\rho^i}{\\rho^{\\prime\\prime i}} s_i +\n\\frac{(1-\\alpha)\\rho^{\\prime i}}{\\rho^{\\prime\\prime i}} s_i'\\big].\n\\]\nIt suffices to observe that $\\rho^{\\prime\\prime i}\\in\\partial g(F(x))$, so the bracketed expression is in $\\partial f_i(x)$; thus $s\\in S$.\n\n[Step 1] Now let us compute the support function $\\sigma_S$ of $S$. For $d\\in\\mathbb{R}^n$, we denote by $F'(x,d)\\in\\mathbb{R}^m$ the vector whose components are $f_i'(x,d)$ and we proceed to prove\n\\[\n\\sigma_S(d)=g' (F(x),F'(x,d)).\n\\tag{4.3.2}\n\\]\nFor any $s=\\sum_{i=1}^m \\rho^i s_i\\in S$, we write $\\langle s,d\\rangle$ as\n\\[\n\\sum_{i=1}^m \\rho^i\\langle s_i,d\\rangle \\le\n\\sum_{i=1}^m \\rho^i f_i'(x,d) \\le g'(F(x),F'(x,d)) ;\n\\tag{4.3.3}\n\\]\nthe first inequality uses $\\rho^i\\ge 0$ and the definition of $f_i'(x,\\cdot)=\\sigma_{\\partial f_i}(x)$; the second uses the definition $g'(F(x),\\cdot)=\\sigma_{\\partial g(F(x))}$.\n\nOn the other hand, the compactness of $\\partial g(F(x))$ implies the existence of an $m$-tuple $(\\bar\\rho^i)\\in\\partial g(F(x))$ such that\n\\[\ng'(F(x),F'(x,d))=\\sum_{i=1}^m\\bar{\\rho}^i f_i'(x,d),\n\\]\nand the compactness of each $\\partial f_i(x)$ yields likewise an $\\bar{s}_i\\in\\partial f_i(x)$ such that\n\\[\nf_i'(x,d)=\\langle\\bar{s}_i,d\\rangle\\quad\\text{for }i=1,\\dots,m.\n\\]\n\nAltogether, we have exhibited an $\\bar{s}=\\sum_{i=1}^m\\bar{\\rho}^i\\bar{s}_i\\in S$ such that equality holds in (4.3.3), so (4.3.2) is established.\n\n[Step 2] It remains to prove that the support function (4.3.2) is really the directional derivative $(g\\circ F)'(x,d)$. For $t>0$, expand $F(x+td)$, use the fact that $g$ is locally Lipschitzian, and then expand $g(F(x+td))$:\n\\[\ng(F(x+td))=g(F(x)+tF'(x,d)+o(t))=g(F(x)+tF'(x,d))+o(t)\n= g(F(x))+tg'(F(x),F'(x,d))+o(t).\n\\]\n\nFrom there, it follows\n\\[\n(g\\circ F)'(x,d):=\\lim_{t\\downarrow 0}\\frac{g(F(x+td))-g(F(x))}{t}=g'(F(x),F'(x,d)).\n\\quad\\square\n\\]"
    },
    {
        "statement": "Let $f_1,\\dots,f_m$ be $m$ convex functions from $\\mathbb{R}^n$ to $\\mathbb{R}$ and define\n\\[\nf := \\max\\{f_1,\\dots,f_m\\}.\n\\]\nDenoting by $I(x) := \\{i : f_i(x) = f(x)\\}$ the active index-set, we have\n\\[\n\\partial f(x) = \\operatorname{co}\\{\\bigcup_{i\\in I(x)}\\partial f_i(x)\\}.\n\\tag{4.3.4}\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-4.3.2",
        "lean_tag": [
            "FCA_chap_D_4_3_2"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_3_2 {n m : ‚Ñï}\n  (f : ‚Ñï ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ‚àÄ i ‚àà Finset.range m, ConvexOn ‚Ñù Set.univ (f i)) :\n  let F : (EuclideanSpace ‚Ñù (Fin n)) ‚Üí ‚Ñù := fun x => sSup (‚ãÉ i ‚àà Finset.range m, {(f i) x})\n  let I := {i | (f i) x = F x}\n  SubdifferentialI (liftRealtoEReal F) x = convexHull ‚Ñù (‚ãÉ i ‚àà I, SubdifferentialI (liftRealtoEReal (f i)) x):= by\n  sorry",
        "proof": "Take \\(g(y)=\\max\\{y^{1},\\dots,y^{m}\\}\\), whose subdifferential was computed in (3.7): \\(\\{e_{i}\\}\\) denoting the canonical basis of \\(\\mathbb{R}^{m}\\),\n\\[\n\\partial g(y)=\\operatorname{co}\\{e_{i} : i\\ \\text{such that}\\ y^{i}=g(y)\\}.\n\\]\nThen, using the notation of Theorem 4.3.1, we write \\(\\partial g(F(x))\\) as\n\\[\n\\left\\{(\\rho^{1},\\dots,\\rho^{m}):\\ \\rho^{i}=0\\ \\text{for}\\ i\\notin I(x),\\ \\rho^{i}\\ge 0\\ \\text{for}\\ i\\in I(x),\\ \\sum_{i=1}^{m}\\rho^{i}=1\\right\\},\n\\]\nand (4.3.1) gives\n\\[\n\\partial f(x)=\\left\\{\\sum_{i\\in I(x)}\\rho^{i}\\partial f_{i}(x):\\ \\rho^{i}\\ge 0\\ \\text{for}\\ i\\in I(x),\\ \\sum_{i\\in I(x)}\\rho^{i}=1\\right\\}.\n\\]\nRemembering Example A.1.3.5, it suffices to recognize in the above expression the convex hull announced in (4.3.4)."
    },
    {
        "statement": "With the notation (4.4.1), (4.4.2),\n\\[\n\\partial f(x)\\supset\\operatorname{co}\\{\\partial f_j(x):\\; j\\in J(x)\\}.\n\\tag{4.4.3}\n\\]",
        "title": "",
        "label": "lem:FCA-chapD-4.4.1",
        "lean_tag": [
            "FCA_chap_D_4_4_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_4_1 {n : ‚Ñï} {J : Type*}\n  (f : J ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ‚àÄ (i : J), ConvexOn ‚Ñù Set.univ (f i))\n  (hf_finite : ‚àÄ z, ‚®Ü (j : J), (f j z : WithTop ‚Ñù) < ‚ä§) :\n  let F : (EuclideanSpace ‚Ñù (Fin n)) ‚Üí EReal := fun z => ‚®Ü (j : J), (f j z)\n  let Jx := {j | f j x = F x}\n  closure (convexHull ‚Ñù (‚ãÉ j ‚àà Jx, SubdifferentialI (liftRealtoEReal (f j)) x)) ‚äÜ\n  SubdifferentialI F x := by\n  sorry",
        "proof": "Take $j\\in J(x)$ and $s\\in\\partial f_j(x)$; from the definition (1.2.1) of the subdifferential,\n\\[\nf(y)\\ge f_j(y)\\ge f_j(x)+\\langle s,y-x\\rangle\\qquad\\text{for all }y\\in\\mathbb R^n,\n\\]\nso $\\partial f(x)$ contains $\\partial f_j(x)$. Being closed and convex, it also contains the closed convex hull appearing in (4.4.3)."
    },
    {
        "statement": "With the notation (4.4.1), (4.4.2), assume that $J$ is a compact set (in some metric space), on which the functions $j\\mapsto f_j(x)$ are upper semi-continuous for each $x\\in\\mathbb{R}^n$. Then\n\\[\n\\partial f(x)=\\operatorname{co}\\{\\cup\\partial f_j(x):\\; j\\in J(x)\\}.\n\\tag{4.4.4}\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-4.4.2",
        "lean_tag": [
            "FCA_chap_D_4_4_2"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_4_2 {n : ‚Ñï} {J : Type*} [TopologicalSpace J] [CompactSpace J]\n  (f : J ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ‚àÄ (i : J), ConvexOn ‚Ñù Set.univ (f i))\n  (hf_finite : ‚àÄ z, ‚®Ü (j : J), (f j z : WithTop ‚Ñù) < ‚ä§)\n  (hf_usc : ‚àÄ (j : J), ‚àÄ z, lscAt (fun v => -1 ‚Ä¢ f j v) z) :\n  let F : (EuclideanSpace ‚Ñù (Fin n)) ‚Üí EReal := fun z => ‚®Ü (j : J), (f j z)\n  let Jx := {j | f j x = F x}\n  convexHull ‚Ñù (‚ãÉ j ‚àà Jx, SubdifferentialI (liftRealtoEReal (f j)) x) =\n  SubdifferentialI F x := by\n  sorry",
        "proof": "[Step 0] Our assumptions make $J(x)$ nonempty and compact. Denote by $S$ the curly bracketed set in (4.4.4); because of (4.4.3), $S$ is bounded, let us check that it is closed. Take a sequence $(s_k)\\subset S$ converging to $s$; to each $s_k$, we associate some $j_k\\in J(x)$ such that $s_k\\in\\partial f_{j_k}(x)$, i.e.\n\\[\nf_{j_k}(y)\\ge f_{j_k}(x)+\\langle s_k,y-x\\rangle\\qquad\\text{for all }y\\in\\mathbb{R}^n.\n\\]\nLet $k\\to\\infty$; extract a subsequence so that $j_k\\to j\\in J(x)$; we have $f_{j_k}(x)\\equiv f(x)=:f_j(x)$; and by upper semi-continuity of the function $f_{(\\cdot)}(y)$, we obtain\n\\[\nf_j(y)\\ge\\limsup f_{j_k}(y)\\ge f_j(x)+\\langle s,y-x\\rangle\\qquad\\text{for all }y\\in\\mathbb{R}^n,\n\\]\nwhich shows $s\\in\\partial f_j(x)\\subset S$. Altogether, $S$ is compact and its convex hull is also compact (Theorem A.1.4.3).\n\nIn view of Lemma 4.4.1, it suffices to prove the ``$\\subset$''-inclusion in (4.4.4); for this, we will establish the corresponding inequality between support functions which, in view of the calculus rule C.3.3.2(ii), is: for all $d\\in\\mathbb{R}^n$,\n\\[\nf'(x,d)\\le\\sigma_S(d)=\\sup\\{f_j'(x,d):\\; j\\in J(x)\\}.\n\\tag{4.4.5}\n\\]\n\n[Step 1] Let $\\varepsilon>0$; from the definition (1.1.2) of $f'(x,d)$,\n\\[\n\\frac{f(x+td)-f(x)}{t}>f'(x,d)-\\varepsilon\\qquad\\text{for all }t>0.\n\\tag{4.4.6}\n\\]\nFor $t>0$, set\n\\[\nJ_t:=\\Big\\{j\\in J:\\;\\frac{f_j(x+td)-f_j(x)}{t}\\ge f'(x,d)-\\varepsilon\\Big\\}.\n\\]\nThe definition of $f(x+td)$ shows with (4.4.6) that $J_t$ is nonempty. Because $J$ is compact and $f_{(\\cdot)}(x+td)$ is upper semi-continuous, $J_t$ is visibly compact. Observe that $J_t$ is a superlevel-set of the function\n\\[\n0<t\\mapsto\\frac{f_j(x+td)-f_j(x)}{t}+\\frac{f_j(x)-f(x)}{t},\n\\]\nwhich is nondecreasing: the first fraction is the slope of a convex function, and the second fraction has a nonpositive numerator. Thus, $J_{t_1}\\subset J_{t_2}$ for $0<t_1\\le t_2$.\n\n[Step 2] By compactness, we deduce the existence of some $j^*\\in\\bigcap_{t>0}J_t$ (for each $\\tau\\in ]0,t]$, pick some $j_\\tau\\in J_\\tau\\subset J_t$; take a cluster point for $\\tau\\downarrow 0$: it is in $J_t$). We therefore have\n\\[\nf_{j^*}(x+td)-f(x)\\ge t\\bigl[f'(x,d)-\\varepsilon\\bigr]\\qquad\\text{for all }t>0,\n\\]\nhence $j^*\\in J(x)$ (\\text{continuity of the convex function } $f_{j^*}$ for $t\\downarrow0$). In this inequality, we can replace $f(x)$ by $f_{j^*}(x)$, divide by $t$ and let $t\\downarrow0$ to obtain\n\\[\n\\sigma_S(d)\\ge f'_{j^*}(x,d)\\ge f'(x,d)-\\varepsilon.\n\\]\nSince $d\\in\\mathbb{R}^n$ and $\\varepsilon>0$ were arbitrary, (4.4.5) is established."
    },
    {
        "statement": "The notation and assumptions are those of Theorem 4.4.2. Assume also that each $f_j$ is differentiable; then\n\\[\n\\partial f(x)=\\operatorname{co}\\{\\nabla f_j(x):\\; j\\in J(x)\\}.\n\\]",
        "title": "",
        "label": "cor:FCA-chapD-4.4.4",
        "lean_tag": [
            "FCA_chap_D_4_4_4"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_4_4 {n : ‚Ñï} {J : Type*} [TopologicalSpace J] [CompactSpace J]\n  (f : J ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ‚àÄ (i : J), ConvexOn ‚Ñù Set.univ (f i))\n  (hf_finite : ‚àÄ z, ‚®Ü (j : J), (f j z : WithTop ‚Ñù) < ‚ä§)\n  (hf_usc : ‚àÄ (j : J), ‚àÄ z, lscAt (fun v => -1 ‚Ä¢ f j v) z)\n  (hf_differentiable : ‚àÄ (j : J), Differentiable ‚Ñù (f j)) :\n  let F : (EuclideanSpace ‚Ñù (Fin n)) ‚Üí EReal := fun z => ‚®Ü (j : J), (f j z)\n  let Jx := {j | f j x = F x}\n  SubdifferentialI F x = convexHull ‚Ñù (‚ãÉ j ‚àà Jx, {gradient (f j) x}) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "For some compact set $Y\\subset\\mathbb{R}^p$, let $g:\\mathbb{R}^n\\times Y\\to\\mathbb{R}$ be a function satisfying the following properties:\n\\begin{itemize}\n\\item[(i)] for each $x\\in\\mathbb{R}^n$, $g(x,\\cdot)$ is upper semi-continuous;\n\\item[(ii)] for each $y\\in Y$, $g(\\cdot,y)$ is convex and differentiable;\n\\item[(iii)] the function $f:=\\sup_{y\\in Y} g(\\cdot,y)$ is finite-valued on $\\mathbb{R}^n$;\n\\item[(iv)] at some $x\\in\\mathbb{R}^n$, $g(x,\\cdot)$ is maximized at a unique $y(x)\\in Y$.\n\\end{itemize}\nThen $f$ is differentiable at this $x$, and its gradient is\n\\[\n\\nabla f(x)=\\nabla_x g\\bigl(x,y(x)\\bigr)\n\\tag{4.4.8}\n\\]\n(where $\\nabla_x g(x,y)$ denotes the gradient of the function $g(\\cdot,y)$ at $x$).",
        "title": "",
        "label": "cor:FCA-chapD-4.4.5",
        "lean_tag": [
            "FCA_chap_D_4_4_5"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_4_5 {n p : ‚Ñï}\n  (Y : Set (EuclideanSpace ‚Ñù (Fin p)))\n  (g : EuclideanSpace ‚Ñù (Fin n) ‚Üí EuclideanSpace ‚Ñù (Fin p) ‚Üí ‚Ñù)\n  (x‚ÇÄ : EuclideanSpace ‚Ñù (Fin n))\n  (hf_usc : ‚àÄ x, ‚àÄ y, lscAt (fun v => -1 ‚Ä¢ (g x v)) y)\n  (hf_convex : ‚àÄ y ‚àà Y, ConvexOn ‚Ñù Set.univ (fun x => g x y))\n  (hf_differentiable : ‚àÄ y ‚àà Y, Differentiable ‚Ñù (fun x => g x y))\n  (hf_finite : ‚àÄ x, ‚®Ü y ‚àà Y, (g x y : WithTop ‚Ñù) < ‚ä§) :\n  let F : EuclideanSpace ‚Ñù (Fin n) ‚Üí EReal := fun x => ‚®Ü y ‚àà Y, (g x y : EReal)\n  ‚àÉ (F_finite : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù),\n  ‚àÉ! (y‚ÇÄ : EuclideanSpace ‚Ñù (Fin p)),\n  (‚àÄ x, F_finite x = F x) ‚àß\n  (y‚ÇÄ ‚àà Y) ‚àß\n  (IsMaxOn (fun y => g x‚ÇÄ y) Y y‚ÇÄ) ‚Üí\n  (Differentiable ‚Ñù F_finite) ‚àß\n  (gradient F_finite x‚ÇÄ = gradient (fun x => g x y‚ÇÄ) x‚ÇÄ) := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "With the notation (4.5.1), (4.5.2), assume $A$ is surjective. Let $x$ be such that $Y(x)$ is nonempty. Then, for arbitrary $y\\in Y(x)$,\n\\[\n\\partial(Ag)(x)=\\{\\,s\\in\\mathbb{R}^n:\\;A^*s\\in\\partial g(y)\\,\\}=\\bigl(A^*\\bigr)^{-1}[\\partial g(y)]\n\\tag{4.5.3}\n\\]\n(and this set is thus independent of the particular optimal $y$).",
        "title": "",
        "label": "thm:FCA-chapD-4.5.1",
        "lean_tag": [
            "FCA_chap_D_4_5_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_5_1 {m n : ‚Ñï}\n  (g : EuclideanSpace ‚Ñù (Fin m) ‚Üí ‚Ñù)\n  (A : EuclideanSpace ‚Ñù (Fin m) ‚Üí‚Çó[‚Ñù] EuclideanSpace ‚Ñù (Fin n))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hg_convex : ConvexOn ‚Ñù Set.univ g)\n  (hA_surjective : Function.Surjective A) :\n  let Ag := fun x => sInf (Set.image g {y | A y = x})\n  let Yx := {y | (A y = x) ‚àß (g y = Ag x)}\n  (Set.Nonempty Yx) ‚Üí ‚àÄ y ‚àà Yx,\n  (SubdifferentialI (liftRealtoEReal Ag) x =\n  {s | A.adjoint s ‚àà SubdifferentialI (liftRealtoEReal g) y}) ‚àß\n  (SubdifferentialI (liftRealtoEReal Ag) x =\n  Set.preimage A.adjoint (SubdifferentialI (liftRealtoEReal g) y)) := by\n  sorry",
        "proof": "By definition, $s\\in\\partial(Ag)(x)$ if and only if $(Ag)(x')\\ge(Ag)(x)+\\langle s,x'-x\\rangle$ for all $x'\\in\\mathbb{R}^n$, which can be rewritten\n\\[\n(Ag)(x')\\ge g(y)+\\langle s,x'-Ay\\rangle\\qquad\\text{for all }x'\\in\\mathbb{R}^n\n\\]\nwhere $y$ is arbitrary in $Y(x)$. Furthermore, because $A$ is surjective and by definition of $Ag$, this last relation is equivalent to\n\\[\ng(y')\\ge g(y)+\\langle s,Ay'-Ay\\rangle = g(y)+\\langle A^*s,y'-y\\rangle\\qquad\\text{for all }y'\\in\\mathbb{R}^m\n\\]\nwhich means that $A^*s\\in\\partial g(y)$."
    },
    {
        "statement": "Make the assumptions of Theorem 4.5.1. If $g$ is differentiable at some $y\\in Y(x)$, then $Ag$ is differentiable at $x$.",
        "title": "",
        "label": "cor:FCA-chapD-4.5.2",
        "lean_tag": [
            "FCA_chap_D_4_5_2"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_5_2 {m n : ‚Ñï}\n  (g : EuclideanSpace ‚Ñù (Fin m) ‚Üí ‚Ñù)\n  (A : EuclideanSpace ‚Ñù (Fin m) ‚Üí‚Çó[‚Ñù] EuclideanSpace ‚Ñù (Fin n))\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hg_convex : ConvexOn ‚Ñù Set.univ g)\n  (hA_surjective : Function.Surjective A) :\n  let Ag := fun x => sInf (Set.image g {y | A y = x})\n  let Yx := {y | (A y = x) ‚àß (g y = Ag x)}\n  (Set.Nonempty Yx) ‚Üí (‚àÉ y ‚àà Yx, DifferentiableAt ‚Ñù g y) ‚Üí\n  (DifferentiableAt ‚Ñù Ag x) := by\n  sorry",
        "proof": "Surjectivity of $A$ is equivalent to injectivity of $A^*$: in (4.5.3), we have an equation in $s$: $A^*s=\\nabla g(y)$, whose solution is unique, and is therefore $\\nabla(Ag)(x)$."
    },
    {
        "statement": "Let $f_1$ and $f_2:\\mathbb{R}^n\\to\\mathbb{R}$ be two convex functions minorized by a common affine function. For given $x$, let $(y_1,y_2)$ be such that the inf-convolution is exact at $x=y_1+y_2$, i.e.: $(f_1\\infconv f_2)(x)=f_1(y_1)+f_2(y_2)$. Then\n\\[\n\\partial(f_1\\infconv f_2)(x)=\\partial f_1(y_1)\\cap\\partial f_2(y_2).\n\\tag{4.5.6}\n\\]",
        "title": "",
        "label": "cor:FCA-chapD-4.5.5",
        "lean_tag": [
            "FCA_chap_D_4_5_5"
        ],
        "lean_formalization": "lemma FCA_chap_D_4_5_5 {n : ‚Ñï}\n  (f‚ÇÅ f‚ÇÇ : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (y‚ÇÅ y‚ÇÇ : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f‚ÇÅ ‚àß ConvexOn ‚Ñù Set.univ f‚ÇÇ)\n  (hf_minorized : ‚àÉ (s : EuclideanSpace ‚Ñù (Fin n)) (b : ‚Ñù),\n                 ‚àÄ x, (inner ‚Ñù s x + b ‚â§ f‚ÇÅ x) ‚àß (inner ‚Ñù s x + b ‚â§ f‚ÇÇ x)) :\n  let infconv := infimalConv (liftRealtoWT f‚ÇÅ) (liftRealtoWT f‚ÇÇ)\n  (infconv (y‚ÇÅ + y‚ÇÇ) = f‚ÇÅ y‚ÇÅ + f‚ÇÇ y‚ÇÇ) ‚Üí\n  SubdifferentialI infconv (y‚ÇÅ + y‚ÇÇ) =\n  (SubdifferentialI (liftRealtoEReal f‚ÇÅ) y‚ÇÅ) ‚à© (SubdifferentialI (liftRealtoEReal f‚ÇÇ) y‚ÇÇ) := by\n  sorry",
        "proof": "First observe that $A^*s=(s,s)$. Also, apply Definition 1.2.1 to see that $(s_1,s_2)\\in\\partial g(y_1,y_2)$ if and only if $s_1\\in\\partial f_1(y_1)$ and $s_2\\in\\partial f_2(y_2)$. Then (4.5.6) is just the copy of (4.5.3) in the present context."
    },
    {
        "statement": "The subdifferential mapping is monotone in the sense that, for all $x_1$ and $x_2$ in $\\mathbb{R}^n$,\n\\begin{equation}\\tag{6.1.1}\n\\langle s_2 - s_1, x_2 - x_1\\rangle \\ge 0\\quad\\text{for all } s_i\\in\\partial f(x_i),\\; i=1,2.\n\\end{equation}",
        "title": "",
        "label": "prop:FCA-chapD-6.1.1",
        "lean_tag": [
            "FCA_chap_D_6_1_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_1_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x‚ÇÅ x‚ÇÇ : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  ‚àÄ s‚ÇÅ ‚àà SubdifferentialI (liftRealtoEReal f) x‚ÇÅ, ‚àÄ s‚ÇÇ ‚àà SubdifferentialI (liftRealtoEReal f) x‚ÇÇ,\n  inner ‚Ñù (s‚ÇÇ - s‚ÇÅ) (x‚ÇÇ - x‚ÇÇ) ‚â• 0 := by\n  sorry",
        "proof": "The subgradient inequalities\n\\[\nf(x_2)\\ge f(x_1)+\\langle s_1, x_2-x_1\\rangle\\quad\\text{for all }s_1\\in\\partial f(x_1)\n\\]\n\\[\nf(x_1)\\ge f(x_2)+\\langle s_2, x_1-x_2\\rangle\\quad\\text{for all }s_2\\in\\partial f(x_2)\n\\]\ngive the result simply by addition."
    },
    {
        "statement": "A necessary and sufficient for a convex function $f:\\mathbb{R}^n\\to\\mathbb{R}$ to be strongly convex with modulus $c>0$ on a convex set $C$ is: for all $x_1,x_2$ in $C$,\n\\begin{equation}\\tag{6.1.3}\nf(x_2)\\ge f(x_1)+\\langle s,x_2-x_1\\rangle+\\frac{c}{2}\\|x_2-x_1\\|^2\\quad\\text{for all }s\\in\\partial f(x_1),\n\\end{equation}\nor equivalently\n\\begin{equation}\\tag{6.1.4}\n\\langle s_2-s_1,x_2-x_1\\rangle\\ge c\\|x_2-x_1\\|^2\\quad\\text{for all }s_i\\in\\partial f(x_i),\\; i=1,2.\n\\end{equation}",
        "title": "",
        "label": "thm:FCA-chapD-6.1.2",
        "lean_tag": [
            "FCA_chap_D_6_1_2"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_1_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (c : ‚Ñù)\n  (hC_convex : Convex ‚Ñù C) (hc : c > 0) :\n  StrongConvexOn C c f ‚Üî\n  ‚àÄ x‚ÇÅ ‚àà C, ‚àÄ x‚ÇÇ ‚àà C, ‚àÄ s ‚àà SubdifferentialI (liftRealtoEReal f) x‚ÇÅ,\n  f x‚ÇÇ ‚â• f x‚ÇÅ + inner ‚Ñù s (x‚ÇÇ - x‚ÇÅ) + (c / 2) * ‚Äñx‚ÇÇ - x‚ÇÅ‚Äñ^2 := by\n  sorry",
        "proof": "For $x_1,x_2$ given in $C$ and $\\alpha\\in]0,1[$, we will use the notation\n\\[\nx^\\alpha:=\\alpha x_2+(1-\\alpha)x_1=x_1+\\alpha(x_2-x_1)\n\\]\nand we will prove (6.1.3) $\\Rightarrow$ (6.1.2) $\\Rightarrow$ (6.1.4) $\\Rightarrow$ (6.1.3).\n\n[(6.1.3) $\\Rightarrow$ (6.1.2)] Write (6.1.3) with $x_1$ replaced by $x^\\alpha\\in C$: for $s\\in\\partial f(x^\\alpha)$,\n\\[\nf(x_2)\\ge f(x^\\alpha)+\\langle s,x_2-x^\\alpha\\rangle+\\frac{c}{2}\\|x_2-x^\\alpha\\|^2,\n\\]\nor equivalently\n\\[\nf(x_2)\\ge f(x^\\alpha)+(1-\\alpha)\\langle s,x_2-x_1\\rangle+\\frac{c}{2}(1-\\alpha)^2\\|x_2-x_1\\|^2.\n\\]\n\nLikewise,\n\\[\nf(x_1)\\ge f(x^\\alpha)+\\alpha\\langle s,x_1-x_2\\rangle+\\frac{c}{2}\\alpha^2\\|x_1-x_2\\|^2.\n\\]\n\nMultiply these last two inequalities by $\\alpha$ and $(1-\\alpha)$ respectively, and add to obtain\n\\[\n\\alpha f(x_2)+(1-\\alpha)f(x_1)\\ge f(x^\\alpha)+\\frac{c}{2}\\|x_2-x_1\\|^2\\big[\\alpha(1-\\alpha)^2+(1-\\alpha)\\alpha^2\\big].\n\\]\nThen realize after simplification that this is just (6.1.2).\n\n[(6.1.2) $\\Rightarrow$ (6.1.4)] Write (6.1.2) as\n\\[\n\\frac{f(x^\\alpha)-f(x_1)}{\\alpha}+\\frac{c}{2}(1-\\alpha)\\|x_2-x_1\\|^2\\le f(x_2)-f(x_1)\n\\]\nand let $\\alpha\\downarrow0$ to obtain $f'(x_1,x_2-x_1)+\\tfrac{c}{2}\\|x_2-x_1\\|^2\\le f(x_2)-f(x_1)$, which implies (6.1.3). Then, copying (6.1.3) with $x_1$ and $x_2$ interchanged and adding yields (6.1.4) directly.\n\n[(6.1.4) $\\Rightarrow$ (6.1.3)] Apply Theorem 2.3.4 to the one-dimensional convex function $\\mathbb{R}\\ni\\alpha\\mapsto\\varphi(\\alpha):=f(x^\\alpha)$:\n\\begin{equation}\\tag{6.1.5}\nf(x_2)-f(x_1)=\\varphi(1)-\\varphi(0)=\\int_0^1\\langle s^\\alpha,x_2-x_1\\rangle\\,d\\alpha\n\\end{equation}\nwhere $s^\\alpha\\in\\partial f(x^\\alpha)$ for $\\alpha\\in[0,1]$. Then take $s_1$ arbitrary in $\\partial f(x_1)$ and apply (6.1.4): $\\langle s^\\alpha-s_1,x^\\alpha-x_1\\rangle\\ge c\\|x^\\alpha-x_1\\|^2$ i.e., using the value of $x^\\alpha$,\n\\[\n\\alpha\\langle s^\\alpha,x_2-x_1\\rangle\\ge\\alpha\\langle s_1,x_2-x_1\\rangle+c\\alpha^2\\|x_2-x_1\\|^2.\n\\]\n\nThe result follows by using this inequality to minorize the integral in (6.1.5)."
    },
    {
        "statement": "A necessary and sufficient condition for a convex function $f:\\mathbb{R}^n\\to\\mathbb{R}$ to be strictly convex on a convex set $C$ is: for all $x_1,x_2\\in C$ with $x_2\\neq x_1$,\n\\[\nf(x_2)>f(x_1)+\\langle s,x_2-x_1\\rangle\\quad\\text{for all } s\\in\\partial f(x_1)\n\\]\nor equivalently\n\\[\n\\langle s_2-s_1,x_2-x_1\\rangle>0\\quad\\text{for all } s_i\\in\\partial f(x_i),\\ i=1,2.\n\\]",
        "title": "",
        "label": "prop:FCA-chapD-6.1.3",
        "lean_tag": [
            "FCA_chap_D_6_1_3"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_1_3 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (C : Set (EuclideanSpace ‚Ñù (Fin n)))\n  (hC_convex : Convex ‚Ñù C) :\n  StrictConvexOn ‚Ñù C f ‚Üî\n  ‚àÄ x‚ÇÅ ‚àà C, ‚àÄ x‚ÇÇ ‚àà C, (x‚ÇÅ ‚â† x‚ÇÇ) ‚Üí\n  ‚àÄ s ‚àà SubdifferentialI (liftRealtoEReal f) x‚ÇÅ,\n  f x‚ÇÇ > f x‚ÇÅ + inner ‚Ñù s (x‚ÇÇ - x‚ÇÅ) := by\n  sorry",
        "proof": "Copy the proof of Theorem 6.1.2 with $c=0$ and the relevant ``$ \\ge $''-signs replaced by strict inequalities. The only delicate point is in the [(6.1.2) $\\Rightarrow$ (6.1.4)]-stage: use monotonicity of the difference quotient."
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}$ be convex. The graph of its subdifferential mapping is closed in $\\mathbb{R}^n\\times\\mathbb{R}^n$.",
        "title": "",
        "label": "prop:FCA-chapD-6.2.1",
        "lean_tag": [
            "FCA_chap_D_6_2_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_2_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  let graph_subdiff := ‚ãÉ x, {z : EuclideanSpace ‚Ñù (Fin n) √ó EuclideanSpace ‚Ñù (Fin n) |\n                                  z.1 = x ‚àß z.2 ‚àà SubdifferentialI (liftRealtoEReal f) x}\n  IsClosed graph_subdiff := by\n  sorry",
        "proof": "Let $(x_k,s_k)$ be a sequence in $\\operatorname{gr}\\partial f$ converging to $(x,s)\\in\\mathbb{R}^n\\times\\mathbb{R}^n$. We must prove that $(x,s)\\in\\operatorname{gr}\\partial f$, which is easy. We have for all $k$\n\\[\nf(y)\\ge f(x_k)+\\langle s_k,y-x_k\\rangle\\quad\\text{for all }y\\in\\mathbb{R}^n;\n\\]\npass to the limit on $k$, using continuity of $f$ and of the scalar product."
    },
    {
        "statement": "The mapping $\\partial f$ is locally bounded, i.e.\\ the image $\\partial f(B)$ of a bounded set $B\\subset\\mathbb{R}^n$ is a bounded set in $\\mathbb{R}^n$.",
        "title": "",
        "label": "prop:FCA-chapD-6.2.2",
        "lean_tag": [
            "FCA_chap_D_6_2_2"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_2_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  let subdiff_im := fun (C : Set (EuclideanSpace ‚Ñù (Fin n))) =>\n                     {v | ‚àÉ x, v ‚àà SubdifferentialI (liftRealtoEReal f) x}\n  ‚àÄ (B : Set (EuclideanSpace ‚Ñù (Fin n))),\n  Bornology.IsBounded B ‚Üí Bornology.IsBounded (subdiff_im B) := by\n  sorry",
        "proof": "For arbitrary $x$ in $B$ and $s\\neq 0$ in $\\partial f(x)$, the subgradient inequality implies in particular $f(x+s/\\|s\\|)\\ge f(x)+\\|s\\|$. On the other hand, $f$ is Lipschitz-continuous on the bounded set $B+B(0,1)$ (Theorem B.3.1.2). Hence $\\|s\\|\\le L$ for some $L$."
    },
    {
        "statement": "The subdifferential mapping of a convex function $f:\\mathbb{R}^n\\to\\mathbb{R}$ is outer semi-continuous at any $x\\in\\mathbb{R}^n$, i.e.\n\\[\n\\forall\\varepsilon>0,\\ \\exists\\delta>0:\\quad y\\in B(x,\\delta)\\implies \\partial f(y)\\subset \\partial f(x)+B(0,\\varepsilon).\n\\tag{6.2.1}\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-6.2.4",
        "lean_tag": [
            "FCA_chap_D_6_2_4"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_2_4 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  let subdiff_neighborhood := fun (Œµ : ‚Ñù) =>\n                              {v | ‚àÉ w d,(‚Äñd‚Äñ ‚â§ Œµ) ‚àß (w ‚àà SubdifferentialI (liftRealtoEReal f) x) ‚àß (v = w + d)}\n  ‚àÄ Œµ > 0, ‚àÉ Œ¥ > 0, ‚àÄ y,\n  y ‚àà Metric.ball x Œ¥ ‚Üí SubdifferentialI (liftRealtoEReal f) y ‚äÜ subdiff_neighborhood Œµ := by\n  sorry",
        "proof": "Assume for contradiction that, at some $x$, there are $\\varepsilon>0$ and a sequence $(x_k,s_k)_k$ with\n\\[\nx_k\\to x\\quad\\text{for }k\\to\\infty\n\\qquad\\text{and}\\qquad\ns_k\\in\\partial f(x_k),\\ s_k\\not\\in\\partial f(x)+B(0,\\varepsilon)\\quad\\text{for }k=1,2,\\dots\n\\tag{6.2.2}\n\\]\nA subsequence of the bounded $(s_k)$ (Proposition 6.2.2) converges to $s\\in\\partial f(x)$ (Proposition 6.2.1). This contradicts (6.2.2), which implies $s\\not\\in\\partial f(x)+B(0,1/2\\varepsilon)$."
    },
    {
        "statement": "For $f:\\mathbb{R}^n\\to\\mathbb{R}$ convex, the function $f'(\\cdot,d)$ is upper semicontinuous: at all $x\\in\\mathbb{R}^n$,\n\\[\nf'(x,d)=\\limsup_{y\\to x} f'(y,d)\\qquad\\text{for all }d\\in\\mathbb{R}^n.\n\\]",
        "title": "",
        "label": "cor:FCA-chapD-6.2.5",
        "lean_tag": [
            "FCA_chap_D_6_2_5"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_2_5 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)),\n  ‚àÄ (d : EuclideanSpace ‚Ñù (Fin n)),\n  directionalDeriv (liftRealtoEReal f) x d =\n  Filter.limsup (fun y => directionalDeriv (liftRealtoEReal f) y d) (ùìù x):= by\n  sorry",
        "proof": "Use Theorem 6.2.4, in conjunction with Proposition C.3.3.7."
    },
    {
        "statement": "Let $(f_k)$ be a sequence of (finite) convex functions converging pointwise to $f:\\mathbb{R}^n\\to\\mathbb{R}$ and let $(x_k)$ converge to $x\\in\\mathbb{R}^n$. For any $\\varepsilon>0$,\n\\[\n\\partial f_k(x_k)\\subset\\partial f(x)+B(0,\\varepsilon)\\qquad\\text{for $k$ large enough.}\n\\]",
        "title": "",
        "label": "thm:FCA-chapD-6.2.7",
        "lean_tag": [
            "FCA_chap_D_6_2_7"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_2_7 {n : ‚Ñï}\n  (fk : ‚Ñï ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù))\n  (xk : ‚Ñï ‚Üí EuclideanSpace ‚Ñù (Fin n))\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : ‚àÄ i, ConvexOn ‚Ñù Set.univ (fk i))\n  (hf_pointwise : ‚àÄ v, Filter.Tendsto (fun k => fk k v) Filter.atTop (ùìù (f v)))\n  (hx_limit : Filter.Tendsto xk Filter.atTop (ùìù x)) :\n  let subdiff_neighborhood := fun (Œµ : ‚Ñù) =>\n                              {v | ‚àÉ w d,(‚Äñd‚Äñ ‚â§ Œµ) ‚àß (w ‚àà SubdifferentialI (liftRealtoEReal f) x) ‚àß (v = w + d)}\n  ‚àÄ Œµ > 0, ‚àÉ (K : ‚Ñï), ‚àÄ k ‚â• K,\n  SubdifferentialI (liftRealtoEReal (fk k)) (xk k) ‚äÜ subdiff_neighborhood Œµ:= by\n  sorry",
        "proof": "Let $\\varepsilon>0$ be given. Recall (Theorem B.3.1.4) that the pointwise convergence of $(f_k)$ to $f$ implies its uniform convergence on every compact set of $\\mathbb{R}^n$.\n\nFirst, we establish boundedness: for $s_k\\neq 0$ arbitrary in $\\partial f_k(x_k)$, we have\n\\[\nf_k(x_k+s_k/\\|s_k\\|)\\ge f_k(x_k)+\\|s_k\\|.\n\\]\n\nThe uniform convergence of $(f_k)$ to $f$ on $B(x,2)$ implies for $k$ large enough\n\\[\n\\|s_k\\|\\le f(x_k+s_k/\\|s_k\\|)-f(x_k)+\\varepsilon,\n\\]\nand the Lipschitz property of $f$ on $B(x,2)$ ensures that $(s_k)$ is bounded.\n\nNow suppose for contradiction that, for some infinite subsequence, there is some $s_k\\in\\partial f_k(x_k)$ which is not in $\\partial f(x)+B(0,\\varepsilon)$. Any cluster point of this $(s_k)$ --- and there is at least one --- is out of $\\partial f(x)+B(0,1/2\\varepsilon)$. Yet, with $y$ arbitrary in $\\mathbb{R}^n$, write\n\\[\nf_k(y)\\ge f_k(x_k)+\\langle s_k,y-x_k\\rangle\n\\]\nand pass to the limit (on a further subsequence such that $s_k\\to s$): pointwise [resp.\\ uniform] convergence of $(f_k)$ to $f$ at $y$ [resp.\\ around $x$], and continuity of the scalar product give $f(y)\\ge f(x)+\\langle s,y-x\\rangle$. Because $y$ was arbitrary, we obtain the contradiction $s\\in\\partial f(x)$."
    },
    {
        "statement": "Let $(f_k)$ be a sequence of (finite) differentiable convex functions converging pointwise to the differentiable $f:\\mathbb{R}^n\\to\\mathbb{R}$. Then $\\nabla f_k$ converges to $\\nabla f$ uniformly on every compact set of $\\mathbb{R}^n$.",
        "title": "",
        "label": "cor:FCA-chapD-6.2.8",
        "lean_tag": [
            "FCA_chap_D_6_2_8"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_2_8 {n : ‚Ñï}\n  (fk : ‚Ñï ‚Üí (EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù))\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (hf_convex : ‚àÄ i, ConvexOn ‚Ñù Set.univ (fk i))\n  (hf_seq_diff : ‚àÄ i, Differentiable ‚Ñù (fk i))\n  (hf_diff : Differentiable ‚Ñù f)\n  (hf_pointwise : ‚àÄ v, Filter.Tendsto (fun k => fk k v) Filter.atTop (ùìù (f v))) :\n  ‚àÄ (K : Set (EuclideanSpace ‚Ñù (Fin n))), IsCompact K ‚Üí\n  TendstoUniformlyOn (fun k => (fun x => gradient (fk k) x)) (fun x => gradient f x) Filter.atTop K := by\n  sorry",
        "proof": "Take $S$ compact; suppose for contradiction that there exists $\\varepsilon>0$ and a sequence $(x_k)\\subset S$ such that\n\\[\n\\|\\nabla f_k(x_k)-\\nabla f(x_k)\\|>\\varepsilon\\quad\\text{for }k=1,2,\\dots\n\\]\nExtracting a subsequence if necessary, we may suppose $x_k\\to x\\in S$; Theorem 6.2.7 assures that the sequences $(\\nabla f_k(x_k))$ and $(\\nabla f(x_k))$ both converge to $\\nabla f(x)$, implying $0\\ge\\varepsilon$."
    },
    {
        "statement": "Let $f:\\mathbb{R}^n\\to\\mathbb{R}$ be convex. With the notation (6.3.1), $\\partial f(x)=\\operatorname{co}\\gamma f(x)$ for all $x\\in\\mathbb{R}^n$.",
        "title": "",
        "label": "thm:FCA-chapD-6.3.1",
        "lean_tag": [
            "FCA_chap_D_6_3_1"
        ],
        "lean_formalization": "lemma FCA_chap_D_6_3_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí ‚Ñù)\n  (hf_convex : ConvexOn ‚Ñù Set.univ f) :\n  let delta_set := {y | SubdifferentialI (liftRealtoEReal f) y = {gradient f y}}\n  let lim_set := fun x => {s | ‚àÉ (yk : ‚Ñï ‚Üí EuclideanSpace ‚Ñù (Fin n)),\n                               (‚àÄ k, yk k ‚àà delta_set) ‚àß\n                               (Filter.Tendsto yk Filter.atTop (ùìù x)) ‚àß\n                               (Filter.Tendsto (fun k => gradient f (yk k)) Filter.atTop (ùìù s))}\n  ‚àÄ (x : EuclideanSpace ‚Ñù (Fin n)),\n  SubdifferentialI (liftRealtoEReal f) x = convexHull ‚Ñù (lim_set x) := by\n  sorry\n",
        "proof": ""
    },
    {
        "statement": "For $f$ satisfying (1.1.1), the conjugate $f^*$ is a closed convex function: $f^*\\in\\Conv\\mathbb{R}^n$.",
        "title": "",
        "label": "thm:FCA-chapE-1.1.2",
        "lean_tag": [
            "FCA_chap_E_1_1_2"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_1_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hf_nondegenerate : IsNondegenerate f) :\n  InClosedConvRn (Conjugate f) := by\n  sorry",
        "proof": "See Example B.2.1.3."
    },
    {
        "statement": "There holds for all $x\\in\\mathbb{R}^n$\n\\[\nf^*(s)=\\sigma_{\\mathrm{epi}\\,f}(s,-1)=\\sup\\{\\langle s,x\\rangle - r : (x,r)\\in\\mathrm{epi}\\,f\\}.\n\\tag{1.2.1}\n\\]\nIt follows that the support function of $\\mathrm{epi}\\,f$ has the expression\n\\[\n\\sigma_{\\mathrm{epi}\\,f}(s,-u)=\n\\begin{cases}\nu\\,f^*\\!\\bigl(\\tfrac{1}{u}s\\bigr) & \\text{if } u>0,\\\\[4pt]\n\\sigma_{\\mathrm{epi}\\,f}(s,0)=\\sigma_{\\mathrm{dom}\\,f}(s) & \\text{if } u=0,\\\\[4pt]\n+\\infty & \\text{if } u<0.\n\\end{cases}\n\\tag{1.2.2}\n\\]",
        "title": "",
        "label": "prop:FCA-chapE-1.2.1",
        "lean_tag": [
            "FCA_chap_E_1_2_1"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_2_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hf_nondegenerate : IsNondegenerate f) :\n  let f_conj := fun s => Conjugate f s\n  let f_epi_supportfun := fun (s : EuclideanSpace ‚Ñù (Fin n)) (u : ‚Ñù) =>\n  SupportFun {z | (vecHead z, vecLast z) ‚àà (epigraph (liftWithToptoEReal f))} (Fin.snoc s (-u))\n  let f_dom_supportfun := fun s => SupportFun {z | z ‚àà effDom (liftWithToptoEReal f)} s\n  (Conjugate f =\n  fun s => sSup {z : WithTop ‚Ñù | ‚àÉ (x : EuclideanSpace ‚Ñù (Fin n)) (r : ‚Ñù),\n  (z = (inner ‚Ñù s x) - r) ‚àß ((x, r) ‚àà epigraph (liftWithToptoEReal f))}) ‚àß\n  f_epi_supportfun = (fun s u =>\n    if u > 0 then u ‚Ä¢ f_conj (u‚Åª¬π ‚Ä¢ s)\n    else if u = 0 then f_dom_supportfun s\n    else ‚ä§\n  ) := by\n  sorry",
        "proof": "In (1.2.1), the right-most term can be written\n\\[\n\\sup_x\\;\\sup_{r\\ge f(x)}\\bigl[\\langle s,x\\rangle - r\\bigr]\n= \\sup_x\\bigl[\\langle s,x\\rangle - f(x)\\bigr]\n\\]\nand the first equality is established. As for (1.2.2), the case $u<0$ is trivial; when $u>0$, use the positive homogeneity of support functions to get\n\\[\n\\sigma_{\\operatorname{epi} f}(s,-u)=u\\sigma_{\\operatorname{epi} f}\\bigl(\\tfrac{1}{u}s,-1\\bigr)=u f^*\\bigl(\\tfrac{1}{u}s\\bigr).\n\\]\nFinally, for $u=0$, we have by definition\n\\[\n\\sigma_{\\operatorname{epi} f}(s,0)=\\sup\\{ \\langle s,x\\rangle : (x,r)\\in\\operatorname{epi} f\\text{ for some }r\\in\\mathbb{R}\\},\n\\]\nand we recognize $\\sigma_{\\operatorname{dom} f}(s)$."
    },
    {
        "statement": "For $f\\in\\operatorname{Conv}\\mathbb{R}^n$,\n\\[\n\\sigma_{\\operatorname{dom} f}(s)=\\sigma_{\\operatorname{epi} f}(s,0)=(f^*)^\\infty(s)\\quad\\text{for all }s\\in\\mathbb{R}^n.\n\\tag{1.2.3}\n\\]",
        "title": "",
        "label": "thm:FCA-chapE-1.2.2",
        "lean_tag": [
            "FCA_chap_E_1_2_2"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_2_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (x‚ÇÄ : EuclideanSpace ‚Ñù (Fin n))\n  (hf_nondegenerate : IsNondegenerate f) (hf_closed_convex : InClosedConvRn f)\n  (hx‚ÇÄ : f x‚ÇÄ ‚â† ‚ä§) :\n  let f_conj := fun s => Conjugate f s\n  let f_epi_supportfun := fun (s : EuclideanSpace ‚Ñù (Fin n)) (u : ‚Ñù) =>\n                               SupportFun {z | (vecHead z, vecLast z) ‚àà (epigraph (liftWithToptoEReal f))} (Fin.snoc s (-u))\n  let f_dom_supportfun := fun s => SupportFun {z | z ‚àà effDom (liftWithToptoEReal f)} s\n  let f_conj_asympfun := fun s => AsymptoticFun f_conj x‚ÇÄ s\n  ‚àÄ s, (f_epi_supportfun s 0 = f_dom_supportfun s) ‚àß (f_dom_supportfun s = f_conj_asympfun s) := by\n  sorry",
        "proof": "Use direct calculations; or see Proposition B.2.2.2 and the calculations in Example B.3.2.3."
    },
    {
        "statement": "The functions $f$, $f_j$ appearing below are assumed to satisfy (1.1.1).\n\\begin{enumerate}\n    \\item[(i)] The conjugate of the function $g(x):=f(x)+r$ is $g^*(s)=f^*(s)-r$.\n    \\item[(ii)] With $t>0$, the conjugate of the function $g(x):=tf(x)$ is $g^*(s)=t f^*(s/t)$.\n    \\item[(iii)] With $t\\neq0$, the conjugate of the function $g(x):=f(tx)$ is $g^*(s)=f^*(s/t)$.\n    \\item[(iv)] More generally: if $A$ is an invertible linear operator, $(f\\circ A)^*=f^*\\circ (A^{-1})^*$.\n    \\item[(v)] The conjugate of the function $g(x):=f(x-x_{0})$ is $g^{*}(s)=f^{*}(s)+\\langle s,x_{0}\\rangle$.\n    \\item[(vi)] The conjugate of the function $g(x):=f(x)+\\langle s_{0},x\\rangle$ is $g^{*}(s)=f^{*}(s-s_{0})$.\n    \\item[(vii)] If $f_{1}\\le f_{2}$, then $f_{1}^{*}\\ge f_{2}^{*}$.\n    \\item[(viii)] ``Convexity'' of the conjugation: if $\\mathrm{dom}\\,f_{1}\\cap\\mathrm{dom}\\,f_{2}\\neq\\varnothing$ and $\\alpha\\in]0,1[$,\n    \\[\n    [\\alpha f_{1}+(1-\\alpha)f_{2}]^{*}\\le \\alpha f_{1}^{*}+(1-\\alpha)f_{2}^{*};\n    \\]\n    \\item[(ix)] The Legendre-Fenchel transform preserves decomposition: with\n    \\[\n    \\mathbb{R}^{n}:=\\mathbb{R}^{n_{1}}\\times\\cdots\\times\\mathbb{R}^{n_{m}}\\ni x\\mapsto f(x):=\\sum_{j=1}^{m}f_{j}(x_{j})\n    \\]\n    and assuming that $\\mathbb{R}^{n}$ has the scalar product of a product-space, there holds\n    \\[\n    f^{*}(s_{1},\\dots,s_{m})=\\sum_{j=1}^{m}f_{j}^{*}(s_{j}) .\n    \\]\n\\end{enumerate}",
        "title": "",
        "label": "prop:FCA-chapE-1.3.1",
        "lean_tag": [
            "FCA_chap_E_1_3_1_i",
            "FCA_chap_E_1_3_1_ii",
            "FCA_chap_E_1_3_1_iii",
            "FCA_chap_E_1_3_1_iv",
            "FCA_chap_E_1_3_1_v",
            "FCA_chap_E_1_3_1_vi",
            "FCA_chap_E_1_3_1_vii",
            "FCA_chap_E_1_3_1_viii"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_3_1_i {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (r : ‚Ñù) (hf_nondegenerate : IsNondegenerate f) :\n  let g := fun x => f x + r\n  let f_conj := fun s => Conjugate f s\n  let g_conj := fun s => Conjugate g s\n  ‚àÄ s, g_conj s = f_conj s - r := by\n  sorry",
        "proof": ""
    },
    {
        "statement": "Let $f$ satisfy (1.1.1), let $H$ be a subspace of $\\mathbb{R}^n$, and call $p_H$ the operator of orthogonal projection onto $H$. Suppose that there is a point in $H$ where $f$ is finite. Then $f+p_{iH}$ satisfies (1.1.1) and its conjugate is\n\\[\n(f+p_{iH})^*=(f\\circ p_H)^*\\circ p_H .\n\\tag{1.3.1}\n\\]",
        "title": "",
        "label": "prop:FCA-chapE-1.3.2",
        "lean_tag": [
            "FCA_chap_E_1_3_2"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_3_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (H : Subspace ‚Ñù (EuclideanSpace ‚Ñù (Fin n)))\n  (hf_nondegenerate : IsNondegenerate f)\n  : let pH : EuclideanSpace ‚Ñù (Fin n) ‚Üí EuclideanSpace ‚Ñù (Fin n) := fun x => Submodule.orthogonalProjection H x\n    let g := fun x => f x + (Indicator H) x\n    ‚àÄ s, Conjugate g s = Conjugate (f ‚àò pH) (pH s)\n  := by sorry",
        "proof": "When $y$ describes $\\mathbb{R}^n$, $p_H y$ describes $H$ so we can write, knowing that $p_H$ is symmetric:\n\\[\n(f+p_{iH})^*(s):=\\sup\\{\\langle s,x\\rangle-f(x):x\\in H\\}\n=\\sup\\{\\langle s,p_H y\\rangle-f(p_H y):y\\in\\mathbb{R}^n\\}\n=\\sup\\{\\langle p_H s,y\\rangle-f(p_H y):y\\in\\mathbb{R}^n\\}.\n\\]"
    },
    {
        "statement": "For $f$ satisfying (1.1.1), let a subspace $V$ contain the subspace parallel to $\\operatorname{aff\\,dom}f$ and set $U:=V^{\\perp}$. For any $z\\in\\operatorname{aff\\,dom}f$ and any $s\\in\\mathbb{R}^{n}$ decomposed as $s=s_{U}+s_{V}$, there holds\n\\[\nf^{*}(s)=\\langle s_{U},z\\rangle+f^{*}(s_{V}).\n\\]",
        "title": "",
        "label": "prop:FCA-chapE-1.3.4",
        "lean_tag": [
            "FCA_chap_E_1_3_4"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_3_4 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (V : Subspace ‚Ñù (EuclideanSpace ‚Ñù (Fin n)))\n  (hf_nondegenerate : IsNondegenerate f) (hV_contains_affdom : affineSpan ‚Ñù (effDom (liftWithToptoEReal f)))\n  : let U := V·óÆ\n    let pV : EuclideanSpace ‚Ñù (Fin n) ‚Üí EuclideanSpace ‚Ñù (Fin n) := fun x => Submodule.orthogonalProjection V x\n    let pU : EuclideanSpace ‚Ñù (Fin n) ‚Üí EuclideanSpace ‚Ñù (Fin n) := fun x => Submodule.orthogonalProjection U x\n    ‚àÄ z ‚àà affineSpan ‚Ñù (effDom (liftWithToptoEReal f)), ‚àÄ s,\n    Conjugate f s = inner ‚Ñù (pU s) z + Conjugate f (pV s)\n  := by sorry",
        "proof": "In (1.1.2), the variable $x$ can range through $z+V\\supset\\operatorname{aff\\,dom}f$:\n\\[\n\\begin{aligned}\nf^{*}(s)&=\\sup_{v\\in V}[\\langle s_{U}+s_{V},z+v\\rangle-f(z+v)]\\\\\n&=\\langle s_{U},z\\rangle+\\sup_{v\\in V}[\\langle s_{V},z+v\\rangle-f(z+v)]\\\\\n&=\\langle s_{U},z\\rangle+f^{*}(s_{V}).\n\\end{aligned}\n\\]"
    },
    {
        "statement": "For $f$ satisfying (1.1.1), the function $f^{**}$ of (1.3.2) is the pointwise supremum of all the affine functions on $\\mathbb{R}^n$ majorized by $f$.  In other words\n\\[\n\\operatorname{epi} f^{**}=\\overline{\\operatorname{co}}\\bigl(\\operatorname{epi} f\\bigr).\n\\tag{1.3.3}\n\\]",
        "title": "",
        "label": "thm:FCA-chapE-1.3.5",
        "lean_tag": [
            "FCA_chap_E_1_3_5"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_3_5 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (hf_nondegenerate : IsNondegenerate f)\n  : epigraph (liftWithToptoEReal (Biconjugate f)) = closure (convexHull ‚Ñù (epigraph (liftWithToptoEReal f)))\n  := by sorry",
        "proof": "Call $\\Sigma\\subset\\mathbb{R}^n\\times\\mathbb{R}$ the set of pairs $(s,r)$ defining affine functions $\\langle s,\\cdot\\rangle - r$ majorized by $f$:\n\\[\n(s,r)\\in\\Sigma\\iff f(x)\\ge\\langle s,x\\rangle - r\\quad\\text{for all }x\\in\\mathbb{R}^n\n\\]\n\\[\n\\iff r\\ge\\sup\\{\\,\\langle s,x\\rangle - f(x):x\\in\\mathbb{R}^n\\,\\}\n\\]\n\\[\n\\iff r\\ge f^*(s)\\qquad(\\text{and }s\\in\\operatorname{dom}f^*!).\n\\]\n\nThen we obtain, for $x\\in\\mathbb{R}^n$,\n\\[\n\\sup_{(s,r)\\in\\Sigma}\\{\\langle s,x\\rangle - r\\}\n= \\sup\\{\\langle s,x\\rangle - r : s\\in\\operatorname{dom}f^*,\\ -r\\le -f^*(s)\\}\n\\]\n\\[\n= \\sup\\{\\langle s,x\\rangle - f^*(s): s\\in\\operatorname{dom}f^*\\}=f^{**}(x).\n\\]\n\nGeometrically, the epigraphs of the affine functions associated with $(s,r)\\in\\Sigma$ are the (non-vertical) closed half-spaces containing $\\operatorname{epi} f$.  From ¬ßB.2.5, the epigraph of their supremum is the closed convex hull of $\\operatorname{epi} f$, and this proves (1.3.3)."
    },
    {
        "statement": "If $g$ is a function satisfying $\\overline{\\operatorname{co}}\\,f \\le g \\le f$, then $g^* = f^*$. The function $f$ is equal to its biconjugate $f^{**}$ if and only if $f\\in\\overline{\\operatorname{Conv}}\\mathbb{R}^n$.",
        "title": "",
        "label": "cor:FCA-chapE-1.3.6",
        "lean_tag": [
            "FCA_chap_E_1_3_6"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_3_6 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (g : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) :\n  ((Minorizes (Biconjugate f) g) ‚àß (Minorizes g f) ‚Üí ‚àÄ s, Conjugate g s = Conjugate f s) ‚àß\n  ((Biconjugate f = f) ‚Üî (InClosedConvRn f)) := by\n  sorry",
        "proof": "Immediate."
    },
    {
        "statement": "If $f$ satisfying (1.1.1) is 1-coercive, then $f^*(s) < +\\infty$ for all $s \\in \\mathbb{R}^n$.",
        "title": "",
        "label": "prop:FCA-chapE-1.3.8",
        "lean_tag": [
            "FCA_chap_E_1_3_8"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_3_8 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (hf_nondegenerate : IsNondegenerate f) (hf_coercive : IsOneCoerciveFun f)\n  : ‚àÄ s, Conjugate f s < ‚ä§\n  := by sorry",
        "proof": "Let $s$ be given. The 1-coercivity of $f$ implies the existence of a number $R$ such that $f(x) \\ge \\|s\\|\\,\\|x\\|$ (hence $\\langle s,x\\rangle - f(x) \\le 0$) whenever $\\|x\\| \\ge R$. As a result, we have in (1.1.2)\n\\[\n\\sup\\{\\langle s,x\\rangle - \\|s\\|\\,\\|x\\| : \\|x\\| \\ge R\\} \\le 0.\n\\]\nOn the other hand, (1.1.1) implies an upper bound\n\\[\n\\sup \\{\\langle s,x\\rangle - f(x) : \\|x\\| \\le R\\} \\le M .\n\\]\nAltogether, $f^*(s) \\le \\max\\{0,M\\}$. \\qed"
    },
    {
        "statement": "For $f$ satisfying (1.1.1), the following holds:\n\\begin{enumerate}\n\\item[(i)] If $x_0\\in\\operatorname{int}\\dom f$ then $f^*-\\langle x_0,\\cdot\\rangle$ is $0$-coercive;\n\\item[(ii)] in particular, if $f$ is finite over $\\mathbb R^n$, then $f^*$ is $1$-coercive.\n\\end{enumerate}",
        "title": "",
        "label": "prop:FCA-chapE-1.3.9",
        "lean_tag": [
            "FCA_chap_E_1_3_9"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_3_9 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (x‚ÇÄ : EuclideanSpace ‚Ñù (Fin n))\n  (hf_nondegenerate : IsNondegenerate f) :\n  (x‚ÇÄ ‚àà interior (effDom (liftWithToptoEReal f)) ‚Üí IsZeroCoerciveFun (fun x => Conjugate f x - inner ‚Ñù x‚ÇÄ x)) ‚àß\n  (‚àÄ x, f x ‚â† ‚ä§ ‚Üí IsOneCoerciveFun (Conjugate f))\n  := by sorry",
        "proof": "We know from (1.2.3) that $\\sigma_{\\dom f}=(f^*)^{\\vee}_{\\infty}$ so, using Theorem C.2.2.3(iii),\n$x_0\\in\\operatorname{int}\\dom f\\subset\\int(\\codom f)$ implies $(f^*)^{\\vee}_{\\infty}(s)-\\langle x_0,s\\rangle>0$ for all $s\\neq0$.\nBy virtue of Proposition B.3.2.4, this means exactly that $f^*-\\langle x_0,\\cdot\\rangle$ has compact sublevel-sets; (i) is proved.\n\nThen, as demonstrated in Definition B.3.2.5, $0$-coercivity of $f^*-\\langle x_0,\\cdot\\rangle$ for all $x_0$ means $1$-coercivity of $f^*$."
    },
    {
        "statement": "For $f$ satisfying (1.1.1) and $\\partial f$ defined by (1.4.1), $s\\in\\partial f(x)$ if and only if\n\\[\nf^*(s)+f(x)-\\langle s,x\\rangle=0\\quad(\\text{or }\\le 0).\n\\tag{1.4.2}\n\\]",
        "title": "",
        "label": "thm:FCA-chapE-1.4.1",
        "lean_tag": [
            "FCA_chap_E_1_4_1"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_4_1 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (x s : EuclideanSpace ‚Ñù (Fin n))\n  (hf_nondegenerate : IsNondegenerate f)\n  : s ‚àà SubdifferentialAt f x ‚Üî (Conjugate f s) + f x - (inner ‚Ñù s x) = 0\n  := by sorry",
        "proof": "To say that $s$ lies in the set (1.4.1) is to say that\n\\[\n\\langle s,y\\rangle-f(y)\\le\\langle s,x\\rangle-f(x)\\quad\\text{for all }y\\in\\dom f,\n\\]\ni.e.\\ $f^*(s)\\le\\langle s,x\\rangle-f(x)$; but this is indeed an equality, in view of Fenchel's inequality (1.1.3)."
    },
    {
        "statement": "Let $f\\in\\operatorname{Conv}\\mathbb{R}^n$.  Then $\\partial f(x)\\neq\\varnothing$ whenever $x\\in\\operatorname{ri}\\dom f$.",
        "title": "",
        "label": "thm:FCA-chapE-1.4.2",
        "lean_tag": [
            "FCA_chap_E_1_4_2"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_4_2 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (x : EuclideanSpace ‚Ñù (Fin n))\n  (hf_convex : InConvRn f)\n  : x ‚àà intrinsicInterior ‚Ñù (effDom (liftWithToptoEReal f)) ‚Üí Set.Nonempty (SubdifferentialAt f x)\n  := by sorry",
        "proof": "This is Proposition B.1.2.1."
    },
    {
        "statement": "For $f$ satisfying (1.1.1), the following properties hold:\n\\[\n\\partial f(x)\\neq\\varnothing \\quad\\Longrightarrow\\quad (\\overline{\\operatorname{co}}\\,f)(x)=f(x);\\tag{1.4.3}\n\\]\n\\[\n\\overline{\\operatorname{co}}\\,f\\le g\\le f\\ \\text{ and }\\ g(x)=f(x)\n\\quad\\Longrightarrow\\quad \\partial g(x)=\\partial f(x);\\tag{1.4.4}\n\\]\n\\[\ns\\in\\partial f(x)\\quad\\Longrightarrow\\quad x\\in\\partial f^*(s).\\tag{1.4.5}\n\\]",
        "title": "",
        "label": "prop:FCA-chapE-1.4.3",
        "lean_tag": [
            "FCA_chap_E_1_4_3"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_4_3 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (g : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù)\n  (x s : EuclideanSpace ‚Ñù (Fin n))\n  (hf_nondegenerate : IsNondegenerate f) :\n  (Set.Nonempty (SubdifferentialAt f x) ‚Üí Biconjugate f x = f x) ‚àß\n  ((Minorizes (Biconjugate f) g) ‚àß (Minorizes g f) ‚àß (g x = f x) ‚Üí\n  (SubdifferentialAt g x) = (SubdifferentialAt f x)) ‚àß\n  (s ‚àà SubdifferentialAt f x ‚Üí x ‚àà SubdifferentialAt (Conjugate f) s) := by\n  sorry",
        "proof": "Let $s$ be a subgradient of $f$ at $x$. From the definition (1.4.1) itself, the function $y\\mapsto \\ell_s(y):=f(x)+\\langle s,y-x\\rangle$ is affine and minorizes $f$, hence $\\ell_s\\le \\overline{\\operatorname{co}}\\,f\\le f$; because $\\ell_s(x)=f(x)$, this implies (1.4.3).\n\nNow, $s\\in\\partial f(x)$ if and only if (1.4.2) holds. From our assumption in (1.4.4), $f^*=g^*=(\\overline{\\operatorname{co}}\\,f)^*$ (Corollary 1.3.6) and $g(x)=f(x)$. Therefore\n\\[\ns\\in\\partial f(x)\\iff g^*(s)+g(x)-\\langle s,x\\rangle=0,\n\\]\nwhich expresses exactly that $s\\in\\partial g(x)$; (1.4.4) is proved.\n\nFinally, we know that $f^{**}=\\overline{\\operatorname{co}}\\,f\\le f$; so, when $s$ satisfies (1.4.2), we have\n\\[\nf^*(s)+f^{**}(x)-\\langle s,x\\rangle\n= f^*(s)+(\\overline{\\operatorname{co}}\\,f)(x)-\\langle s,x\\rangle\\le 0,\n\\]\nwhich means $x\\in\\partial f^*(s)$: we have just proved (1.4.5)."
    },
    {
        "statement": "If $f\\in\\operatorname{Conv}\\mathbb{R}^n$, the following equivalences hold:\n\\[\nf(x)+f^*(s)-\\langle s,x\\rangle=0\\ (\\text{or }\\le 0)\n\\quad\\Longleftrightarrow\\quad s\\in\\partial f(x)\n\\quad\\Longleftrightarrow\\quad x\\in\\partial f^*(s).\n\\]",
        "title": "",
        "label": "thm:FCA-chapE-1.4.4",
        "lean_tag": [
            "FCA_chap_E_1_4_4"
        ],
        "lean_formalization": "lemma FCA_chap_E_1_4_4 {n : ‚Ñï}\n  (f : EuclideanSpace ‚Ñù (Fin n) ‚Üí WithTop ‚Ñù) (x s : EuclideanSpace ‚Ñù (Fin n))\n  (hf_closed_convex : InClosedConvRn f)\n  : List.TFAE [\n    f x + Conjugate f s - inner ‚Ñù s x = 0,\n    s ‚àà SubdifferentialAt f x,\n    x ‚àà SubdifferentialAt (Conjugate f) s\n  ]\n  := by sorry",
        "proof": "This is a rewriting of Theorem 1.4.1, taking into account (1.4.5) and the symmetric role played by $f$ and $f^*$ when $f\\in\\operatorname{Conv}\\mathbb{R}^n$."
    },
    {
        "statement": "With the above notation, assume that $\\operatorname{Im}A^* \\cap \\dom g^* \\neq\\varnothing$. Then $Ag$ satisfies (1.1.1) and its conjugate is\n\\[\n(Ag)^* = g^* \\circ A^* .\n\\]",
        "title": "",
        "label": "thm:FCA-chapE-2.1.1",
        "lean_tag": [
            "FCA_chap_E_2_1_1"
        ],
        "lean_formalization": "lemma FCA_chap_E_2_1_1 {m n : ‚Ñï}\n  (g : EuclideanSpace ‚Ñù (Fin m) ‚Üí WithTop ‚Ñù)\n  (A : (EuclideanSpace ‚Ñù (Fin m)) ‚Üí‚Çó[‚Ñù] (EuclideanSpace ‚Ñù (Fin n)))\n  (hg_nondegenerate : IsNondegenerate g)\n  (h_nonempty_domain : Set.Nonempty ((Im A.adjoint) ‚à© effDom (liftWithToptoEReal (Conjugate g))))\n  : let h := fun x => sInf (Set.image g {y | A y = x})\n    ‚àÄ s, Conjugate h s = Conjugate g (A.adjoint s)\n  := by sorry",
        "proof": "First, it is clear that $Ag \\not\\equiv +\\infty$ (take $x=Ay$, with $y\\in\\dom g$). On the other hand, our assumption implies the existence of some $p_0 = A^*s_0$ such that $g^*(p_0)<+\\infty$; with Fenchel's inequality (1.1.3), we have for all $y\\in\\mathbb R^m$:\n\\[\ng(y) \\ge \\langle A^*s_0,y\\rangle_m - g^*(p_0) = \\langle s_0,Ay\\rangle_n - g^*(p_0).\n\\]\nFor each $x\\in\\mathbb R^n$, take the infimum over those $y$ satisfying $Ay=x$: the affine function $\\langle s_0,\\cdot\\rangle - g^*(p_0)$ minorizes $Ag$. Altogether, $Ag$ satisfies (1.1.1).\n\nThen we have for $s\\in\\mathbb R^n$\n\\[\n(Ag)^*(s) = \\sup_{x\\in\\mathbb R^n}[\\langle s,x\\rangle - \\inf_{Ay=x} g(y)]\n= \\sup_{x\\in\\mathbb R^n,\\,Ay=x}[\\langle s,x\\rangle - g(y)]\n= \\sup_{y\\in\\mathbb R^m}[\\langle s,Ay\\rangle - g(y)] = g^*(A^*s).\n\\]"
    }
]